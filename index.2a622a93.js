!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},i=t.parcelRequired7c6;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in r){var t=r[e];delete r[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){r[e]=t},t.parcelRequired7c6=i),i.register("hKHmD",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}})),i.register("kMC0W",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(Array.isArray(e))return r.default(e)};var n,r=(n=i("8NIkP"))&&n.__esModule?n:{default:n}})),i.register("8NIkP",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}})),i.register("7AJDX",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}})),i.register("8CtQK",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}})),i.register("auk6i",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){if(!e)return;if("string"==typeof e)return r.default(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r.default(e,t)};var n,r=(n=i("8NIkP"))&&n.__esModule?n:{default:n}})),i.register("8slrw",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(Array.isArray(e))return e}})),i.register("ifqQW",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}})),i.register("ds8z5",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}})),i.register("gD1JV",(function(e,t){"use strict";function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){return n(e,t)}})),i.register("ge8co",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t,n){return o.apply(null,arguments)};var n,r=(n=i("gD1JV"))&&n.__esModule?n:{default:n};function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function o(e,t,n){return(o=a()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&r.default(a,n.prototype),a}).apply(null,arguments)}})),i.register("cZGw3",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}})),i.register("fVNic",(function(e,t){"use strict";function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return n(e)}})),i.register("aTHs7",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}})),i.register("jmhxu",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){return!t||"object"!==r.default(t)&&"function"!=typeof t?n.default(e):t};var n=a(i("ds8z5")),r=a(i("l5bVx"));function a(e){return e&&e.__esModule?e:{default:e}}})),i.register("l5bVx",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return e&&e.constructor===Symbol?"symbol":typeof e}})),i.register("2mz0K",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r.default(e)););return e};var n,r=(n=i("fVNic"))&&n.__esModule?n:{default:n}}));var a={};function o(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,u,"next",e)}function u(e){o(a,r,i,s,u,"throw",e)}s(void 0)}))}};var s={};Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};var u={};function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(e,t,n){t&&c(e.prototype,t);n&&c(e,n);return e};var l=i("hKHmD"),h={};Object.defineProperty(h,"__esModule",{value:!0}),h.default=function(e){return f.default(e)||d.default(e)||v.default(e)||p.default()};var f=y(i("kMC0W")),d=y(i("7AJDX")),p=y(i("8CtQK")),v=y(i("auk6i"));function y(e){return e&&e.__esModule?e:{default:e}}var m={},g=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),o=new S(r||[]);return a._invoke=function(e,t,n){var r=h;return function(i,a){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw a;return R()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=T(o,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var u=l(e,t,n);if("normal"===u.type){if(r=n.done?p:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h="suspendedStart",f="suspendedYield",d="executing",p="completed",v={};function y(){}function m(){}function g(){}var k={};u(k,a,(function(){return this}));var _=Object.getPrototypeOf,w=_&&_(_(A([])));w&&w!==n&&r.call(w,a)&&(k=w);var b=g.prototype=y.prototype=Object.create(k);function E(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(i,a,o,s){var u=l(e[i],e,a);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function T(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function A(e){if(e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:R}}function R(){return{value:t,done:!0}}return m.prototype=g,u(b,"constructor",g),u(g,"constructor",m),m.displayName=u(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},E(I.prototype),u(I.prototype,o,(function(){return this})),e.AsyncIterator=I,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new I(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(b),u(b,s,"Generator"),u(b,a,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(m);try{regeneratorRuntime=g}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=g:Function("r","regeneratorRuntime = r")(g)}var k={};Object.defineProperty(k,"__esModule",{value:!0}),k.default=function(e,t){return _.default(e)||w.default(e,t)||E.default(e,t)||b.default()};var _=I(i("8slrw")),w=I(i("7AJDX")),b=I(i("ifqQW")),E=I(i("auk6i"));function I(e){return e&&e.__esModule?e:{default:e}}var T=i("ds8z5"),x={};Object.defineProperty(x,"__esModule",{value:!0}),x.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S.default(e,t)};var C,S=(C=i("gD1JV"))&&C.__esModule?C:{default:C};var A={};Object.defineProperty(A,"__esModule",{value:!0}),A.default=function(e){return L(e)};var R=D(i("ge8co")),N=D(i("cZGw3")),O=D(i("fVNic")),P=D(i("gD1JV"));function D(e){return e&&e.__esModule?e:{default:e}}function L(e){var t="function"==typeof Map?new Map:void 0;return L=function(e){if(null===e||!N.default(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return R.default(e,arguments,O.default(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),P.default(n,e)},L(e)}var M={};Object.defineProperty(M,"__esModule",{value:!0}),M.default=function(e){var t=U.default();return function(){var n,r=F.default(e);if(t){var i=F.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B.default(this,n)}};var U=j(i("aTHs7")),F=j(i("fVNic")),B=j(i("jmhxu"));function j(e){return e&&e.__esModule?e:{default:e}}var V,q,z,H=V={};function W(){throw new Error("setTimeout has not been defined")}function K(){throw new Error("clearTimeout has not been defined")}function G(e){if(q===setTimeout)return setTimeout(e,0);if((q===W||!q)&&setTimeout)return q=setTimeout,setTimeout(e,0);try{return q(e,0)}catch(t){try{return q.call(null,e,0)}catch(t){return q.call(this,e,0)}}}!function(){try{q="function"==typeof setTimeout?setTimeout:W}catch(e){q=W}try{z="function"==typeof clearTimeout?clearTimeout:K}catch(e){z=K}}();var Q,Y=[],J=!1,X=-1;function $(){J&&Q&&(J=!1,Q.length?Y=Q.concat(Y):X=-1,Y.length&&Z())}function Z(){if(!J){var e=G($);J=!0;for(var t=Y.length;t;){for(Q=Y,Y=[];++X<t;)Q&&Q[X].run();X=-1,t=Y.length}Q=null,J=!1,function(e){if(z===clearTimeout)return clearTimeout(e);if((z===K||!z)&&clearTimeout)return z=clearTimeout,clearTimeout(e);try{z(e)}catch(t){try{return z.call(null,e)}catch(t){return z.call(this,e)}}}(e)}}function ee(e,t){this.fun=e,this.array=t}function te(){}H.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Y.push(new ee(e,t)),1!==Y.length||J||G(Z)},ee.prototype.run=function(){this.fun.apply(null,this.array)},H.title="browser",H.browser=!0,H.env={},H.argv=[],H.version="",H.versions={},H.on=te,H.addListener=te,H.once=te,H.off=te,H.removeListener=te,H.removeAllListeners=te,H.emit=te,H.prependListener=te,H.prependOnceListener=te,H.listeners=function(e){return[]},H.binding=function(e){throw new Error("process.binding is not supported")},H.cwd=function(){return"/"},H.chdir=function(e){throw new Error("process.chdir is not supported")},H.umask=function(){return 0};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ne=!1,re=!1,ie="${JSCORE_VERSION}",ae=function(e,t){if(!e)throw oe(t)},oe=function(e){return new Error("Firebase Database ("+ie+") INTERNAL ASSERT FAILED: "+e)},se=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},ue={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=a>>2,h=(3&a)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,o||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(se(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw new ce;var c=a<<2|o>>4;if(r.push(c),64!==s){var l=o<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},ce=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){var t;return e(s)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).name="DecodeBase64StringError",t}return r}(e(A)(Error)),le=function(e){var t=se(e);return ue.encodeByteArray(t,!0)},he=function(e){return le(e).replace(/\./g,"")},fe=function(e){try{return ue.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function de(e){return pe(void 0,e)}function pe(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=pe(e[n],t[n]));return e}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ve=function(){
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},ye=function(){try{return ve()||function(){if(void 0!==V&&void 0!==V.env);}()||function(){if("undefined"!=typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}var t=e&&fe(e[1]);return t&&JSON.parse(t)}}()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},me=function(e){var t,n;return null===(n=null===(t=ye())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},ge=function(e){var t=me(e);if(t){var n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));var r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]}},ke=function(){var e;return null===(e=ye())||void 0===e?void 0:e.config},_e=function(e){var t;return null===(t=ye())||void 0===t?void 0:t["_".concat(e)]},we=function(){"use strict";function t(){var n=this;e(s)(this,t),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))}return e(u)(t,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function be(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[he(JSON.stringify({alg:"none",type:"JWT"})),he(JSON.stringify(a)),""].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ee(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ie(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ee())}function Te(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function xe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Ce(){return!0===ne||!0===re}function Se(){try{return"object"==typeof indexedDB}catch(e){return!1}}function Ae(){return new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}function Re(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ne=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this,i)).code=t,o.customData=a,o.name="FirebaseError",Object.setPrototypeOf(e(T)(o),r.prototype),Error.captureStackTrace&&Error.captureStackTrace(e(T)(o),Oe.prototype.create),o}return r}(e(A)(Error)),Oe=function(){"use strict";function t(n,r,i){e(s)(this,t),this.service=n,this.serviceName=r,this.errors=i}return e(u)(t,[{key:"create",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0]||{},a="".concat(this.service,"/").concat(e),o=this.errors[e],s=o?Pe(o,i):"Error",u="".concat(this.serviceName,": ").concat(s," (").concat(a,")."),c=new Ne(a,u,i);return c}}]),t}();function Pe(e,t){return e.replace(De,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}var De=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(e){return JSON.parse(e)}function Me(e){return JSON.stringify(e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=Le(fe(a[0])||""),n=Le(fe(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},Fe=function(e){var t=Ue(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Be(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function je(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function Ve(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function qe(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function ze(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t),i=!0,a=!1,o=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;if(!r.includes(c))return!1;var l=e[c],h=t[c];if(He(l)&&He(h)){if(!ze(l,h))return!1}else if(l!==h)return!1}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}var f=!0,d=!1,p=void 0;try{for(var v,y=r[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var m=v.value;if(!n.includes(m))return!1}}catch(e){d=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}return!0}function He(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function We(t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=function(t,r){var i=e(k)(r.value,2),a=i[0],o=i[1];Array.isArray(o)?o.forEach((function(e){n.push(encodeURIComponent(a)+"="+encodeURIComponent(e))})):n.push(encodeURIComponent(a)+"="+encodeURIComponent(o))},u=Object.entries(t)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)s(0,o)}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n.length?"&"+n.join("&"):""}function Ke(t){var n={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var r=e(k)(t.split("="),2),i=r[0],a=r[1];n[decodeURIComponent(i)]=decodeURIComponent(a)}})),n}function Ge(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe=function(){"use strict";function t(){e(s)(this,t),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var n=1;n<this.blockSize;++n)this.pad_[n]=0;this.reset()}return e(u)(t,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var a=16;a<80;a++){var o=n[a-3]^n[a-8]^n[a-14]^n[a-16];n[a]=4294967295&(o<<1|o>>>31)}for(var s,u,c=this.chain_[0],l=this.chain_[1],h=this.chain_[2],f=this.chain_[3],d=this.chain_[4],p=0;p<80;p++){p<40?p<20?(s=f^l&(h^f),u=1518500249):(s=l^h^f,u=1859775393):p<60?(s=l&h|f&(l|h),u=2400959708):(s=l^h^f,u=3395469782);var v=(c<<5|c>>>27)+s+d+u+n[p]&4294967295;d=f,f=h,h=4294967295&(l<<30|l>>>2),l=c,c=v}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[a]=e.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<t;)if(i[a]=e[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var a=24;a>=0;a-=8)e[r]=this.chain_[i]>>a&255,++r;return e}}]),t}();var Ye=function(){"use strict";function t(n,r){var i=this;e(s)(this,t),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then((function(){n(i)})).catch((function(e){i.error(e)}))}return e(u)(t,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s in e&&"function"==typeof e[s])return!0}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Je),void 0===r.error&&(r.error=Je),void 0===r.complete&&(r.complete=Je);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),t}();function Je(){}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xe(e,t){return"".concat(e," failed: ").concat(t," argument ")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var $e=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,ae(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Ze=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},et=144e5;function tt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(et,r+i)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function nt(e){return e&&e._delegate?e._delegate:e}var rt=function(){"use strict";function t(n,r,i){e(s)(this,t),this.name=n,this.instanceFactory=r,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e(u)(t,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),t}(),it="[DEFAULT]",at=function(){"use strict";function t(n,r){e(s)(this,t),this.name=n,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e(u)(t,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new we;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(t){if(t.name!==this.name)throw Error("Mismatching Component ".concat(t.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=t,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t))try{this.getOrInitializeService({instanceIdentifier:it})}catch(e){}var n=!0,r=!1,i=void 0;try{for(var a,o=this.instancesDeferred.entries()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=e(k)(a.value,2),u=s[0],c=s[1],l=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService({instanceIdentifier:l});c.resolve(h)}catch(e){}}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Array.from(t.instances.values()),n.next=3,Promise.all(e(h)(r.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))).concat(e(h)(r.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return n.stop()}}),n)})))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.options,r=void 0===n?{}:n,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error("".concat(this.name,"(").concat(i,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a=this.getOrInitializeService({instanceIdentifier:i,options:r}),o=!0,s=!1,u=void 0;try{for(var c,l=this.instancesDeferred.entries()[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=e(k)(c.value,2),f=h[0],d=h[1],p=this.normalizeInstanceIdentifier(f);i===p&&d.resolve(a)}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;try{u(e,t)}catch(e){}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===it?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(e){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it;return this.component?this.component.multipleInstances?e:it:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ot,st,ut=function(){"use strict";function t(n){e(s)(this,t),this.name=n,this.providers=new Map}return e(u)(t,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new at(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),t}(),ct=(l=i("hKHmD"),[]);(st=ot||(ot={}))[st.DEBUG=0]="DEBUG",st[st.VERBOSE=1]="VERBOSE",st[st.INFO=2]="INFO",st[st.WARN=3]="WARN",st[st.ERROR=4]="ERROR",st[st.SILENT=5]="SILENT";var lt,ht={debug:ot.DEBUG,verbose:ot.VERBOSE,info:ot.INFO,warn:ot.WARN,error:ot.ERROR,silent:ot.SILENT},ft=ot.INFO,dt=(lt={},e(l)(lt,ot.DEBUG,"log"),e(l)(lt,ot.VERBOSE,"log"),e(l)(lt,ot.INFO,"info"),e(l)(lt,ot.WARN,"warn"),e(l)(lt,ot.ERROR,"error"),lt),pt=function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];var o;if(!(n<t.logLevel)){var s=(new Date).toISOString(),u=dt[n];if(!u)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(n,")"));(o=console)[u].apply(o,["[".concat(s,"]  ").concat(t.name,":")].concat(e(h)(i)))}},vt=function(){"use strict";function t(n){e(s)(this,t),this.name=n,this._logLevel=ft,this._logHandler=pt,this._userLogHandler=null,ct.push(this)}return e(u)(t,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in ot))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?ht[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,ot.DEBUG].concat(e(h)(n))),this._logHandler.apply(this,[this,ot.DEBUG].concat(e(h)(n)))}},{key:"log",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,ot.VERBOSE].concat(e(h)(n))),this._logHandler.apply(this,[this,ot.VERBOSE].concat(e(h)(n)))}},{key:"info",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,ot.INFO].concat(e(h)(n))),this._logHandler.apply(this,[this,ot.INFO].concat(e(h)(n)))}},{key:"warn",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,ot.WARN].concat(e(h)(n))),this._logHandler.apply(this,[this,ot.WARN].concat(e(h)(n)))}},{key:"error",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,ot.ERROR].concat(e(h)(n))),this._logHandler.apply(this,[this,ot.ERROR].concat(e(h)(n)))}}]),t}();var yt={};Object.defineProperty(yt,"__esModule",{value:!0}),yt.default=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){mt.default(e,t,n[t])}))}return e};var mt=function(e){return e&&e.__esModule?e:{default:e}}(i("hKHmD"));var gt,kt;var _t=new WeakMap,wt=new WeakMap,bt=new WeakMap,Et=new WeakMap,It=new WeakMap;var Tt={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return wt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||bt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return St(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function xt(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(kt||(kt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(At(this),n),St(_t.get(this))}:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return St(t.apply(At(this),n))}:function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];var o,s=(o=t).call.apply(o,[At(this),n].concat(e(h)(i)));return bt.set(s,n.sort?n.sort():[n]),St(s)}}function Ct(e){return"function"==typeof e?xt(e):(e instanceof IDBTransaction&&function(e){if(!wt.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));wt.set(e,t)}}(e),t=e,(gt||(gt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,Tt):e);var t}function St(e){if(e instanceof IDBRequest)return t=e,(n=new Promise((function(e,n){var r=function(){t.removeEventListener("success",i),t.removeEventListener("error",a)},i=function(){e(St(t.result)),r()},a=function(){n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",a)}))).then((function(e){e instanceof IDBCursor&&_t.set(e,t)})).catch((function(){})),It.set(n,t),n;var t,n;if(Et.has(e))return Et.get(e);var r=Ct(e);return r!==e&&(Et.set(e,r),It.set(r,e)),r}var At=function(e){return It.get(e)};function Rt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=St(s);return i&&s.addEventListener("upgradeneeded",(function(e){i(St(s.result),e.oldVersion,e.newVersion,St(s.transaction),e)})),r&&s.addEventListener("blocked",(function(e){return r(e.oldVersion,e.newVersion,e)})),u.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(e){return a(e.oldVersion,e.newVersion,e)}))})).catch((function(){})),u}var Nt=["get","getKey","getAll","getAllKeys","count"],Ot=["put","add","delete","clear"],Pt=new Map;function Dt(t,n){if(t instanceof IDBDatabase&&!(n in t)&&"string"==typeof n){if(Pt.get(n))return Pt.get(n);var r=n.replace(/FromIndex$/,""),i=n!==r,o=Ot.includes(r);if(r in(i?IDBIndex:IDBObjectStore).prototype&&(o||Nt.includes(r))){var s,u=(s=e(a)(e(m).mark((function t(n){var a,s,u,c,l,f,d=arguments;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a=d.length,s=new Array(a>1?a-1:0),u=1;u<a;u++)s[u-1]=d[u];return l=this.transaction(n,o?"readwrite":"readonly"),f=l.store,i&&(f=f.index(s.shift())),t.next=7,Promise.all([(c=f)[r].apply(c,e(h)(s)),o&&l.done]);case 7:return t.abrupt("return",t.sent[0]);case 8:case"end":return t.stop()}}),t,this)}))),function(e){return s.apply(this,arguments)});return Pt.set(n,u),u}}}Tt=function(t){return e(yt)({},t,{get:function(e,n,r){return Dt(e,n)||t.get(e,n,r)},has:function(e,n){return!!Dt(e,n)||t.has(e,n)}})}(Tt);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Lt=function(){"use strict";function t(n){e(s)(this,t),this.container=n}return e(u)(t,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),t}();var Mt,Ut,Ft="@firebase/app",Bt="0.9.23",jt=new vt("@firebase/app"),Vt="[DEFAULT]",qt=(Mt={},e(l)(Mt,Ft,"fire-core"),e(l)(Mt,"@firebase/app-compat","fire-core-compat"),e(l)(Mt,"@firebase/analytics","fire-analytics"),e(l)(Mt,"@firebase/analytics-compat","fire-analytics-compat"),e(l)(Mt,"@firebase/app-check","fire-app-check"),e(l)(Mt,"@firebase/app-check-compat","fire-app-check-compat"),e(l)(Mt,"@firebase/auth","fire-auth"),e(l)(Mt,"@firebase/auth-compat","fire-auth-compat"),e(l)(Mt,"@firebase/database","fire-rtdb"),e(l)(Mt,"@firebase/database-compat","fire-rtdb-compat"),e(l)(Mt,"@firebase/functions","fire-fn"),e(l)(Mt,"@firebase/functions-compat","fire-fn-compat"),e(l)(Mt,"@firebase/installations","fire-iid"),e(l)(Mt,"@firebase/installations-compat","fire-iid-compat"),e(l)(Mt,"@firebase/messaging","fire-fcm"),e(l)(Mt,"@firebase/messaging-compat","fire-fcm-compat"),e(l)(Mt,"@firebase/performance","fire-perf"),e(l)(Mt,"@firebase/performance-compat","fire-perf-compat"),e(l)(Mt,"@firebase/remote-config","fire-rc"),e(l)(Mt,"@firebase/remote-config-compat","fire-rc-compat"),e(l)(Mt,"@firebase/storage","fire-gcs"),e(l)(Mt,"@firebase/storage-compat","fire-gcs-compat"),e(l)(Mt,"@firebase/firestore","fire-fst"),e(l)(Mt,"@firebase/firestore-compat","fire-fst-compat"),e(l)(Mt,"fire-js","fire-js"),e(l)(Mt,"firebase","fire-js-all"),Mt),zt=new Map,Ht=new Map;function Wt(e,t){try{e.container.addComponent(t)}catch(n){jt.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Kt(e){var t=e.name;if(Ht.has(t))return jt.debug("There were multiple attempts to register component ".concat(t,".")),!1;Ht.set(t,e);var n=!0,r=!1,i=void 0;try{for(var a,o=zt.values()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){Wt(a.value,e)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}function Gt(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Qt=(Ut={},e(l)(Ut,"no-app","No Firebase App '{$appName}' has been created - call initializeApp() first"),e(l)(Ut,"bad-app-name","Illegal App name: '{$appName}"),e(l)(Ut,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),e(l)(Ut,"app-deleted","Firebase App named '{$appName}' already deleted"),e(l)(Ut,"no-options","Need to provide options, when not being deployed to hosting via source."),e(l)(Ut,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),e(l)(Ut,"invalid-log-argument","First argument to `onLog` must be null or a function."),e(l)(Ut,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),e(l)(Ut,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),e(l)(Ut,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),e(l)(Ut,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),Ut),Yt=new Oe("app","Firebase",Qt),Jt=function(){"use strict";function t(n,r,i){var a=this;e(s)(this,t),this._isDeleted=!1,this._options=Object.assign({},n),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new rt("app",(function(){return a}),"PUBLIC"))}return e(u)(t,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Yt.create("app-deleted",{appName:this._name})}}]),t}(),Xt="10.6.0";function $t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!=typeof t){var r=t;t={name:r}}var i=Object.assign({name:Vt,automaticDataCollectionEnabled:!1},t),a=i.name;if("string"!=typeof a||!a)throw Yt.create("bad-app-name",{appName:String(a)});if(n||(n=ke()),!n)throw Yt.create("no-options");var o=zt.get(a);if(o){if(ze(n,o.options)&&ze(i,o.config))return o;throw Yt.create("duplicate-app",{appName:a})}var s=new ut(a),u=!0,c=!1,l=void 0;try{for(var h,f=Ht.values()[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value;s.addComponent(d)}}catch(e){c=!0,l=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}var p=new Jt(n,i,s);return zt.set(a,p),p}function Zt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vt,t=zt.get(e);if(!t&&e===Vt&&ke())return $t();if(!t)throw Yt.create("no-app",{appName:e});return t}function en(e,t,n){var r,i=null!==(r=qt[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void jt.warn(s.join(" "))}Kt(new rt("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var tn="firebase-heartbeat-store",nn=null;function rn(){return nn||(nn=Rt("firebase-heartbeat-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(tn)}}).catch((function(e){throw Yt.create("idb-open",{originalErrorMessage:e.message})}))),nn}function an(e){return on.apply(this,arguments)}function on(){return(on=e(a)(e(m).mark((function t(n){var r,i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rn();case 3:return r=e.sent,e.next=6,r.transaction(tn).objectStore(tn).get(cn(n));case 6:return i=e.sent,e.abrupt("return",i);case 10:e.prev=10,e.t0=e.catch(0),e.t0 instanceof Ne?jt.warn(e.t0.message):(a=Yt.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),jt.warn(a.message));case 13:case"end":return e.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function sn(e,t){return un.apply(this,arguments)}function un(){return(un=e(a)(e(m).mark((function t(n,r){var i,a,o,s;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rn();case 3:return i=e.sent,a=i.transaction(tn,"readwrite"),o=a.objectStore(tn),e.next=8,o.put(r,cn(n));case 8:return e.next=10,a.done;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),e.t0 instanceof Ne?jt.warn(e.t0.message):(s=Yt.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),jt.warn(s.message));case 15:case"end":return e.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)}function cn(e){return"".concat(e.name,"!").concat(e.options.appId)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ln=function(){"use strict";function t(n){var r=this;e(s)(this,t),this.container=n,this._heartbeatsCache=null;var i=this.container.getProvider("app").getImmediate();this._storage=new pn(i),this._heartbeatsCachePromise=this._storage.read().then((function(e){return r._heartbeatsCache=e,e}))}return e(u)(t,[{key:"triggerHeartbeat",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r,i,a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.container.getProvider("platform-logger").getImmediate(),a=i.getPlatformInfoString(),o=hn(),null!=(null===(r=t._heartbeatsCache)||void 0===r?void 0:r.heartbeats)){e.next=8;break}return e.next=7,t._heartbeatsCachePromise;case 7:t._heartbeatsCache=e.sent;case 8:if(t._heartbeatsCache.lastSentHeartbeatDate!==o&&!t._heartbeatsCache.heartbeats.some((function(e){return e.date===o}))){e.next=12;break}return e.abrupt("return");case 12:t._heartbeatsCache.heartbeats.push({date:o,agent:a});case 13:return t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",t._storage.overwrite(t._heartbeatsCache));case 15:case"end":return e.stop()}}),n)})))()}},{key:"getHeartbeatsHeader",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r,i,a,o,s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t._heartbeatsCache){e.next=4;break}return e.next=4,t._heartbeatsCachePromise;case 4:if(null!=(null===(r=t._heartbeatsCache)||void 0===r?void 0:r.heartbeats)&&0!==t._heartbeatsCache.heartbeats.length){e.next=6;break}return e.abrupt("return","");case 6:if(i=hn(),a=fn(t._heartbeatsCache.heartbeats),o=a.heartbeatsToSend,s=a.unsentEntries,u=he(JSON.stringify({version:2,heartbeats:o})),t._heartbeatsCache.lastSentHeartbeatDate=i,!(s.length>0)){e.next=16;break}return t._heartbeatsCache.heartbeats=s,e.next=14,t._storage.overwrite(t._heartbeatsCache);case 14:e.next=17;break;case 16:t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache);case 17:return e.abrupt("return",u);case 18:case"end":return e.stop()}}),n)})))()}}]),t}();function hn(){return(new Date).toISOString().substring(0,10)}function fn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=[],r=e.slice(),i=!0,a=!1,o=void 0;try{for(var s,u=function(e,i){var a=i.value,o=n.find((function(e){return e.agent===a.agent}));if(o){if(o.dates.push(a.date),vn(n)>t)return o.dates.pop(),"break"}else if(n.push({agent:a.agent,dates:[a.date]}),vn(n)>t)return n.pop(),"break";r=r.slice(1)},c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=u(c,s);if("break"===l)break}}catch(e){a=!0,o=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw o}}return{heartbeatsToSend:n,unsentEntries:r}}var dn,pn=function(){"use strict";function t(n){e(s)(this,t),this.app=n,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return e(u)(t,[{key:"runIndexedDBEnvironmentCheck",value:function(){return e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Se()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",Ae().then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),t)})))()}},{key:"read",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,an(t.app);case 9:return r=e.sent,e.abrupt("return",r||{heartbeats:[]});case 11:case"end":return e.stop()}}),n)})))()}},{key:"overwrite",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,n._canUseIndexedDBPromise;case 3:if(e.sent){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,n.read();case 10:return a=e.sent,e.abrupt("return",sn(n.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:a.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 12:case"end":return e.stop()}}),r)})))()}},{key:"add",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i,a;return e(m).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=3,n._canUseIndexedDBPromise;case 3:if(r.sent){r.next=8;break}return r.abrupt("return");case 8:return r.next=10,n.read();case 10:return a=r.sent,r.abrupt("return",sn(n.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:a.lastSentHeartbeatDate,heartbeats:e(h)(a.heartbeats).concat(e(h)(t.heartbeats))}));case 12:case"end":return r.stop()}}),r)})))()}}]),t}();function vn(e){return he(JSON.stringify({version:2,heartbeats:e})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dn="",Kt(new rt("platform-logger",(function(e){return new Lt(e)}),"PRIVATE")),Kt(new rt("heartbeat",(function(e){return new ln(e)}),"PRIVATE")),en(Ft,Bt,dn),en(Ft,Bt,"esm2017"),en("fire-js","");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
en("firebase","10.6.0","app");var yn,mn;l=i("hKHmD"),l=i("hKHmD");var gn=new WeakMap,kn=new WeakMap,_n=new WeakMap,wn=new WeakMap,bn=new WeakMap;var En={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return kn.get(e);if("objectStoreNames"===t)return e.objectStoreNames||_n.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xn(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function In(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(mn||(mn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(Cn(this),n),xn(gn.get(this))}:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return xn(t.apply(Cn(this),n))}:function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];var o,s=(o=t).call.apply(o,[Cn(this),n].concat(e(h)(i)));return _n.set(s,n.sort?n.sort():[n]),xn(s)}}function Tn(e){return"function"==typeof e?In(e):(e instanceof IDBTransaction&&function(e){if(!kn.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));kn.set(e,t)}}(e),t=e,(yn||(yn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,En):e);var t}function xn(e){if(e instanceof IDBRequest)return t=e,(n=new Promise((function(e,n){var r=function(){t.removeEventListener("success",i),t.removeEventListener("error",a)},i=function(){e(xn(t.result)),r()},a=function(){n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",a)}))).then((function(e){e instanceof IDBCursor&&gn.set(e,t)})).catch((function(){})),bn.set(n,t),n;var t,n;if(wn.has(e))return wn.get(e);var r=Tn(e);return r!==e&&(wn.set(e,r),bn.set(r,e)),r}var Cn=function(e){return bn.get(e)};function Sn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=xn(s);return i&&s.addEventListener("upgradeneeded",(function(e){i(xn(s.result),e.oldVersion,e.newVersion,xn(s.transaction))})),r&&s.addEventListener("blocked",(function(){return r()})),u.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(){return a()}))})).catch((function(){})),u}var An=["get","getKey","getAll","getAllKeys","count"],Rn=["put","add","delete","clear"],Nn=new Map;function On(t,n){if(t instanceof IDBDatabase&&!(n in t)&&"string"==typeof n){if(Nn.get(n))return Nn.get(n);var r=n.replace(/FromIndex$/,""),i=n!==r,o=Rn.includes(r);if(r in(i?IDBIndex:IDBObjectStore).prototype&&(o||An.includes(r))){var s,u=(s=e(a)(e(m).mark((function t(n){var a,s,u,c,l,f,d=arguments;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a=d.length,s=new Array(a>1?a-1:0),u=1;u<a;u++)s[u-1]=d[u];return l=this.transaction(n,o?"readwrite":"readonly"),f=l.store,i&&(f=f.index(s.shift())),t.next=7,Promise.all([(c=f)[r].apply(c,e(h)(s)),o&&l.done]);case 7:return t.abrupt("return",t.sent[0]);case 8:case"end":return t.stop()}}),t,this)}))),function(e){return s.apply(this,arguments)});return Nn.set(n,u),u}}}!function(e){En=e(En)}((function(t){return e(yt)({},t,{get:function(e,n,r){return On(e,n)||t.get(e,n,r)},has:function(e,n){return!!On(e,n)||t.has(e,n)}})}));var Pn,Dn="@firebase/installations",Ln="0.6.4",Mn=1e4,Un="w:".concat(Ln),Fn="FIS_v2",Bn=36e5,jn=(Pn={},e(l)(Pn,"missing-app-config-values",'Missing App configuration value: "{$valueName}"'),e(l)(Pn,"not-registered","Firebase Installation is not registered."),e(l)(Pn,"installation-not-found","Firebase Installation not found."),e(l)(Pn,"request-failed",'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"'),e(l)(Pn,"app-offline","Could not process request. Application offline."),e(l)(Pn,"delete-pending-registration","Can't delete installation while there is a pending registration request."),Pn),Vn=new Oe("installations","Installations",jn);function qn(e){return e instanceof Ne&&e.code.includes("request-failed")}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(e){var t=e.projectId;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(t,"/installations")}function Hn(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}function Wn(e,t){return Kn.apply(this,arguments)}function Kn(){return(Kn=e(a)(e(m).mark((function t(n,r){var i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.json();case 2:return i=e.sent,a=i.error,e.abrupt("return",Vn.create("request-failed",{requestName:n,serverCode:a.code,serverMessage:a.message,serverStatus:a.status}));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Gn(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Qn(e,t){var n=t.refreshToken,r=Gn(e);return r.append("Authorization",function(e){return"".concat(Fn," ").concat(e)}(n)),r}function Yn(e){return Jn.apply(this,arguments)}function Jn(){return(Jn=e(a)(e(m).mark((function t(n){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:if(!((r=e.sent).status>=500&&r.status<600)){e.next=5;break}return e.abrupt("return",n());case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Xn(e,t){return $n.apply(this,arguments)}function $n(){return($n=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){var i,a,o,s,u,c,l,h,f,d,p,v;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.appConfig,a=n.heartbeatServiceProvider,o=r.fid,s=zn(i),u=Gn(i),!(c=a.getImmediate({optional:!0}))){e.next=9;break}return e.next=7,c.getHeartbeatsHeader();case 7:(l=e.sent)&&u.append("x-firebase-client",l);case 9:return h={fid:o,authVersion:Fn,appId:i.appId,sdkVersion:Un},f={method:"POST",headers:u,body:JSON.stringify(h)},e.next=13,Yn((function(){return fetch(s,f)}));case 13:if(!(d=e.sent).ok){e.next=22;break}return e.next=17,d.json();case 17:return p=e.sent,v={fid:p.fid||o,registrationStatus:2,refreshToken:p.refreshToken,authToken:Hn(p.authToken)},e.abrupt("return",v);case 22:return e.next=24,Wn("Create Installation",d);case 24:throw e.sent;case 25:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(e){return new Promise((function(t){setTimeout(t,e)}))}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var er=/^[cdef][\w-]{21}$/;function tr(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var n=function(t){return(n=t,btoa((r=String).fromCharCode.apply(r,e(h)(n))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var n,r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t);return er.test(n)?n:""}catch(e){return""}}function nr(e){return"".concat(e.appName,"!").concat(e.appId)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rr=new Map;function ir(e,t){var n=nr(e);ar(n,t),function(e,t){var n=sr();n&&n.postMessage({key:e,fid:t});ur()}(n,t)}function ar(e,t){var n=rr.get(e);if(n){var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){(0,o.value)(t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}}var or=null;function sr(){return!or&&"BroadcastChannel"in self&&((or=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){ar(e.data.key,e.data.fid)}),or}function ur(){0===rr.size&&or&&(or.close(),or=null)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cr="firebase-installations-store",lr=null;function hr(){return lr||(lr=Sn("firebase-installations-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(cr)}})),lr}function fr(e,t){return dr.apply(this,arguments)}function dr(){return(dr=e(a)(e(m).mark((function t(n,r){var i,a,o,s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=nr(n),e.next=3,hr();case 3:return a=e.sent,o=a.transaction(cr,"readwrite"),s=o.objectStore(cr),e.next=8,s.get(i);case 8:return u=e.sent,e.next=11,s.put(r,i);case 11:return e.next=13,o.done;case 13:return u&&u.fid===r.fid||ir(n,r.fid),e.abrupt("return",r);case 15:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function pr(e){return vr.apply(this,arguments)}function vr(){return(vr=e(a)(e(m).mark((function t(n){var r,i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=nr(n),e.next=3,hr();case 3:return i=e.sent,a=i.transaction(cr,"readwrite"),e.next=7,a.objectStore(cr).delete(r);case 7:return e.next=9,a.done;case 9:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function yr(e,t){return mr.apply(this,arguments)}function mr(){return(mr=e(a)(e(m).mark((function t(n,r){var i,a,o,s,u,c;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=nr(n),e.next=3,hr();case 3:return a=e.sent,o=a.transaction(cr,"readwrite"),s=o.objectStore(cr),e.next=8,s.get(i);case 8:if(u=e.sent,void 0!==(c=r(u))){e.next=15;break}return e.next=13,s.delete(i);case 13:e.next=17;break;case 15:return e.next=17,s.put(c,i);case 17:return e.next=19,o.done;case 19:return!c||u&&u.fid===c.fid||ir(n,c.fid),e.abrupt("return",c);case 21:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function gr(e){return kr.apply(this,arguments)}function kr(){return(kr=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n){var r,i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,yr(n.appConfig,(function(e){var t=_r(e),i=wr(n,t);return r=i.registrationPromise,i.installationEntry}));case 3:if(""!==(i=e.sent).fid){e.next=9;break}return e.next=7,r;case 7:return e.t0=e.sent,e.abrupt("return",{installationEntry:e.t0});case 9:return e.abrupt("return",{installationEntry:i,registrationPromise:r});case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function _r(e){return xr(e||{fid:tr(),registrationStatus:0})}function wr(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Vn.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return br.apply(this,arguments)}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Er(e)}:{installationEntry:t}}function br(){return(br=e(a)(e(m).mark((function t(n,r){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xn(n,r);case 3:return i=e.sent,e.abrupt("return",fr(n.appConfig,i));case 7:if(e.prev=7,e.t0=e.catch(0),!qn(e.t0)||409!==e.t0.customData.serverCode){e.next=14;break}return e.next=12,pr(n.appConfig);case 12:e.next=16;break;case 14:return e.next=16,fr(n.appConfig,{fid:r.fid,registrationStatus:0});case 16:throw e.t0;case 17:case"end":return e.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function Er(e){return Ir.apply(this,arguments)}function Ir(){return(Ir=e(a)(e(m).mark((function t(n){var r,i,a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tr(n.appConfig);case 2:r=e.sent;case 3:if(1!==r.registrationStatus){e.next=11;break}return e.next=6,Zn(100);case 6:return e.next=8,Tr(n.appConfig);case 8:r=e.sent,e.next=3;break;case 11:if(0!==r.registrationStatus){e.next=22;break}return e.next=14,gr(n);case 14:if(i=e.sent,a=i.installationEntry,!(o=i.registrationPromise)){e.next=21;break}return e.abrupt("return",o);case 21:return e.abrupt("return",a);case 22:return e.abrupt("return",r);case 23:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Tr(e){return yr(e,(function(e){if(!e)throw Vn.create("installation-not-found");return xr(e)}))}function xr(e){return 1===(t=e).registrationStatus&&t.registrationTime+Mn<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}function Cr(e,t){return Sr.apply(this,arguments)}function Sr(){return(Sr=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){var i,a,o,s,u,c,l,h,f,d,p;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.appConfig,a=n.heartbeatServiceProvider,o=Ar(i,r),s=Qn(i,r),!(u=a.getImmediate({optional:!0}))){e.next=9;break}return e.next=7,u.getHeartbeatsHeader();case 7:(c=e.sent)&&s.append("x-firebase-client",c);case 9:return l={installation:{sdkVersion:Un,appId:i.appId}},h={method:"POST",headers:s,body:JSON.stringify(l)},e.next=13,Yn((function(){return fetch(o,h)}));case 13:if(!(f=e.sent).ok){e.next=22;break}return e.next=17,f.json();case 17:return d=e.sent,p=Hn(d),e.abrupt("return",p);case 22:return e.next=24,Wn("Generate Auth Token",f);case 24:throw e.sent;case 25:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ar(e,t){var n=t.fid;return"".concat(zn(e),"/").concat(n,"/authTokens:generate")}function Rr(e){return Nr.apply(this,arguments)}function Nr(){return Nr=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n){var r,i,a,o,s=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]&&s[1],e.next=4,yr(n.appConfig,(function(e){if(!Ur(e))throw Vn.create("not-registered");var t=e.authToken;if(!r&&Fr(t))return e;if(1===t.requestStatus)return i=Or(n,r),e;if(!navigator.onLine)throw Vn.create("app-offline");var a=Br(e);return i=Lr(n,a),a}));case 4:if(a=e.sent,!i){e.next=11;break}return e.next=8,i;case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=a.authToken;case 12:return o=e.t0,e.abrupt("return",o);case 14:case"end":return e.stop()}}),t)}))),Nr.apply(this,arguments)}function Or(e,t){return Pr.apply(this,arguments)}function Pr(){return(Pr=e(a)(e(m).mark((function t(n,r){var i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Dr(n.appConfig);case 2:i=e.sent;case 3:if(1!==i.authToken.requestStatus){e.next=11;break}return e.next=6,Zn(100);case 6:return e.next=8,Dr(n.appConfig);case 8:i=e.sent,e.next=3;break;case 11:if(0!==(a=i.authToken).requestStatus){e.next=16;break}return e.abrupt("return",Rr(n,r));case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Dr(e){return yr(e,(function(e){if(!Ur(e))throw Vn.create("not-registered");var t,n=e.authToken;return 1===(t=n).requestStatus&&t.requestTime+Mn<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e}))}function Lr(e,t){return Mr.apply(this,arguments)}function Mr(){return(Mr=e(a)(e(m).mark((function t(n,r){var i,a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Cr(n,r);case 3:return i=e.sent,a=Object.assign(Object.assign({},r),{authToken:i}),e.next=7,fr(n.appConfig,a);case 7:return e.abrupt("return",i);case 10:if(e.prev=10,e.t0=e.catch(0),!qn(e.t0)||401!==e.t0.customData.serverCode&&404!==e.t0.customData.serverCode){e.next=17;break}return e.next=15,pr(n.appConfig);case 15:e.next=20;break;case 17:return o=Object.assign(Object.assign({},r),{authToken:{requestStatus:0}}),e.next=20,fr(n.appConfig,o);case 20:throw e.t0;case 21:case"end":return e.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function Ur(e){return void 0!==e&&2===e.registrationStatus}function Fr(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Bn}(e)}function Br(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function jr(){return(jr=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n){var r,i,a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n,e.next=3,gr(r);case 3:return i=e.sent,a=i.installationEntry,(o=i.registrationPromise)?o.catch(console.error):Rr(r).catch(console.error),e.abrupt("return",a.fid);case 8:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Vr(){return Vr=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n){var r,i,a,o=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]&&o[1],i=n,e.next=4,qr(i);case 4:return e.next=6,Rr(i,r);case 6:return a=e.sent,e.abrupt("return",a.token);case 8:case"end":return e.stop()}}),t)}))),Vr.apply(this,arguments)}function qr(e){return zr.apply(this,arguments)}function zr(){return(zr=e(a)(e(m).mark((function t(n){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gr(n);case 2:if(!(r=e.sent.registrationPromise)){e.next=6;break}return e.next=6,r;case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Hr(e){return Vn.create("missing-app-config-values",{valueName:e})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wr="installations",Kr=function(e){var t=Gt(e.getProvider("app").getImmediate(),Wr).getImmediate(),n={getId:function(){return function(e){return jr.apply(this,arguments)}(t)},getToken:function(e){return function(e){return Vr.apply(this,arguments)}(t,e)}};return n};Kt(new rt(Wr,(function(e){var t=e.getProvider("app").getImmediate(),n=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){if(!e||!e.options)throw Hr("App Configuration");if(!e.name)throw Hr("App Name");var t=!0,n=!1,r=void 0;try{for(var i,a=["projectId","apiKey","appId"][Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(!e.options[o])throw Hr(o)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Gt(t,"heartbeat"),_delete:function(){return Promise.resolve()}}}),"PUBLIC")),Kt(new rt("installations-internal",Kr,"PRIVATE")),en(Dn,Ln),en(Dn,Ln,"esm2017");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Gr,Qr="analytics",Yr=6e4,Jr="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Xr="https://www.googletagmanager.com/gtag/js",$r=new vt("@firebase/analytics"),Zr=(Gr={},e(l)(Gr,"already-exists","A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId."),e(l)(Gr,"already-initialized","initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance."),e(l)(Gr,"already-initialized-settings","Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect."),e(l)(Gr,"interop-component-reg-failed","Firebase Analytics Interop Component failed to instantiate: {$reason}"),e(l)(Gr,"invalid-analytics-context","Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}"),e(l)(Gr,"indexeddb-unavailable","IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}"),e(l)(Gr,"fetch-throttle","The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}."),e(l)(Gr,"config-fetch-failed","Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}"),e(l)(Gr,"no-api-key",'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.'),e(l)(Gr,"no-app-id",'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'),e(l)(Gr,"no-client-id",'The "client_id" field is empty.'),e(l)(Gr,"invalid-gtag-resource","Trusted Types detected an invalid gtag resource: {$gtagURL}."),Gr),ei=new Oe("analytics","Analytics",Zr);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ti(e){if(!e.startsWith(Xr)){var t=ei.create("invalid-gtag-resource",{gtagURL:e});return $r.warn(t.message),""}return e}function ni(e){return Promise.all(e.map((function(e){return e.catch((function(e){return e}))})))}function ri(e,t){var n=function(e,t){var n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:ti}),r=document.createElement("script"),i="".concat(Xr,"?l=").concat(e,"&id=").concat(t);r.src=n?null==n?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function ii(e,t,n,r,i,a){return ai.apply(this,arguments)}function ai(){return(ai=e(a)(e(m).mark((function t(n,r,i,a,o,s){var u,c,l;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=a[o],e.prev=1,!u){e.next=7;break}return e.next=5,r[u];case 5:e.next=14;break;case 7:return e.next=9,ni(i);case 9:if(c=e.sent,!(l=c.find((function(e){return e.measurementId===o})))){e.next=14;break}return e.next=14,r[l.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),$r.error(e.t0);case 19:n("config",o,s);case 20:case"end":return e.stop()}}),t,null,[[1,16]])})))).apply(this,arguments)}function oi(e,t,n,r,i){return si.apply(this,arguments)}function si(){return(si=e(a)(e(m).mark((function t(n,r,i,a,o){var s,u,c,l,h,f,d,p,v,y,g;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=[],!o||!o.send_to){e.next=38;break}return u=o.send_to,Array.isArray(u)||(u=[u]),e.next=7,ni(i);case 7:c=e.sent,l=!0,h=!1,f=void 0,e.prev=9,d=u[Symbol.iterator]();case 11:if(l=(p=d.next()).done){e.next=24;break}if(v=p.value,y=c.find((function(e){return e.measurementId===v})),!(g=y&&r[y.appId])){e.next=19;break}s.push(g),e.next=21;break;case 19:return s=[],e.abrupt("break",24);case 21:l=!0,e.next=11;break;case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(9),h=!0,f=e.t0;case 30:e.prev=30,e.prev=31,l||null==d.return||d.return();case 33:if(e.prev=33,!h){e.next=36;break}throw f;case 36:return e.finish(33);case 37:return e.finish(30);case 38:return 0===s.length&&(s=Object.values(r)),e.next=41,Promise.all(s);case 41:n("event",a,o||{}),e.next=47;break;case 44:e.prev=44,e.t1=e.catch(0),$r.error(e.t1);case 47:case"end":return e.stop()}}),t,null,[[0,44],[9,26,30,38],[31,,33,37]])})))).apply(this,arguments)}function ui(t,n,r,i,o){var s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[i].push(arguments)};return window[o]&&"function"==typeof window[o]&&(s=window[o]),window[o]=function(t,n,r,i){function o(){return o=e(a)(e(m).mark((function a(o){var s,u,c,l,f,d,p,v,y,g,_,w,b,E,I,T,x,C=arguments;return e(m).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:for(s=C.length,u=new Array(s>1?s-1:0),c=1;c<s;c++)u[c-1]=C[c];if(a.prev=1,"event"!==o){a.next=8;break}return l=e(k)(u,2),f=l[0],d=l[1],a.next=6,oi(t,n,r,f,d);case 6:a.next=15;break;case 8:if("config"!==o){a.next=14;break}return p=e(k)(u,2),v=p[0],y=p[1],a.next=12,ii(t,n,r,i,v,y);case 12:a.next=15;break;case 14:"consent"===o?(g=e(k)(u,1),_=g[0],t("consent","update",_)):"get"===o?(w=e(k)(u,3),b=w[0],E=w[1],I=w[2],t("get",b,E,I)):"set"===o?(T=e(k)(u,1),x=T[0],t("set",x)):t.apply(void 0,[o].concat(e(h)(u)));case 15:a.next=20;break;case 17:a.prev=17,a.t0=a.catch(1),$r.error(a.t0);case 20:case"end":return a.stop()}}),a,null,[[1,17]])}))),o.apply(this,arguments)}return function(e){return o.apply(this,arguments)}}(s,t,n,r),{gtagCore:s,wrappedGtag:window[o]}}function ci(e){var t=window.document.getElementsByTagName("script"),n=!0,r=!1,i=void 0;try{for(var a,o=Object.values(t)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.src&&s.src.includes(Xr)&&s.src.includes(e))return s}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var li=function(){"use strict";function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;e(s)(this,t),this.throttleMetadata=n,this.intervalMillis=r}return e(u)(t,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),t}(),hi=new li;function fi(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function di(e){return pi.apply(this,arguments)}function pi(){return(pi=e(a)(e(m).mark((function t(n){var r,i,a,o,s,u,c,l;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.appId,a=n.apiKey,o={method:"GET",headers:fi(a)},s=Jr.replace("{app-id}",i),e.next=6,fetch(s,o);case 6:if(200===(u=e.sent).status||304===u.status){e.next=19;break}return c="",e.prev=9,e.next=12,u.json();case 12:l=e.sent,(null===(r=l.error)||void 0===r?void 0:r.message)&&(c=l.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw ei.create("config-fetch-failed",{httpStatus:u.status,responseMessage:c});case 19:return e.abrupt("return",u.json());case 20:case"end":return e.stop()}}),t,null,[[9,16]])})))).apply(this,arguments)}function vi(e){return yi.apply(this,arguments)}function yi(){return yi=e(a)(e(m).mark((function t(n){var r,i,o,s,u,c,l,h,f=arguments;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=f.length>1&&void 0!==f[1]?f[1]:hi,i=f.length>2?f[2]:void 0,o=n.options,s=o.appId,u=o.apiKey,c=o.measurementId,s){t.next=4;break}throw ei.create("no-app-id");case 4:if(u){t.next=8;break}if(!c){t.next=7;break}return t.abrupt("return",{measurementId:c,appId:s});case 7:throw ei.create("no-api-key");case 8:return l=r.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},h=new Ei,setTimeout(e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.abort();case 1:case"end":return e.stop()}}),t)}))),void 0!==i?i:Yr),t.abrupt("return",mi({appId:s,apiKey:u,measurementId:c},l,h,r));case 12:case"end":return t.stop()}}),t)}))),yi.apply(this,arguments)}function mi(e,t,n){return gi.apply(this,arguments)}function gi(){return gi=e(a)(e(m).mark((function t(n,r,i){var a,o,s,u,c,l,h,f,d,p,v=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.throttleEndTimeMillis,o=r.backoffCount,s=v.length>3&&void 0!==v[3]?v[3]:hi,c=n.appId,l=n.measurementId,e.prev=3,e.next=6,ki(i,a);case 6:e.next=14;break;case 8:if(e.prev=8,e.t0=e.catch(3),!l){e.next=13;break}return $r.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(l)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===e.t0||void 0===e.t0?void 0:e.t0.message,"]")),e.abrupt("return",{appId:c,measurementId:l});case 13:throw e.t0;case 14:return e.prev=14,e.next=17,di(n);case 17:return h=e.sent,s.deleteThrottleMetadata(c),e.abrupt("return",h);case 22:if(e.prev=22,e.t1=e.catch(14),_i(f=e.t1)){e.next=33;break}if(s.deleteThrottleMetadata(c),!l){e.next=32;break}return $r.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(l)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null==f?void 0:f.message,"]")),e.abrupt("return",{appId:c,measurementId:l});case 32:throw e.t1;case 33:return d=503===Number(null===(u=null==f?void 0:f.customData)||void 0===u?void 0:u.httpStatus)?tt(o,s.intervalMillis,30):tt(o,s.intervalMillis),p={throttleEndTimeMillis:Date.now()+d,backoffCount:o+1},s.setThrottleMetadata(c,p),$r.debug("Calling attemptFetch again in ".concat(d," millis")),e.abrupt("return",mi(n,p,i,s));case 38:case"end":return e.stop()}}),t,null,[[3,8],[14,22]])}))),gi.apply(this,arguments)}function ki(e,t){return new Promise((function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener((function(){clearTimeout(a),r(ei.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}function _i(e){if(!(e instanceof Ne&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var wi,bi,Ei=function(){"use strict";function t(){e(s)(this,t),this.listeners=[]}return e(u)(t,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach((function(e){return e()}))}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ii(){return(Ii=e(a)(e(m).mark((function t(n,r,i,a,o){var s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o||!o.global){e.next=5;break}return n("event",i,a),e.abrupt("return");case 5:return e.next=7,r;case 7:s=e.sent,u=Object.assign(Object.assign({},a),{send_to:s}),n("event",i,u);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ti(e){bi=e}function xi(e){wi=e}function Ci(){return Si.apply(this,arguments)}function Si(){return(Si=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Se()){e.next=5;break}return $r.warn(ei.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),e.abrupt("return",!1);case 5:return e.prev=5,e.next=8,Ae();case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(5),$r.warn(ei.create("indexeddb-unavailable",{errorInfo:null===e.t0||void 0===e.t0?void 0:e.t0.toString()}).message),e.abrupt("return",!1);case 14:return e.abrupt("return",!0);case 15:case"end":return e.stop()}}),t,null,[[5,10]])})))).apply(this,arguments)}function Ai(){return(Ai=e(a)(e(m).mark((function t(n,r,i,a,o,s,u){var c,l,h,f,d,p,v;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(l=vi(n)).then((function(e){i[e.measurementId]=e.appId,n.options.measurementId&&e.measurementId!==n.options.measurementId&&$r.warn("The measurement ID in the local Firebase config (".concat(n.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(e.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(e){return $r.error(e)})),r.push(l),h=Ci().then((function(e){return e?a.getId():void 0})),t.t0=e(k),t.next=8,Promise.all([l,h]);case 8:return t.t1=t.sent,f=(0,t.t0)(t.t1,2),d=f[0],p=f[1],ci(s)||ri(s,d.measurementId),bi&&(o("consent","default",bi),Ti(void 0)),o("js",new Date),(v=null!==(c=null==u?void 0:u.config)&&void 0!==c?c:{}).origin="firebase",v.update=!0,null!=p&&(v.firebase_id=p),o("config",d.measurementId,v),wi&&(o("set",wi),xi(void 0)),t.abrupt("return",d.measurementId);case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ri,Ni,Oi=function(){"use strict";function t(n){e(s)(this,t),this.app=n}return e(u)(t,[{key:"_delete",value:function(){return delete Pi[this.app.options.appId],Promise.resolve()}}]),t}(),Pi={},Di=[],Li={},Mi="dataLayer",Ui="gtag",Fi=!1;function Bi(e,t,n){!function(){var e=[];if(Te()&&e.push("This is a browser extension environment."),Re()||e.push("Cookies are not available."),e.length>0){var t=e.map((function(e,t){return"(".concat(t+1,") ").concat(e)})).join(" "),n=ei.create("invalid-analytics-context",{errorInfo:t});$r.warn(n.message)}}();var r,i,a=e.options.appId;if(!a)throw ei.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw ei.create("no-api-key");$r.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(e.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=Pi[a])throw ei.create("already-exists",{id:a});if(!Fi){r=Mi,i=[],Array.isArray(window[r])?i=window[r]:window[r]=i;var o=ui(Pi,Di,Li,Mi,Ui),s=o.wrappedGtag,u=o.gtagCore;Ni=s,Ri=u,Fi=!0}return Pi[a]=function(e,t,n,r,i,a,o){return Ai.apply(this,arguments)}(e,Di,Li,t,Ri,Mi,n),new Oi(e)}function ji(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Gt(e,Qr);if(n.isInitialized()){var r=n.getImmediate();if(ze(t,n.getOptions()))return r;throw ei.create("already-initialized")}var i=n.initialize({options:t});return i}function Vi(e,t,n,r){e=nt(e),function(e,t,n,r,i){return Ii.apply(this,arguments)}(Ni,Pi[e.app.options.appId],t,n,r).catch((function(e){return $r.error(e)}))}var qi="@firebase/analytics",zi="0.10.0";Kt(new rt(Qr,(function(e,t){var n=t.options;return Bi(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),Kt(new rt("analytics-internal",(function(e){try{var t=e.getProvider(Qr).getImmediate();return{logEvent:function(e,n,r){return Vi(t,e,n,r)}}}catch(e){throw ei.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),en(qi,zi),en(qi,zi,"esm2017");T=i("ds8z5");var Hi=i("l5bVx"),Wi="@firebase/database",Ki="1.0.1",Gi="";function Qi(e){Gi=e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yi,Ji=function(){"use strict";function t(n){e(s)(this,t),this.domStorage_=n,this.prefix_="firebase:"}return e(u)(t,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Me(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Le(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),t}(),Xi=function(){"use strict";function t(){e(s)(this,t),this.cache_={},this.isInMemoryStorage=!0}return e(u)(t,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return Be(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),t}(),$i=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Ji(t)}}catch(e){}return new Xi},Zi=$i("localStorage"),ea=$i("sessionStorage"),ta=new vt("@firebase/database"),na=(Yi=1,function(){return Yi++}),ra=function(e){var t=$e(e),n=new Qe;n.update(t);var r=n.digest();return ue.encodeByteArray(r)},ia=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r="",i=0;i<t.length;i++){var a=t[i];Array.isArray(a)||a&&"object"==typeof a&&"number"==typeof a.length?r+=ia.apply(null,a):r+="object"==typeof a?Me(a):a,r+=" "}return r},aa=null,oa=!0,sa=function(e,t){ae(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(ta.logLevel=ot.VERBOSE,aa=ta.log.bind(ta),t&&ea.set("logging_enabled",!0)):"function"==typeof e?aa=e:(aa=null,ea.remove("logging_enabled"))},ua=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!0===oa&&(oa=!1,null===aa&&!0===ea.get("logging_enabled")&&sa(!0)),aa){var r=ia.apply(null,t);aa(r)}},ca=function(t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];ua.apply(void 0,[t].concat(e(h)(r)))}},la=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i="FIREBASE INTERNAL ERROR: "+ia.apply(void 0,e(h)(n));ta.error(i)},ha=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i="FIREBASE FATAL ERROR: ".concat(ia.apply(void 0,e(h)(n)));throw ta.error(i),new Error(i)},fa=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i="FIREBASE WARNING: "+ia.apply(void 0,e(h)(n));ta.warn(i)},da=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},pa="[MIN_NAME]",va="[MAX_NAME]",ya=function(e,t){if(e===t)return 0;if(e===pa||t===va)return-1;if(t===pa||e===va)return 1;var n=Ia(e),r=Ia(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},ma=function(e,t){return e===t?0:e<t?-1:1},ga=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Me(t))},ka=function(e){if("object"!=typeof e||null===e)return Me(e);var t=[];for(var n in e)t.push(n);t.sort();for(var r="{",i=0;i<t.length;i++)0!==i&&(r+=","),r+=Me(t[i]),r+=":",r+=ka(e[t[i]]);return r+="}"},_a=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wa(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var ba=function(e){ae(!da(e),"Invalid JSON number");var t,n,r,i,a,o=1023;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()};var Ea=new RegExp("^-?(0*)\\d{1,10}$"),Ia=function(e){if(Ea.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Ta=function(e){try{e()}catch(e){setTimeout((function(){var t=e.stack||"";throw fa("Exception was thrown by user callback.",t),e}),Math.floor(0))}},xa=function(e,t){var n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n},Ca=function(){"use strict";function t(n,r){var i=this;e(s)(this,t),this.appName_=n,this.appCheckProvider=r,this.appCheck=null==r?void 0:r.getImmediate({optional:!0}),this.appCheck||null==r||r.get().then((function(e){return i.appCheck=e}))}return e(u)(t,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){var i=t;setTimeout((function(){i.appCheck?i.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){fa('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}]),t}(),Sa=function(){"use strict";function t(n,r,i){var a=this;e(s)(this,t),this.appName_=n,this.firebaseOptions_=r,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit((function(e){return a.auth_=e}))}return e(u)(t,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(ua("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){var i=t;setTimeout((function(){i.auth_?i.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',fa(e)}}]),t}(),Aa=function(){"use strict";function t(n){e(s)(this,t),this.accessToken=n}return e(u)(t,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),t}();Aa.OWNER="owner";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ra="5",Na=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Oa="websocket",Pa="long_polling",Da=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]&&arguments[7];e(s)(this,t),this.secure=r,this.namespace=i,this.webSocketOnly=a,this.nodeAdmin=o,this.persistenceKey=u,this.includeNamespaceInQueryParams=c,this.isUsingEmulator=l,this._host=n.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Zi.get("host:"+n)||this._host}return e(u)(t,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Zi.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}]),t}();function La(e,t,n){var r;if(ae("string"==typeof t,"typeof type must == string"),ae("object"==typeof n,"typeof params must == object"),t===Oa)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Pa)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return wa(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ma=function(){"use strict";function t(){e(s)(this,t),this.counters_={}}return e(u)(t,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Be(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return de(this.counters_)}}]),t}(),Ua={},Fa={};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ba(e){var t=e.toString();return Ua[t]||(Ua[t]=new Ma),Ua[t]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ja=function(){"use strict";function t(n){e(s)(this,t),this.onMessage_=n,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e(u)(t,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){var n=function(e){i[e]&&Ta((function(){r.onMessage_(i[e])}))},r=this,i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(var a=0;a<i.length;++a)n(a);if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}]),t}(),Va="start",qa="close",za=function(){"use strict";function t(n,r,i,a,o,u,c){var l=this;e(s)(this,t),this.connId=n,this.repoInfo=r,this.applicationId=i,this.appCheckToken=a,this.authToken=o,this.transportSessionId=u,this.lastSessionId=c,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ca(n),this.stats_=Ba(r),this.urlFn=function(e){return l.appCheckToken&&(e.ac=l.appCheckToken),La(r,Pa,e)}}return e(u)(t,[{key:"open",value:function(t,n){var r=this;this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new ja(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){r.log_("Timed out trying to connect."),r.onClosed_(),r.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(Ce()||"complete"===document.readyState)e();else{var t=!1,n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){var t=r;if(!r.isClosed_){r.scriptTagHolder=new Ha((function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=e(k)(r,5),o=a[0],s=a[1],u=a[2];a[3],a[4];if(t.incrementIncomingBytes_(r),t.scriptTagHolder)if(t.connectTimeoutTimer_&&(clearTimeout(t.connectTimeoutTimer_),t.connectTimeoutTimer_=null),t.everConnected_=!0,o===Va)t.id=s,t.password=u;else{if(o!==qa)throw new Error("Unrecognized command received: "+o);if(s){var c=t;t.scriptTagHolder.sendNewPolls=!1,t.myPacketOrderer.closeAfter(s,(function(){c.onClosed_()}))}else t.onClosed_()}}),(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=e(k)(r,2),o=a[0],s=a[1];t.incrementIncomingBytes_(r),t.myPacketOrderer.handleResponse(o,s)}),(function(){t.onClosed_()}),r.urlFn);var n={start:"t"};n.ser=Math.floor(1e8*Math.random()),r.scriptTagHolder.uniqueCallbackIdentifier&&(n.cb=r.scriptTagHolder.uniqueCallbackIdentifier),n.v=Ra,r.transportSessionId&&(n.s=r.transportSessionId),r.lastSessionId&&(n.ls=r.lastSessionId),r.applicationId&&(n.p=r.applicationId),r.appCheckToken&&(n.ac=r.appCheckToken),"undefined"!=typeof location&&location.hostname&&Na.test(location.hostname)&&(n.r="f");var i=r.urlFn(n);r.log_("Connecting via long-poll to "+i),r.scriptTagHolder.addTag(i,(function(){}))}}))}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=Me(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=le(t),r=_a(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){if(!Ce()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}}},{key:"incrementIncomingBytes_",value:function(e){var t=Me(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){t.forceAllow_=!0}},{key:"forceDisallow",value:function(){t.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!Ce()&&(!!t.forceAllow_||!(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}}]),t}(),Ha=function(){"use strict";function t(n,r,i,a){if(e(s)(this,t),this.onDisconnect=i,this.urlFn=a,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Ce())this.commandCB=n,this.onMessageCB=r;else{this.uniqueCallbackIdentifier=na(),window["pLPCommand"+this.uniqueCallbackIdentifier]=n,window["pRTLPCB"+this.uniqueCallbackIdentifier]=r,this.myIFrame=t.createIFrame_();var o="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11))o='<script>document.domain="'+document.domain+'";<\/script>';var u="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(u),this.myIFrame.doc.close()}catch(e){ua("frame writing exception"),e.stack&&ua(e.stack),ua(e)}}}return e(u)(t,[{key:"close",value:function(){if(this.alive=!1,this.myIFrame){var e=this;this.myIFrame.doc.body.textContent="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0))}var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))}},{key:"addTag",value:function(e,t){var n=this;Ce()?this.doNodeLongPoll(e,t):setTimeout((function(){try{var r=n;if(!n.sendNewPolls)return;var i=n.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){var e=i.readyState;e&&"loaded"!==e&&"complete"!==e||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=function(){ua("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},n.myIFrame.doc.body.appendChild(i)}catch(e){}}),Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||ua("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),t}(),Wa=null;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */"undefined"!=typeof MozWebSocket?Wa=MozWebSocket:"undefined"!=typeof WebSocket&&(Wa=WebSocket);var Ka=function(){"use strict";function t(n,r,i,a,o,u,c){e(s)(this,t),this.connId=n,this.applicationId=i,this.appCheckToken=a,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ca(this.connId),this.stats_=Ba(r),this.connURL=t.connectionURL_(r,u,c,a,i),this.nodeAdmin=r.nodeAdmin}return e(u)(t,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Zi.set("previous_websocket_failure",!0);try{var r;if(Ce()){var i=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":"Firebase/".concat(Ra,"/").concat(Gi,"/").concat(V.platform,"/").concat(i),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);var a={},o=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;o&&(r.proxy={origin:o})}this.mySock=new Wa(this.connURL,[],r)}catch(e){this.log_("Error instantiating WebSocket.");var s=e.message||e.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){Zi.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=Le(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(ae(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=Me(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=_a(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r,i){var a={};return a.v=Ra,!Ce()&&"undefined"!=typeof location&&location.hostname&&Na.test(location.hostname)&&(a.r="f"),t&&(a.s=t),n&&(a.ls=n),r&&(a.ac=r),i&&(a.p=i),La(e,Oa,a)}},{key:"forceDisallow",value:function(){t.forceDisallow_=!0}},{key:"isAvailable",value:function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Wa&&!t.forceDisallow_}},{key:"previouslyFailed",value:function(){return Zi.isInMemoryStorage||!0===Zi.get("previous_websocket_failure")}}]),t}();Ka.responsesRequiredToBeHealthy=2,Ka.healthyTimeout=3e4;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ga=function(){"use strict";function t(n){e(s)(this,t),this.initTransports_(n)}return e(u)(t,[{key:"initTransports_",value:function(e){var n=Ka&&Ka.isAvailable(),r=n&&!Ka.previouslyFailed();if(e.webSocketOnly&&(n||fa("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Ka];else{var i=this.transports_=[],a=!0,o=!1,s=void 0;try{for(var u,c=t.ALL_TRANSPORTS[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;l&&l.isAvailable()&&i.push(l)}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}t.globalTransportInitialized_=!0}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[za,Ka]}},{key:"IS_TRANSPORT_INITIALIZED",get:function(){return this.globalTransportInitialized_}}]),t}();Ga.globalTransportInitialized_=!1;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Qa=function(){"use strict";function t(n,r,i,a,o,u,c,l,h,f){e(s)(this,t),this.id=n,this.repoInfo_=r,this.applicationId_=i,this.appCheckToken_=a,this.authToken_=o,this.onMessage_=u,this.onReady_=c,this.onDisconnect_=l,this.onKill_=h,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ca("c:"+this.id+":"),this.transportManager_=new Ga(r),this.log_("Connection created"),this.start_()}return e(u)(t,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=xa((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){var t={t:"d",d:e};this.sendData_(t)}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=ga("t",e),n=ga("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=ga("t",e),n=ga("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=ga("t",e);if("d"in e){var n=e.d;if("h"===t){var r=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?la("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):la("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Ra!==n&&fa("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),xa((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):xa((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Zi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),t}(),Ya=function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),t}(),Ja=function(){"use strict";function t(n){e(s)(this,t),this.allowedEvents_=n,this.listeners_={},ae(Array.isArray(n)&&n.length>0,"Requires a non-empty array")}return e(u)(t,[{key:"trigger",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(Array.isArray(this.listeners_[t]))for(var a=e(h)(this.listeners_[t]),o=0;o<a.length;o++)a[o].callback.apply(a[o].context,r)}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){ae(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)}}]),t}(),Xa=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){var t;return e(s)(this,r),(t=n.call(this,["online"])).online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Ie()||(window.addEventListener("online",(function(){t.online_||(t.online_=!0,t.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){t.online_&&(t.online_=!1,t.trigger("online",!1))}),!1)),t}return e(u)(r,[{key:"getInitialEvent",value:function(e){return ae("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new r}}]),r}(Ja),$a=function(){"use strict";function t(n,r){if(e(s)(this,t),void 0===r){this.pieces_=n.split("/");for(var i=0,a=0;a<this.pieces_.length;a++)this.pieces_[a].length>0&&(this.pieces_[i]=this.pieces_[a],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=n,this.pieceNum_=r}return e(u)(t,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),t}();function Za(){return new $a("")}function eo(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function to(e){return e.pieces_.length-e.pieceNum_}function no(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new $a(e.pieces_,t)}function ro(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function io(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function ao(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new $a(t,0)}function oo(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof $a)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var a=t.split("/"),o=0;o<a.length;o++)a[o].length>0&&n.push(a[o]);return new $a(n,0)}function so(e){return e.pieceNum_>=e.pieces_.length}function uo(e,t){var n=eo(e),r=eo(t);if(null===n)return t;if(n===r)return uo(no(e),no(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function co(e,t){if(to(e)!==to(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function lo(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(to(e)>to(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var ho=function t(n,r){"use strict";e(s)(this,t),this.errorPrefix_=r,this.parts_=io(n,0),this.byteLength_=Math.max(1,this.parts_.length);for(var i=0;i<this.parts_.length;i++)this.byteLength_+=Ze(this.parts_[i]);fo(this)};function fo(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+po(e))}function po(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vo=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){var t,i,a;return e(s)(this,r),t=n.call(this,["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(a="visibilitychange",i="hidden"):void 0!==document.mozHidden?(a="mozvisibilitychange",i="mozHidden"):void 0!==document.msHidden?(a="msvisibilitychange",i="msHidden"):void 0!==document.webkitHidden&&(a="webkitvisibilitychange",i="webkitHidden")),t.visible_=!0,a&&document.addEventListener(a,(function(){var e=!document[i];e!==t.visible_&&(t.visible_=e,t.trigger("visible",e))}),!1),t}return e(u)(r,[{key:"getInitialEvent",value:function(e){return ae("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new r}}]),r}(Ja),yo=1e3,mo=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a,o,u,c,l,h){var f;if(e(s)(this,r),(f=n.call(this)).repoInfo_=t,f.applicationId_=i,f.onDataUpdate_=a,f.onConnectStatus_=o,f.onServerInfoUpdate_=u,f.authTokenProvider_=c,f.appCheckTokenProvider_=l,f.authOverride_=h,f.id=r.nextPersistentConnectionId_++,f.log_=ca("p:"+f.id+":"),f.interruptReasons_={},f.listens=new Map,f.outstandingPuts_=[],f.outstandingGets_=[],f.outstandingPutCount_=0,f.outstandingGetCount_=0,f.onDisconnectRequestQueue_=[],f.connected_=!1,f.reconnectDelay_=yo,f.maxReconnectDelay_=3e5,f.securityDebugCallback_=null,f.lastSessionId=null,f.establishConnectionTimer_=null,f.visible_=!1,f.requestCBHash_={},f.requestNumber_=0,f.realtime_=null,f.authToken_=null,f.appCheckToken_=null,f.forceTokenRefresh_=!1,f.invalidAuthTokenCount_=0,f.invalidAppCheckTokenCount_=0,f.firstConnection_=!0,f.lastConnectionAttemptTime_=null,f.lastConnectionEstablishedTime_=null,h&&!Ce())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return vo.getInstance().on("visible",f.onVisible_,e(T)(f)),-1===t.host.indexOf("fblocal")&&Xa.getInstance().on("online",f.onOnline_,e(T)(f)),f}return e(u)(r,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(Me(i)),ae(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){this.initConnection_();var t=new we,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:function(e){var n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;var r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),ae(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ae(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))}},{key:"sendListen_",value:function(e){var t=this,n=e.query,i=n._path.toString(),a=n._queryIdentifier;this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=n._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,(function(o){var s=o.d,u=o.s;r.warnOnListenWarnings_(s,n),(t.listens.get(i)&&t.listens.get(i).get(a))===e&&(t.log_("listen response",o),"ok"!==u&&t.removeListen_(i,a),e.onComplete&&e.onComplete(u,s))}))}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){var t;(e&&40===e.length||"object"==typeof(t=Ue(e).claims)&&!0===t.admin)&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))}},{key:"tryAuth",value:function(){if(this.connected_&&this.authToken_){var e=this,t=this.authToken_,n=Fe(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),ae(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var a={p:t,d:n};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))}},{key:"reportStats",value:function(e){if(this.connected_){var t=this,n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+Me(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):la("Unrecognized action received from server: "+Me(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;ae(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=yo,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=yo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=yo),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var t=this;return e(a)(e(m).mark((function n(){var i,a,o,s,u,c,l,h,f,d,p,v,y;return e(m).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.shouldReconnect_()){n.next=31;break}return t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null,i=t.onDataMessage_.bind(t),a=t.onReady_.bind(t),o=t.onRealtimeDisconnect_.bind(t),s=t.id+":"+r.nextConnectionId_++,u=t.lastSessionId,c=!1,l=null,h=function(){l?l.close():(c=!0,o())},f=function(e){ae(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(e)},t.realtime_={close:h,sendRequest:f},d=t.forceTokenRefresh_,t.forceTokenRefresh_=!1,n.prev=16,n.t0=e(k),n.next=20,Promise.all([t.authTokenProvider_.getToken(d),t.appCheckTokenProvider_.getToken(d)]);case 20:n.t1=n.sent,p=(0,n.t0)(n.t1,2),v=p[0],y=p[1],c?ua("getToken() completed but was canceled"):(ua("getToken() completed. Creating connection."),t.authToken_=v&&v.accessToken,t.appCheckToken_=y&&y.token,l=new Qa(s,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,i,a,o,(function(e){fa(e+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")}),u)),n.next=31;break;case 27:n.prev=27,n.t2=n.catch(16),t.log_("Failed to get token: "+n.t2),c||(t.repoInfo_.nodeAdmin&&fa(n.t2),h());case 31:case"end":return n.stop()}}),n,null,[[16,27]])})))()}},{key:"interrupt",value:function(e){ua("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){ua("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Ve(this.interruptReasons_)&&(this.reconnectDelay_=yo,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map((function(e){return ka(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new $a(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){ua("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){ua("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e=!0,t=!1,n=void 0,r=!0,i=!1,a=void 0;try{for(var o,s=this.listens.values()[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;try{for(var c,l=u.values()[Symbol.iterator]();!(e=(c=l.next()).done);e=!0){var h=c.value;this.sendListen_(h)}}catch(e){t=!0,n=e}finally{try{e||null==l.return||l.return()}finally{if(t)throw n}}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}for(var f=0;f<this.outstandingPuts_.length;f++)this.outstandingPuts_[f]&&this.sendPut_(f);for(;this.onDisconnectRequestQueue_.length;){var d=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(d.action,d.pathString,d.data,d.onComplete)}for(var p=0;p<this.outstandingGets_.length;p++)this.outstandingGets_[p]&&this.sendGet_(p)}},{key:"sendConnectStats_",value:function(){var e={},t="js";Ce()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+Gi.replace(/\./g,"-")]=1,Ie()?e["framework.cordova"]=1:xe()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=Xa.getInstance().currentlyOnline();return Ve(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"==typeof e&&Be(e,"w")){var n=je(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();fa("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(r," at ")+"".concat(i," to your security rules for better performance."))}}}}]),r}(Ya);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mo.nextPersistentConnectionId_=0,mo.nextConnectionId_=0;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var go,ko=function(){"use strict";function t(n,r){e(s)(this,t),this.name=n,this.node=r}return e(u)(t,null,[{key:"Wrap",value:function(e,n){return new t(e,n)}}]),t}(),_o=function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new ko(pa,e),r=new ko(pa,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return ko.MIN}}]),t}(),wo=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(u)(r,[{key:"compare",value:function(e,t){return ya(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw oe("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return ko.MIN}},{key:"maxPost",value:function(){return new ko(va,go)}},{key:"makePost",value:function(e,t){return ae("string"==typeof e,"KeyIndex indexValue must always be a string."),new ko(e,go)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return go},set:function(e){go=e}}]),r}(_o),bo=new wo,Eo=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;e(s)(this,t),this.isReverse_=a,this.resultGenerator_=o,this.nodeStack_=[];for(var u=1;!n.isEmpty();)if(u=r?i(n.key,r):1,a&&(u*=-1),u<0)n=this.isReverse_?n.left:n.right;else{if(0===u){this.nodeStack_.push(n);break}this.nodeStack_.push(n),n=this.isReverse_?n.right:n.left}}return e(u)(t,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),t}(),Io=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.key=n,this.value=r,this.color=null!=i?i:t.RED,this.left=null!=a?a:Co.EMPTY_NODE,this.right=null!=o?o:Co.EMPTY_NODE}return e(u)(t,[{key:"copy",value:function(e,n,r,i,a){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return Co.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Co.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}},{key:"rotateRight_",value:function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Io.RED=!0,Io.BLACK=!1;var To,xo=function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new Io(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),t}(),Co=function(){"use strict";function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.EMPTY_NODE;e(s)(this,t),this.comparator_=n,this.root_=r}return e(u)(t,[{key:"insert",value:function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Io.BLACK,null,null))}},{key:"remove",value:function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Io.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new Eo(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new Eo(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new Eo(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new Eo(this.root_,null,this.comparator_,!0,e)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function So(e,t){return ya(e.name,t.name)}function Ao(e,t){return ya(e,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Co.EMPTY_NODE=new xo;var Ro,No,Oo,Po=function(e){return"number"==typeof e?"number:"+ba(e):"string:"+e},Do=function(e){if(e.isLeafNode()){var t=e.val();ae("string"==typeof t||"number"==typeof t||"object"==typeof t&&Be(t,".sv"),"Priority must be a string or number.")}else ae(e===To||e.isEmpty(),"priority of unexpected type.");ae(e===To||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Lo=function(){"use strict";function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.__childrenNodeConstructor.EMPTY_NODE;e(s)(this,t),this.value_=n,this.priorityNode_=r,this.lazyHash_=null,ae(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Do(this.priorityNode_)}return e(u)(t,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(e){return new t(this.value_,e)}},{key:"getImmediateChild",value:function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(e){return so(e)?this:".priority"===eo(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(e,n){var r=eo(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:(ae(".priority"!==r||1===to(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(no(e),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Po(this.priorityNode_.val())+":");var n=e(Hi)(this.value_);t+=n+":",t+="number"===n?ba(this.value_):this.value_,this.lazyHash_=ra(t)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(ae(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}},{key:"compareToLeafNode_",value:function(n){var r=e(Hi)(n.value_),i=e(Hi)(this.value_),a=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return ae(a>=0,"Unknown leaf type: "+r),ae(o>=0,"Unknown leaf type: "+i),a===o?"object"===i?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-a}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return Ro},set:function(e){Ro=e}}]),t}();Lo.VALUE_TYPE_ORDER=["object","boolean","number","string"];var Mo,Uo,Fo=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(u)(r,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?ya(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return ko.MIN}},{key:"maxPost",value:function(){return new ko(va,new Lo("[PRIORITY-POST]",Oo))}},{key:"makePost",value:function(e,t){var n=No(e);return new ko(t,new Lo("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),r}(_o),Bo=new Fo,jo=Math.log(2),Vo=function(){"use strict";function t(n){e(s)(this,t);var r;this.count=(r=n+1,parseInt(Math.log(r)/jo,10)),this.current_=this.count-1;var i,a=(i=this.count,parseInt(Array(i+1).join("1"),2));this.bits_=n+1&a}return e(u)(t,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),t}(),qo=function(e,t,n,r){e.sort(t);var i=function(t,r){var a,o,s=r-t;if(0===s)return null;if(1===s)return a=e[t],o=n?n(a):a,new Io(o,a.node,Io.BLACK,null,null);var u=parseInt(s/2,10)+t,c=i(t,u),l=i(u+1,r);return a=e[u],o=n?n(a):a,new Io(o,a.node,Io.BLACK,c,l)},a=function(t){for(var r=null,a=null,o=e.length,s=function(t,r){var a=o-t,s=o;o-=t;var c=i(a+1,s),l=e[a],h=n?n(l):l;u(new Io(h,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(a=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?s(h,Io.BLACK):(s(h,Io.BLACK),s(h,Io.RED))}return a}(new Vo(e.length));return new Co(r||t,a)},zo={},Ho=function(){"use strict";function t(n,r){e(s)(this,t),this.indexes_=n,this.indexSet_=r}return e(u)(t,[{key:"get",value:function(e){var t=je(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Co?t:null}},{key:"hasIndex",value:function(e){return Be(this.indexSet_,e.toString())}},{key:"addIndex",value:function(e,n){ae(e!==bo,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,o=n.getIterator(ko.Wrap),s=o.getNext();s;)a=a||e.isDefinedOn(s.node),i.push(s),s=o.getNext();r=a?qo(i,e.getCompare()):zo;var u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;var l=Object.assign({},this.indexes_);return l[u]=r,new t(l,c)}},{key:"addToIndexes",value:function(e,n){var r=this;return new t(qe(this.indexes_,(function(t,i){var a=je(r.indexSet_,i);if(ae(a,"Missing index implementation for "+i),t===zo){if(a.isDefinedOn(e.node)){for(var o=[],s=n.getIterator(ko.Wrap),u=s.getNext();u;)u.name!==e.name&&o.push(u),u=s.getNext();return o.push(e),qo(o,a.getCompare())}return zo}var c=n.get(e.name),l=t;return c&&(l=l.remove(new ko(e.name,c))),l.insert(e,e.node)})),this.indexSet_)}},{key:"removeFromIndexes",value:function(e,n){return new t(qe(this.indexes_,(function(t){if(t===zo)return t;var r=n.get(e.name);return r?t.remove(new ko(e.name,r)):t})),this.indexSet_)}}],[{key:"Default",get:function(){return ae(zo&&Bo,"ChildrenNode.ts has not been loaded"),Mo=Mo||new t({".priority":zo},{".priority":Bo})}}]),t}(),Wo=function(){"use strict";function t(n,r,i){e(s)(this,t),this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Do(this.priorityNode_),this.children_.isEmpty()&&ae(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return e(u)(t,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||Uo}},{key:"updatePriority",value:function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?Uo:t}},{key:"getChild",value:function(e){var t=eo(e);return null===t?this:this.getImmediateChild(t).getChild(no(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(e,n){if(ae(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r,i,a=new ko(e,n);n.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(a,this.children_)):(r=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(a,this.children_));var o=r.isEmpty()?Uo:this.priorityNode_;return new t(r,o,i)}},{key:"updateChild",value:function(e,t){var n=eo(e);if(null===n)return t;ae(".priority"!==eo(e)||1===to(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(no(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(e){if(this.isEmpty())return null;var n={},r=0,i=0,a=!0;if(this.forEachChild(Bo,(function(o,s){n[o]=s.val(e),r++,a&&t.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1})),!e&&a&&i<2*r){var o=[];for(var s in n)o[s]=n[s];return o}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Po(this.getPriority().val())+":"),this.forEachChild(Bo,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":ra(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new ko(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new ko(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new ko(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,ko.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,ko.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ko?-1:0}},{key:"withIndex",value:function(e){if(e===bo||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===bo||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(Bo),r=t.getIterator(Bo),i=n.getNext(),a=r.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=n.getNext(),a=r.getNext()}return null===i&&null===a}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===bo?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return Uo||(Uo=new t(new Co(Ao),null,Ho.Default))}}]),t}();Wo.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;var Ko=new(function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.call(this,new Co(Ao),Wo.EMPTY_NODE,Ho.Default)}return e(u)(r,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return Wo.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),r}(Wo));Object.defineProperties(ko,{MIN:{value:new ko(pa,Wo.EMPTY_NODE)},MAX:{value:new ko(va,Ko)}}),wo.__EMPTY_NODE=Wo.EMPTY_NODE,Lo.__childrenNodeConstructor=Wo,To=Ko,function(e){Oo=e}(Ko);function Go(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===t)return Wo.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(n=t[".priority"]),ae(null===n||"string"==typeof n||"number"==typeof n||"object"==typeof n&&".sv"in n,"Invalid priority type found: "+(void 0===n?"undefined":e(Hi)(n))),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t){var r=t;return new Lo(r,Go(n))}if(t instanceof Array){var i=Wo.EMPTY_NODE;return wa(t,(function(e,n){if(Be(t,e)&&"."!==e.substring(0,1)){var r=Go(n);!r.isLeafNode()&&r.isEmpty()||(i=i.updateImmediateChild(e,r))}})),i.updatePriority(Go(n))}var a=[],o=!1,s=t;if(wa(s,(function(e,t){if("."!==e.substring(0,1)){var n=Go(t);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),a.push(new ko(e,n)))}})),0===a.length)return Wo.EMPTY_NODE;var u=qo(a,So,(function(e){return e.name}),Ao);if(o){var c=qo(a,Bo.getCompare());return new Wo(u,Go(n),new Ho({".priority":c},{".priority":Bo}))}return new Wo(u,Go(n),Ho.Default)}!function(e){No=e}(Go);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Qo=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).indexPath_=t,ae(!so(t)&&".priority"!==eo(t),"Can't create PathIndex with empty path or .priority key"),i}return e(u)(r,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?ya(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=Go(e),r=Wo.EMPTY_NODE.updateChild(this.indexPath_,n);return new ko(t,r)}},{key:"maxPost",value:function(){var e=Wo.EMPTY_NODE.updateChild(this.indexPath_,Ko);return new ko(va,e)}},{key:"toString",value:function(){return io(this.indexPath_,0).join("/")}}]),r}(_o),Yo=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(u)(r,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?ya(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return ko.MIN}},{key:"maxPost",value:function(){return ko.MAX}},{key:"makePost",value:function(e,t){var n=Go(e);return new ko(t,n)}},{key:"toString",value:function(){return".value"}}]),r}(_o),Jo=new Yo;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Xo(e){return{type:"value",snapshotNode:e}}function $o(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Zo(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function es(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ts=function(){"use strict";function t(){e(s)(this,t),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Bo}return e(u)(t,[{key:"hasStart",value:function(){return this.startSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return ae(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return ae(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:pa}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return ae(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return ae(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:va}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return ae(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===Bo}},{key:"copy",value:function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(e){var t,n={};if(e.isDefault())return n;if(e.index_===Bo?t="$priority":e.index_===Jo?t="$value":e.index_===bo?t="$key":(ae(e.index_ instanceof Qo,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=Me(t),e.startSet_){var r=e.startAfterSet_?"startAfter":"startAt";n[r]=Me(e.indexStartValue_),e.startNameSet_&&(n[r]+=","+Me(e.indexStartName_))}if(e.endSet_){var i=e.endBeforeSet_?"endBefore":"endAt";n[i]=Me(e.indexEndValue_),e.endNameSet_&&(n[i]+=","+Me(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_),n}function rs(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Bo&&(t.i=e.index_.toString()),t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var is=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a,o){var u;return e(s)(this,r),(u=n.call(this)).repoInfo_=t,u.onDataUpdate_=i,u.authTokenProvider_=a,u.appCheckTokenProvider_=o,u.log_=ca("p:rest:"),u.listens_={},u}return e(u)(r,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,n,i){var a=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var s=r.getListenId_(e,n),u={};this.listens_[s]=u;var c=ns(e._queryParams);this.restRequest_(o+".json",c,(function(e,t){var r=t;(404===e&&(r=null,e=null),null===e&&a.onDataUpdate_(o,r,!1,n),je(a.listens_,s)===u)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))}},{key:"unlisten",value:function(e,t){var n=r.getListenId_(e,t);delete this.listens_[n]}},{key:"get",value:function(e){var t=this,n=ns(e._queryParams),r=e._path.toString(),i=new we;return this.restRequest_(r+".json",n,(function(e,n){var a=n;404===e&&(a=null,e=null),null===e?(t.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))})),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=this;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(a){var o=e(k)(a,2),s=o[0],u=o[1],c=i;s&&s.accessToken&&(n.auth=s.accessToken),u&&u.token&&(n.ac=u.token);var l=(i.repoInfo_.secure?"https://":"http://")+i.repoInfo_.host+t+"?ns="+i.repoInfo_.namespace+We(n);i.log_("Sending REST request for "+l);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(r&&4===h.readyState){c.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);var e=null;if(h.status>=200&&h.status<300){try{e=Le(h.responseText)}catch(e){fa("Failed to parse JSON response for "+l+": "+h.responseText)}r(null,e)}else 401!==h.status&&404!==h.status&&fa("Got unsuccessful REST response for "+l+" Status: "+h.status),r(h.status);r=null}},h.open("GET",l,!0),h.send()}))}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(ae(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),r}(Ya),as=function(){"use strict";function t(){e(s)(this,t),this.rootNode_=Wo.EMPTY_NODE}return e(u)(t,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function os(){return{value:null,children:new Map}}function ss(e,t,n){if(so(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=eo(t);e.children.has(r)||e.children.set(r,os()),ss(e.children.get(r),t=no(t),n)}}function us(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,(function(e,r){us(r,new $a(t.toString()+"/"+e),n)}))}var cs,ls,hs=function(){"use strict";function t(n){e(s)(this,t),this.collection_=n,this.last_=null}return e(u)(t,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&wa(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t}}]),t}(),fs=function(){"use strict";function t(n,r){e(s)(this,t),this.server_=r,this.statsToReport_={},this.statsListener_=new hs(n);var i=1e4+2e4*Math.random();xa(this.reportStats_.bind(this),Math.floor(i))}return e(u)(t,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;wa(t,(function(t,i){i>0&&Be(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),xa(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ds(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(ls=cs||(cs={}))[ls.OVERWRITE=0]="OVERWRITE",ls[ls.MERGE=1]="MERGE",ls[ls.ACK_USER_WRITE=2]="ACK_USER_WRITE",ls[ls.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var ps,vs=function(){"use strict";function t(n,r,i){e(s)(this,t),this.path=n,this.affectedTree=r,this.revert=i,this.type=cs.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return e(u)(t,[{key:"operationForChild",value:function(e){if(so(this.path)){if(null!=this.affectedTree.value)return ae(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new $a(e));return new t(Za(),n,this.revert)}return ae(eo(this.path)===e,"operationForChild called for unrelated child."),new t(no(this.path),this.affectedTree,this.revert)}}]),t}(),ys=function(){"use strict";function t(n,r,i){e(s)(this,t),this.source=n,this.path=r,this.snap=i,this.type=cs.OVERWRITE}return e(u)(t,[{key:"operationForChild",value:function(e){return so(this.path)?new t(this.source,Za(),this.snap.getImmediateChild(e)):new t(this.source,no(this.path),this.snap)}}]),t}(),ms=function(){"use strict";function t(n,r,i){e(s)(this,t),this.source=n,this.path=r,this.children=i,this.type=cs.MERGE}return e(u)(t,[{key:"operationForChild",value:function(e){if(so(this.path)){var n=this.children.subtree(new $a(e));return n.isEmpty()?null:n.value?new ys(this.source,Za(),n.value):new t(this.source,Za(),n)}return ae(eo(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,no(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),t}(),gs=function(){"use strict";function t(n,r,i){e(s)(this,t),this.node_=n,this.fullyInitialized_=r,this.filtered_=i}return e(u)(t,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(so(e))return this.isFullyInitialized()&&!this.filtered_;var t=eo(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(e,t,n,r,i,a){var o=r.filter((function(e){return e.type===n}));o.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw oe("Should only compare child_ events.");var r=new ko(t.childName,t.snapshotNode),i=new ko(n.childName,n.snapshotNode);return e.index_.compare(r,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,n)})),o.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function _s(e,t){return{eventCache:e,serverCache:t}}function ws(e,t,n,r){return _s(new gs(t,n,r),e.serverCache)}function bs(e,t,n,r){return _s(e.eventCache,new gs(t,n,r))}function Es(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Is(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ts=function(){return ps||(ps=new Co(ma)),ps},xs=function(){"use strict";function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ts();e(s)(this,t),this.value=n,this.children=r}return e(u)(t,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:Za(),value:this.value};if(so(e))return null;var n=eo(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(no(e),t);return null!=i?{path:oo(new $a(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))}},{key:"subtree",value:function(e){if(so(e))return this;var n=eo(e),r=this.children.get(n);return null!==r?r.subtree(no(e)):new t(null)}},{key:"set",value:function(e,n){if(so(e))return new t(n,this.children);var r=eo(e),i=(this.children.get(r)||new t(null)).set(no(e),n),a=this.children.insert(r,i);return new t(this.value,a)}},{key:"remove",value:function(e){if(so(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=eo(e),r=this.children.get(n);if(r){var i,a=r.remove(no(e));return i=a.isEmpty()?this.children.remove(n):this.children.insert(n,a),null===this.value&&i.isEmpty()?new t(null):new t(this.value,i)}return this}},{key:"get",value:function(e){if(so(e))return this.value;var t=eo(e),n=this.children.get(t);return n?n.get(no(e)):null}},{key:"setTree",value:function(e,n){if(so(e))return n;var r,i=eo(e),a=(this.children.get(i)||new t(null)).setTree(no(e),n);return r=a.isEmpty()?this.children.remove(i):this.children.insert(i,a),new t(this.value,r)}},{key:"fold",value:function(e){return this.fold_(Za(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(oo(e,r),t)})),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,Za(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(so(e))return null;var i=eo(e),a=this.children.get(i);return a?a.findOnPath_(no(e),oo(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,Za(),t)}},{key:"foreachOnPath_",value:function(e,n,r){if(so(e))return this;this.value&&r(n,this.value);var i=eo(e),a=this.children.get(i);return a?a.foreachOnPath_(no(e),oo(n,i),r):new t(null)}},{key:"foreach",value:function(e){this.foreach_(Za(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(oo(e,n),t)})),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))}}],[{key:"fromObject",value:function(e){var n=new t(null);return wa(e,(function(e,t){n=n.set(new $a(e),t)})),n}}]),t}(),Cs=function(){"use strict";function t(n){e(s)(this,t),this.writeTree_=n}return e(u)(t,null,[{key:"empty",value:function(){return new t(new xs(null))}}]),t}();function Ss(e,t,n){if(so(t))return new Cs(new xs(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,a=r.value,o=uo(i,t);return a=a.updateChild(o,n),new Cs(e.writeTree_.set(i,a))}var s=new xs(n),u=e.writeTree_.setTree(t,s);return new Cs(u)}function As(e,t,n){var r=e;return wa(n,(function(e,n){r=Ss(r,oo(t,e),n)})),r}function Rs(e,t){if(so(t))return Cs.empty();var n=e.writeTree_.setTree(t,new xs(null));return new Cs(n)}function Ns(e,t){return null!=Os(e,t)}function Os(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(uo(n.path,t)):null}function Ps(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Bo,(function(e,n){t.push(new ko(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new ko(e,n.value))})),t}function Ds(e,t){if(so(t))return e;var n=Os(e,t);return new Cs(null!=n?new xs(n):e.writeTree_.subtree(t))}function Ls(e){return e.writeTree_.isEmpty()}function Ms(e,t){return Us(Za(),e.writeTree_,t)}function Us(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,i){".priority"===t?(ae(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Us(oo(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(oo(e,".priority"),r)),n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fs(e,t){return $s(t,e)}function Bs(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}function js(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));ae(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,o=e.allWrites.length-1;i&&o>=0;){var s=e.allWrites[o];s.visible&&(o>=n&&Vs(s,r.path)?i=!1:lo(r.path,s.path)&&(a=!0)),o--}if(i){if(a)return function(e){e.visibleWrites=zs(e.allWrites,qs,Za()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=Rs(e.visibleWrites,r.path):wa(r.children,(function(t){e.visibleWrites=Rs(e.visibleWrites,oo(r.path,t))}));return!0}return!1}function Vs(e,t){if(e.snap)return lo(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&lo(oo(e.path,n),t))return!0;return!1}function qs(e){return e.visible}function zs(e,t,n){for(var r=Cs.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,s=void 0;if(a.snap)lo(n,o)?r=Ss(r,s=uo(n,o),a.snap):lo(o,n)&&(s=uo(o,n),r=Ss(r,Za(),a.snap.getChild(s)));else{if(!a.children)throw oe("WriteRecord should have .snap or .children");if(lo(n,o))r=As(r,s=uo(n,o),a.children);else if(lo(o,n))if(so(s=uo(o,n)))r=As(r,Za(),a.children);else{var u=je(a.children,eo(s));if(u){var c=u.getChild(no(s));r=Ss(r,Za(),c)}}}}}return r}function Hs(e,t,n,r,i){if(r||i){var a=Ds(e.visibleWrites,t);if(!i&&Ls(a))return n;if(i||null!=n||Ns(a,Za())){return Ms(zs(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(lo(e.path,t)||lo(t,e.path))}),t),n||Wo.EMPTY_NODE)}return null}var o=Os(e.visibleWrites,t);if(null!=o)return o;var s=Ds(e.visibleWrites,t);return Ls(s)?n:null!=n||Ns(s,Za())?Ms(s,n||Wo.EMPTY_NODE):null}function Ws(e,t,n,r){return Hs(e.writeTree,e.treePath,t,n,r)}function Ks(e,t){return function(e,t,n){var r=Wo.EMPTY_NODE,i=Os(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Bo,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var a=Ds(e.visibleWrites,t);return n.forEachChild(Bo,(function(e,t){var n=Ms(Ds(a,new $a(e)),t);r=r.updateImmediateChild(e,n)})),Ps(a).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return Ps(Ds(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function Gs(e,t,n,r){return function(e,t,n,r,i){ae(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=oo(t,n);if(Ns(e.visibleWrites,a))return null;var o=Ds(e.visibleWrites,a);return Ls(o)?i.getChild(n):Ms(o,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function Qs(e,t){return function(e,t){return Os(e.visibleWrites,t)}(e.writeTree,oo(e.treePath,t))}function Ys(e,t,n,r,i,a){return function(e,t,n,r,i,a,o){var s,u=Ds(e.visibleWrites,t),c=Os(u,Za());if(null!=c)s=c;else{if(null==n)return[];s=Ms(u,n)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=o.getCompare(),f=a?s.getReverseIteratorFrom(r,o):s.getIteratorFrom(r,o),d=f.getNext();d&&l.length<i;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(e.writeTree,e.treePath,t,n,r,i,a)}function Js(e,t,n){return function(e,t,n,r){var i=oo(t,n),a=Os(e.visibleWrites,i);return null!=a?a:r.isCompleteForChild(n)?Ms(Ds(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function Xs(e,t){return $s(oo(e.treePath,t),e.writeTree)}function $s(e,t){return{treePath:e,writeTree:t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zs=function(){"use strict";function t(){e(s)(this,t),this.changeMap=new Map}return e(u)(t,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;ae("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),ae(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,es(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,Zo(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,$o(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw oe("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,es(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),t}(),eu=new(function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),t}()),tu=function(){"use strict";function t(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e(s)(this,t),this.writes_=n,this.viewCache_=r,this.optCompleteServerCache_=i}return e(u)(t,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new gs(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Js(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Is(this.viewCache_),i=Ys(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(e,t,n,r,i){var a,o,s=new Zs;if(n.type===cs.OVERWRITE){var u=n;u.source.fromUser?a=au(e,t,u.path,u.snap,r,i,s):(ae(u.source.fromServer,"Unknown source."),o=u.source.tagged||t.serverCache.isFiltered()&&!so(u.path),a=iu(e,t,u.path,u.snap,r,i,o,s))}else if(n.type===cs.MERGE){var c=n;c.source.fromUser?a=function(e,t,n,r,i,a,o){var s=t;return r.foreach((function(r,u){var c=oo(n,r);ou(t,eo(c))&&(s=au(e,s,c,u,i,a,o))})),r.foreach((function(r,u){var c=oo(n,r);ou(t,eo(c))||(s=au(e,s,c,u,i,a,o))})),s}(e,t,c.path,c.children,r,i,s):(ae(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=uu(e,t,c.path,c.children,r,i,o,s))}else if(n.type===cs.ACK_USER_WRITE){var l=n;a=l.revert?function(e,t,n,r,i,a){var o;if(null!=Qs(r,n))return t;var s,u=new tu(r,t,i),c=t.eventCache.getNode();if(so(n)||".priority"===eo(n)){var l;if(t.serverCache.isFullyInitialized())l=Ws(r,Is(t));else{var h=t.serverCache.getNode();ae(h instanceof Wo,"serverChildren would be complete if leaf node"),l=Ks(r,h)}s=e.filter.updateFullNode(c,l,a)}else{var f=eo(n),d=Js(r,f,t.serverCache);null==d&&t.serverCache.isCompleteForChild(f)&&(d=c.getImmediateChild(f)),(s=null!=d?e.filter.updateChild(c,f,d,no(n),u,a):t.eventCache.getNode().hasChild(f)?e.filter.updateChild(c,f,Wo.EMPTY_NODE,no(n),u,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&(o=Ws(r,Is(t))).isLeafNode()&&(s=e.filter.updateFullNode(s,o,a))}return o=t.serverCache.isFullyInitialized()||null!=Qs(r,Za()),ws(t,s,o,e.filter.filtersNodes())}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,l.path,r,i,s):function(e,t,n,r,i,a,o){if(null!=Qs(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(so(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return iu(e,t,n,u.getNode().getChild(n),i,a,s,o);if(so(n)){var c=new xs(null);return u.getNode().forEachChild(bo,(function(e,t){c=c.set(new $a(e),t)})),uu(e,t,n,c,i,a,s,o)}return t}var l=new xs(null);return r.foreach((function(e,t){var r=oo(n,e);u.isCompleteForPath(r)&&(l=l.set(e,u.getNode().getChild(r)))})),uu(e,t,n,l,i,a,s,o)}(e,t,l.path,l.affectedTree,r,i,s)}else{if(n.type!==cs.LISTEN_COMPLETE)throw oe("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var a=t.serverCache,o=bs(t,a.getNode(),a.isFullyInitialized()||so(n),a.isFiltered());return ru(e,o,n,r,eu,i)}(e,t,n.path,r,s)}var h=s.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=Es(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(Xo(Es(t)))}}(t,a,h),{viewCache:a,changes:h}}function ru(e,t,n,r,i,a){var o,s,u=t.eventCache;if(null!=Qs(r,n))return t;if(so(n))if(ae(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=Is(t),l=Ks(r,c instanceof Wo?c:Wo.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,a)}else{var h=Ws(r,Is(t));o=e.filter.updateFullNode(t.eventCache.getNode(),h,a)}else{var f=eo(n);if(".priority"===f){ae(1===to(n),"Can't have a priority with additional path components");var d=u.getNode(),p=Gs(r,n,d,s=t.serverCache.getNode());o=null!=p?e.filter.updatePriority(d,p):u.getNode()}else{var v,y=no(n);if(u.isCompleteForChild(f)){s=t.serverCache.getNode();var m=Gs(r,n,u.getNode(),s);v=null!=m?u.getNode().getImmediateChild(f).updateChild(y,m):u.getNode().getImmediateChild(f)}else v=Js(r,f,t.serverCache);o=null!=v?e.filter.updateChild(u.getNode(),f,v,y,i,a):u.getNode()}}return ws(t,o,u.isFullyInitialized()||so(n),e.filter.filtersNodes())}function iu(e,t,n,r,i,a,o,s){var u,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(so(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=eo(n);if(!c.isCompleteForPath(n)&&to(n)>1)return t;var d=no(n),p=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?l.updatePriority(c.getNode(),p):l.updateChild(c.getNode(),f,p,d,eu,null)}var v=bs(t,u,c.isFullyInitialized()||so(n),l.filtersNodes());return ru(e,v,n,i,new tu(i,v,a),s)}function au(e,t,n,r,i,a,o){var s,u,c=t.eventCache,l=new tu(i,t,a);if(so(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),s=ws(t,u,!0,e.filter.filtersNodes());else{var h=eo(n);if(".priority"===h)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=ws(t,u,c.isFullyInitialized(),c.isFiltered());else{var f,d=no(n),p=c.getNode().getImmediateChild(h);if(so(d))f=r;else{var v=l.getCompleteChild(h);f=null!=v?".priority"===ro(d)&&v.getChild(ao(d)).isEmpty()?v:v.updateChild(d,r):Wo.EMPTY_NODE}if(p.equals(f))s=t;else s=ws(t,e.filter.updateChild(c.getNode(),h,f,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return s}function ou(e,t){return e.eventCache.isCompleteForChild(t)}function su(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function uu(e,t,n,r,i,a,o,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,c=t;u=so(n)?r:new xs(null).setTree(n,r);var l=t.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var u=su(0,t.serverCache.getNode().getImmediateChild(n),r);c=iu(e,c,new $a(n),u,i,a,o,s)}})),u.children.inorderTraversal((function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!l.hasChild(n)&&!u){var h=su(0,t.serverCache.getNode().getImmediateChild(n),r);c=iu(e,c,new $a(n),h,i,a,o,s)}})),c}var cu;function lu(e,t){var n=Is(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!so(t)&&!n.getImmediateChild(eo(t)).isEmpty())?n.getChild(t):null}function hu(e,t,n,r){t.type===cs.MERGE&&null!==t.source.queryId&&(ae(Is(e.viewCache_),"We should always have a full cache before handling merges"),ae(Es(e.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,o=e.viewCache_,s=nu(e.processor_,o,t,n,r);return i=e.processor_,a=s.viewCache,ae(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),ae(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),ae(s.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,fu(e,s.changes,s.viewCache.eventCache.getNode(),null)}function fu(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var i=[],a=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),ks(e,i,"child_removed",t,r,n),ks(e,i,"child_added",t,r,n),ks(e,i,"child_moved",a,r,n),ks(e,i,"child_changed",t,r,n),ks(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var du;function pu(e,t,n,r){var i=t.source.queryId;if(null!==i){var a=e.views.get(i);return ae(null!=a,"SyncTree gave us an op for an invalid query."),hu(a,t,n,r)}var o=[],s=!0,u=!1,c=void 0;try{for(var l,h=e.views.values()[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;o=o.concat(hu(f,t,n,r))}}catch(e){u=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}return o}function vu(e,t){var n=null,r=!0,i=!1,a=void 0;try{for(var o,s=e.views.values()[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;n=n||lu(u,t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}var yu=function t(n){"use strict";e(s)(this,t),this.listenProvider_=n,this.syncPointTree_=new xs(null),this.pendingWriteTree_={visibleWrites:Cs.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function mu(e,t,n,r,i){return function(e,t,n,r,i){ae(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Ss(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?bu(e,new ys({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function gu(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Bs(e.pendingWriteTree_,t),i=js(e.pendingWriteTree_,t);if(i){var a=new xs(null);return null!=r.snap?a=a.set(Za(),!0):wa(r.children,(function(e){a=a.set(new $a(e),!0)})),bu(e,new vs(r.path,a,n))}return[]}function ku(e,t,n){return bu(e,new ys({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function _u(e,t,n,r){var i=Tu(e,r);if(null!=i){var a=xu(i),o=a.path,s=a.queryId,u=uo(o,t);return Cu(e,o,new ys(ds(s),u,n))}return[]}function wu(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(function(e,n){var r=vu(n,uo(e,t));if(r)return r}));return Hs(r,t,i,n,!0)}function bu(e,t){return Eu(t,e.syncPointTree_,null,Fs(e.pendingWriteTree_,Za()))}function Eu(e,t,n,r){if(so(e.path))return Iu(e,t,n,r);var i=t.get(Za());null==n&&null!=i&&(n=vu(i,Za()));var a=[],o=eo(e.path),s=e.operationForChild(o),u=t.children.get(o);if(u&&s){var c=n?n.getImmediateChild(o):null,l=Xs(r,o);a=a.concat(Eu(s,u,c,l))}return i&&(a=a.concat(pu(i,e,r,n))),a}function Iu(e,t,n,r){var i=t.get(Za());null==n&&null!=i&&(n=vu(i,Za()));var a=[];return t.children.inorderTraversal((function(t,i){var o=n?n.getImmediateChild(t):null,s=Xs(r,t),u=e.operationForChild(t);u&&(a=a.concat(Iu(u,i,o,s)))})),i&&(a=a.concat(pu(i,e,r,n))),a}function Tu(e,t){return e.tagToQueryMap.get(t)}function xu(e){var t=e.indexOf("$");return ae(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new $a(e.substr(0,t))}}function Cu(e,t,n){var r=e.syncPointTree_.get(t);return ae(r,"Missing sync point for query tag that we're tracking"),pu(r,n,Fs(e.pendingWriteTree_,t),null)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Su=function(){"use strict";function t(n){e(s)(this,t),this.node_=n}return e(u)(t,[{key:"getImmediateChild",value:function(e){return new t(this.node_.getImmediateChild(e))}},{key:"node",value:function(){return this.node_}}]),t}(),Au=function(){"use strict";function t(n,r){e(s)(this,t),this.syncTree_=n,this.path_=r}return e(u)(t,[{key:"getImmediateChild",value:function(e){var n=oo(this.path_,e);return new t(this.syncTree_,n)}},{key:"node",value:function(){return wu(this.syncTree_,this.path_)}}]),t}(),Ru=function(e,t,n){return e&&"object"==typeof e?(ae(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Nu(e[".sv"],t,n):"object"==typeof e[".sv"]?Ou(e[".sv"],t):void ae(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Nu=function(e,t,n){if("timestamp"===e)return n.timestamp;ae(!1,"Unexpected server value: "+e)},Ou=function(e,t,n){e.hasOwnProperty("increment")||ae(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&ae(!1,"Unexpected increment value: "+r);var i=t.node();if(ae(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!=typeof a?r:a+r},Pu=function(e,t,n,r){return Lu(t,new Au(n,e),r)},Du=function(e,t,n){return Lu(e,new Su(t),n)};function Lu(e,t,n){var r,i=e.getPriority().val(),a=Ru(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,s=Ru(o.getValue(),t,n);return s!==o.getValue()||a!==o.getPriority().val()?new Lo(s,Go(a)):e}var u=e;return r=u,a!==u.getPriority().val()&&(r=r.updatePriority(new Lo(a))),u.forEachChild(Bo,(function(e,i){var a=Lu(i,t.getImmediateChild(e),n);a!==i&&(r=r.updateImmediateChild(e,a))})),r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mu=function t(){"use strict";var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};e(s)(this,t),this.name=n,this.parent=r,this.node=i};function Uu(e,t){for(var n=t instanceof $a?t:new $a(t),r=e,i=eo(n);null!==i;){var a=je(r.node.children,i)||{children:{},childCount:0};r=new Mu(i,r,a),i=eo(n=no(n))}return r}function Fu(e){return e.node.value}function Bu(e,t){e.node.value=t,Hu(e)}function ju(e){return e.node.childCount>0}function Vu(e,t){wa(e.node.children,(function(n,r){t(new Mu(n,e,r))}))}function qu(e,t,n,r){n&&!r&&t(e),Vu(e,(function(e){qu(e,t,!0,r)})),n&&r&&t(e)}function zu(e){return new $a(null===e.parent?e.name:zu(e.parent)+"/"+e.name)}function Hu(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===Fu(e)&&!ju(e)}(n),i=Be(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Hu(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Hu(e))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e.parent,e.name,e)}var Wu=/[\[\].#$\/\u0000-\u001F\u007F]/,Ku=/[\[\].#$\u0000-\u001F\u007F]/,Gu=10485760,Qu=function(e){return"string"==typeof e&&0!==e.length&&!Wu.test(e)},Yu=function(e){return"string"==typeof e&&0!==e.length&&!Ku.test(e)},Ju=function(e,t,n){var r=n instanceof $a?new ho(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+po(r));if("function"==typeof t)throw new Error(e+"contains a function "+po(r)+" with contents = "+t.toString());if(da(t))throw new Error(e+"contains "+t.toString()+" "+po(r));if("string"==typeof t&&t.length>3495253.3333333335&&Ze(t)>Gu)throw new Error(e+"contains a string greater than "+"10485760 utf8 bytes "+po(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,a=!1;if(wa(t,(function(t,n){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(a=!0,!Qu(t)))throw new Error(e+" contains an invalid key ("+t+") "+po(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var o,s;s=t,(o=r).parts_.length>0&&(o.byteLength_+=1),o.parts_.push(s),o.byteLength_+=Ze(s),fo(o),Ju(e,n,r),function(e){var t=e.parts_.pop();e.byteLength_-=Ze(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),i&&a)throw new Error(e+' contains ".value" child '+po(r)+" in addition to actual children.")}},Xu=function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Qu(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Yu(e)}(n))throw new Error(Xe(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},$u=function t(){"use strict";e(s)(this,t),this.eventLists_=[],this.recursionDepth_=0};function Zu(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],a=i.getPath();null===n||co(a,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(i)}n&&e.eventLists_.push(n)}function ec(e,t,n){Zu(e,n),tc(e,(function(e){return lo(e,t)||lo(t,e)}))}function tc(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i)t(i.path)?(nc(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function nc(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();aa&&ua("event: "+n.toString()),Ta(r)}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rc="repo_interrupt",ic=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.repoInfo_=n,this.forceRestClient_=r,this.authTokenProvider_=i,this.appCheckProvider_=a,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new $u,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=os(),this.transactionQueueTree_=new Mu,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return e(u)(t,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),t}();function ac(e,t,n){if(e.stats_=Ba(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new is(e.repoInfo_,(function(t,n,r,i){uc(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return cc(e,!0)}),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Me(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new mo(e.repoInfo_,t,(function(t,n,r,i){uc(e,t,n,r,i)}),(function(t){cc(e,t)}),(function(t){!function(e,t){wa(t,(function(t,n){lc(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}var r,i,a;e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=(r=e.repoInfo_,i=function(){return new fs(e.stats_,e.server_)},a=r.toString(),Fa[a]||(Fa[a]=i()),Fa[a]),e.infoData_=new as,e.infoSyncTree_=new yu({startListening:function(t,n,r,i){var a=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(a=ku(e.infoSyncTree_,t._path,o),setTimeout((function(){i("ok")}),0)),a},stopListening:function(){}}),lc(e,"connected",!1),e.serverSyncTree_=new yu({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var a=i(n,r);ec(e.eventQueue_,t._path,a)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function oc(e){var t=e.infoData_.getNode(new $a(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function sc(e){return(t=(t={timestamp:oc(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function uc(e,t,n,r,i){e.dataUpdateCount++;var a=new $a(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(i)if(r){var s=qe(n,(function(e){return Go(e)}));o=function(e,t,n,r){var i=Tu(e,r);if(i){var a=xu(i),o=a.path,s=a.queryId,u=uo(o,t),c=xs.fromObject(n);return Cu(e,o,new ms(ds(s),u,c))}return[]}(e.serverSyncTree_,a,s,i)}else{var u=Go(n);o=_u(e.serverSyncTree_,a,u,i)}else if(r){var c=qe(n,(function(e){return Go(e)}));o=function(e,t,n){var r=xs.fromObject(n);return bu(e,new ms({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,c)}else{var l=Go(n);o=ku(e.serverSyncTree_,a,l)}var h=a;o.length>0&&(h=mc(e,a)),ec(e.eventQueue_,h,o)}function cc(e,t){lc(e,"connected",t),!1===t&&function(e){dc(e,"onDisconnectEvents");var t=sc(e),n=os();us(e.onDisconnect_,Za(),(function(r,i){var a=Pu(r,i,e.serverSyncTree_,t);ss(n,r,a)}));var r=[];us(n,Za(),(function(t,n){r=r.concat(ku(e.serverSyncTree_,t,n));var i=bc(e,t);mc(e,i)})),e.onDisconnect_=os(),ec(e.eventQueue_,Za(),r)}(e)}function lc(e,t,n){var r=new $a("/.info/"+t),i=Go(n);e.infoData_.updateSnapshot(r,i);var a=ku(e.infoSyncTree_,r,i);ec(e.eventQueue_,r,a)}function hc(e){return e.nextWriteId_++}function fc(e){e.persistentConnection_&&e.persistentConnection_.interrupt(rc)}function dc(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a="";t.persistentConnection_&&(a=t.persistentConnection_.id+":"),ua.apply(void 0,[a].concat(e(h)(r)))}function pc(e,t,n){return wu(e.serverSyncTree_,t,n)||Wo.EMPTY_NODE}function vc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||wc(e,t),Fu(t)){var n=kc(e,t);ae(n.length>0,"Sending zero length transaction queue");var r=n.every((function(e){return 0===e.status}));r&&yc(e,zu(t),n)}else ju(t)&&Vu(t,(function(t){vc(e,t)}))}function yc(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=pc(e,t,r),a=i,o=i.hash(),s=0;s<n.length;s++){var u=n[s];ae(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=uo(t,u.path);a=a.updateChild(c,u.currentOutputSnapshotRaw)}var l=a.val(!0),h=t;e.server_.put(h.toString(),l,(function(r){dc(e,"transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var a=function(t){n[t].status=2,i=i.concat(gu(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&o.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},o=[],s=0;s<n.length;s++)a(s);wc(e,Uu(e.transactionQueueTree_,t)),vc(e,e.transactionQueueTree_),ec(e.eventQueue_,t,i);for(var u=0;u<o.length;u++)Ta(o[u])}else{if("datastale"===r)for(var c=0;c<n.length;c++)3===n[c].status?n[c].status=4:n[c].status=0;else{fa("transaction at "+h.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}mc(e,t)}}),o)}function mc(e,t){var n=gc(e,t),r=zu(n);return function(e,t,n){var r=function(r){var s,u=t[r],c=uo(n,u.path),l=!1,h=void 0;if(ae(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)l=!0,h=u.abortReason,a=a.concat(gu(e.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=25)l=!0,h="maxretry",a=a.concat(gu(e.serverSyncTree_,u.currentWriteId,!0));else{var f=pc(e,u.path,o);u.currentInputSnapshot=f;var d=t[r].update(f.val());if(void 0!==d){Ju("transaction failed: Data returned ",d,u.path);var p=Go(d);"object"==typeof d&&null!=d&&Be(d,".priority")||(p=p.updatePriority(f.getPriority()));var v=u.currentWriteId,y=sc(e),m=Du(p,f,y);u.currentOutputSnapshotRaw=p,u.currentOutputSnapshotResolved=m,u.currentWriteId=hc(e),o.splice(o.indexOf(v),1),a=(a=a.concat(mu(e.serverSyncTree_,u.path,m,u.currentWriteId,u.applyLocally))).concat(gu(e.serverSyncTree_,v,!0))}else l=!0,h="nodata",a=a.concat(gu(e.serverSyncTree_,u.currentWriteId,!0))}ec(e.eventQueue_,n,a),a=[],l&&(t[r].status=2,s=t[r].unwatcher,setTimeout(s,Math.floor(0)),t[r].onComplete&&("nodata"===h?i.push((function(){return t[r].onComplete(null,!1,t[r].currentInputSnapshot)})):i.push((function(){return t[r].onComplete(new Error(h),!1,null)}))))};if(0===t.length)return;for(var i=[],a=[],o=t.filter((function(e){return 0===e.status})).map((function(e){return e.currentWriteId})),s=0;s<t.length;s++)r(s);wc(e,e.transactionQueueTree_);for(var u=0;u<i.length;u++)Ta(i[u]);vc(e,e.transactionQueueTree_)}(e,kc(e,n),r),r}function gc(e,t){var n,r=e.transactionQueueTree_;for(n=eo(t);null!==n&&void 0===Fu(r);)r=Uu(r,n),n=eo(t=no(t));return r}function kc(e,t){var n=[];return _c(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function _c(e,t,n){var r=Fu(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Vu(t,(function(t){_c(e,t,n)}))}function wc(e,t){var n=Fu(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,Bu(t,n.length>0?n:void 0)}Vu(t,(function(t){wc(e,t)}))}function bc(e,t){var n=zu(gc(e,t)),r=Uu(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){Ec(e,t)})),Ec(e,r),qu(r,(function(t){Ec(e,t)})),n}function Ec(e,t){var n=Fu(t);if(n){for(var r=[],i=[],a=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?(ae(a===o-1,"All SENT items should be at beginning of queue."),a=o,n[o].status=3,n[o].abortReason="set"):(ae(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(gu(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===a?Bu(t,void 0):n.length=a+1,ec(e.eventQueue_,zu(t),i);for(var s=0;s<r.length;s++)Ta(r[s])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ic,Tc,xc=function(e,t){var n=Cc(e),r=n.namespace;"firebase.com"===n.domain&&ha(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||ha("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&fa("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Da(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new $a(n.pathString)}},Cc=function(e){var t="",n="",r="",i="",a="",o=!0,s="https",u=443;if("string"==typeof e){var c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(l,h)));var f=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n=!0,r=!1,i=void 0;try{for(var a,o=e.split("&")[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(0!==s.length){var u=s.split("=");2===u.length?t[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):fa("Invalid query segment '".concat(s,"' in query '").concat(e,"'"))}}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}(e.substring(Math.min(e.length,h)));(c=t.indexOf(":"))>=0?(o="https"===s||"wss"===s,u=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var p=t.indexOf(".");r=t.substring(0,p).toLowerCase(),n=t.substring(p+1),a=r}"ns"in f&&(a=f.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:o,scheme:s,pathString:i,namespace:a}},Sc="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Ac=(Ic=0,Tc=[],function(){"use strict";function t(n,r,i,a){e(s)(this,t),this._repo=n,this._path=r,this._queryParams=i,this._orderByCalled=a}return e(u)(t,[{key:"key",get:function(){return so(this._path)?null:ro(this._path)}},{key:"ref",get:function(){return new Rc(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=rs(this._queryParams),t=ka(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return rs(this._queryParams)}},{key:"isEqual",value:function(e){if(!((e=nt(e))instanceof t))return!1;var n=this._repo===e._repo,r=co(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),t}());var Rc=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){return e(s)(this,r),n.call(this,t,i,new ts,!1)}return e(u)(r,[{key:"parent",get:function(){var e=ao(this._path);return null===e?null:new r(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),r}(Ac);!function(e){ae(!cu,"__referenceConstructor has already been defined"),cu=e}(Rc),function(e){ae(!du,"__referenceConstructor has already been defined"),du=e}(Rc);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Nc={},Oc=!1;function Pc(e,t,n,r,i){var a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||ha("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ua("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,s=xc(a,i),u=s.repoInfo,c=void 0;void 0!==V&&V.env&&(c=V.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(o=!0,a="http://".concat(c,"?ns=").concat(u.namespace),u=(s=xc(a,i)).repoInfo):o=!s.repoInfo.secure;var l=i&&o?new Aa(Aa.OWNER):new Sa(e.name,e.options,t);Xu("Invalid Firebase Database URL",s),so(s.path)||ha("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=Nc[t.name];i||(i={},Nc[t.name]=i);var a=i[e.toURLString()];a&&ha("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return a=new ic(e,Oc,n,r),i[e.toURLString()]=a,a}(u,e,l,new Ca(e.name,n));return new Dc(h,e)}var Dc=function(){"use strict";function t(n,r){e(s)(this,t),this._repoInternal=n,this.app=r,this.type="database",this._instanceStarted=!1}return e(u)(t,[{key:"_repo",get:function(){return this._instanceStarted||(ac(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new Rc(this._repo,Za())),this._rootInternal}},{key:"_delete",value:function(){var e,t,n;return null!==this._rootInternal&&(e=this._repo,t=this.app.name,(n=Nc[t])&&n[e.key]===e||ha("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),fc(e),delete n[e.key],this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&ha("Cannot call "+e+" on a deleted database.")}}]),t}();mo.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},mo.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){Qi(Xt),Kt(new rt("database",(function(e,t){var n=t.instanceIdentifier;return Pc(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),en(Wi,Ki,e),en(Wi,Ki,"esm2017")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */();var Lc=i("ge8co"),Mc={};Object.defineProperty(Mc,"__esModule",{value:!0}),Mc.default=function(e,t,n){return Fc(e,t,n)};var Uc=function(e){return e&&e.__esModule?e:{default:e}}(i("2mz0K"));function Fc(e,t,n){return(Fc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Uc.default(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}})(e,t,n)}var Bc,jc=i("fVNic"),Vc=i("jmhxu"),qc=(Hi=i("l5bVx"),jc=i("fVNic"),Hi=i("l5bVx"),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}),zc={},Hc=Hc||{},Wc=qc||self;function Kc(t){var n=void 0===t?"undefined":e(Hi)(t);return"array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length}function Gc(t){var n=void 0===t?"undefined":e(Hi)(t);return"object"==n&&null!=t||"function"==n}var Qc="closure_uid_"+(1e9*Math.random()>>>0),Yc=0;function Jc(e,t,n){return e.call.apply(e.bind,arguments)}function Xc(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function $c(e,t,n){return($c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Jc:Xc).apply(null,arguments)}function Zc(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function el(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function tl(){this.s=this.s,this.o=this.o}tl.prototype.s=!1,tl.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Qc)&&e[Qc]||(e[Qc]=++Yc))},tl.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var nl=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function rl(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function il(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(Kc(r)){var i=e.length||0,a=r.length||0;e.length=i+a;for(var o=0;o<a;o++)e[i+o]=r[o]}else e.push(r)}}function al(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}al.prototype.h=function(){this.defaultPrevented=!0};var ol=function(){if(!Wc.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Wc.addEventListener("test",(function(){}),t),Wc.removeEventListener("test",(function(){}),t)}catch(e){}return e}();function sl(e){return/^[\s\xa0]*$/.test(e)}function ul(){var e=Wc.navigator;return e&&(e=e.userAgent)?e:""}function cl(e){return-1!=ul().indexOf(e)}function ll(e){return ll[" "](e),e}ll[" "]=function(){};var hl,fl,dl,pl=cl("Opera"),vl=cl("Trident")||cl("MSIE"),yl=cl("Edge"),ml=yl||vl,gl=cl("Gecko")&&!(-1!=ul().toLowerCase().indexOf("webkit")&&!cl("Edge"))&&!(cl("Trident")||cl("MSIE"))&&!cl("Edge"),kl=-1!=ul().toLowerCase().indexOf("webkit")&&!cl("Edge");function _l(){var e=Wc.document;return e?e.documentMode:void 0}e:{var wl="",bl=(fl=ul(),gl?/rv:([^\);]+)(\)|;)/.exec(fl):yl?/Edge\/([\d\.]+)/.exec(fl):vl?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(fl):kl?/WebKit\/(\S+)/.exec(fl):pl?/(?:Version)[ \/]?(\S+)/.exec(fl):void 0);if(bl&&(wl=bl?bl[1]:""),vl){var El=_l();if(null!=El&&El>parseFloat(wl)){hl=String(El);break e}}hl=wl}if(Wc.document&&vl){var Il=_l();dl=Il||(parseInt(hl,10)||void 0)}else dl=void 0;var Tl=dl;function xl(e,t){if(al.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(gl){e:{try{ll(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Cl[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&xl.$.h.call(this)}}el(xl,al);var Cl={2:"touch",3:"pen",4:"mouse"};xl.prototype.h=function(){xl.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Sl="closure_listenable_"+(1e6*Math.random()|0),Al=0;function Rl(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++Al,this.fa=this.ia=!1}function Nl(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Ol(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Pl(e){var t={};for(var n in e)t[n]=e[n];return t}var Dl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ll(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<Dl.length;a++)n=Dl[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Ml(e){this.src=e,this.g={},this.h=0}function Ul(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=nl(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(Nl(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Fl(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.fa&&a.listener==t&&a.capture==!!n&&a.la==r)return i}return-1}Ml.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=Fl(e,t,r,i);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new Rl(t,this.src,a,!!r,i)).ia=n,e.push(t)),t};var Bl="closure_lm_"+(1e6*Math.random()|0),jl={};function Vl(e,t,n,r,i){if(r&&r.once)return zl(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)Vl(e,t[a],n,r,i);return null}return n=Jl(n),e&&e[Sl]?e.O(t,n,Gc(r)?!!r.capture:!!r,i):ql(e,t,n,!1,r,i)}function ql(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=Gc(i)?!!i.capture:!!i,s=Ql(e);if(s||(e[Bl]=s=new Ml(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Gl;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)ol||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Kl(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function zl(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)zl(e,t[a],n,r,i);return null}return n=Jl(n),e&&e[Sl]?e.P(t,n,Gc(r)?!!r.capture:!!r,i):ql(e,t,n,!0,r,i)}function Hl(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Hl(e,t[a],n,r,i);else r=Gc(r)?!!r.capture:!!r,n=Jl(n),e&&e[Sl]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Fl(a=e.g[t],n,r,i))&&(Nl(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=Ql(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Fl(t,n,r,i)),(n=-1<e?t[e]:null)&&Wl(n))}function Wl(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[Sl])Ul(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Kl(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ql(t))?(Ul(n,e),0==n.h&&(n.src=null,t[Bl]=null)):Nl(e)}}}function Kl(e){return e in jl?jl[e]:jl[e]="on"+e}function Gl(e,t){if(e.fa)e=!0;else{t=new xl(t,this);var n=e.listener,r=e.la||e.src;e.ia&&Wl(e),e=n.call(r,t)}return e}function Ql(e){return(e=e[Bl])instanceof Ml?e:null}var Yl="__closure_events_fn_"+(1e9*Math.random()>>>0);function Jl(e){return"function"==typeof e?e:(e[Yl]||(e[Yl]=function(t){return e.handleEvent(t)}),e[Yl])}function Xl(){tl.call(this),this.i=new Ml(this),this.S=this,this.J=null}function $l(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"==typeof t)t=new al(t,e);else if(t instanceof al)t.target=t.target||e;else{var i=t;Ll(t=new al(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=Zl(o,r,!0,t)&&i}if(i=Zl(o=t.g=e,r,!0,t)&&i,i=Zl(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=Zl(o=t.g=n[a],r,!1,t)&&i}function Zl(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.fa&&o.capture==n){var s=o.listener,u=o.la||o.src;o.ia&&Ul(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}el(Xl,tl),Xl.prototype[Sl]=!0,Xl.prototype.removeEventListener=function(e,t,n,r){Hl(this,e,t,n,r)},Xl.prototype.N=function(){if(Xl.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Nl(n[r]);delete t.g[e],t.h--}}this.J=null},Xl.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Xl.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var eh=Wc.JSON.stringify,th=function(){"use strict";function t(n,r){e(s)(this,t),this.i=n,this.j=r,this.h=0,this.g=null}return e(u)(t,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),t}();function nh(){var e=lh,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var rh=function(){"use strict";function t(){e(s)(this,t),this.h=this.g=null}return e(u)(t,[{key:"add",value:function(e,t){var n=ih.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),t}(),ih=new th((function(){return new ah}),(function(e){return e.reset()})),ah=function(){"use strict";function t(){e(s)(this,t),this.next=this.g=this.h=null}return e(u)(t,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),t}();function oh(e){var t=1;e=e.split(":");for(var n=[];0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function sh(e){Wc.setTimeout((function(){throw e}),0)}var uh,ch=!1,lh=new rh,hh=function(){var e=Wc.Promise.resolve(void 0);uh=function(){e.then(fh)}},fh=function(){for(var e;e=nh();){try{e.h.call(e.g)}catch(e){sh(e)}var t=ih;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}ch=!1};function dh(e,t){Xl.call(this),this.h=e||1,this.g=t||Wc,this.j=$c(this.qb,this),this.l=Date.now()}function ph(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function vh(e,t,n){if("function"==typeof e)n&&(e=$c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=$c(e.handleEvent,e)}return 2147483647<Number(t)?-1:Wc.setTimeout(e,t||0)}function yh(e){e.g=vh((function(){e.g=null,e.i&&(e.i=!1,yh(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}el(dh,Xl),(Bc=dh.prototype).ga=!1,Bc.T=null,Bc.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),$l(this,"tick"),this.ga&&(ph(this),this.start()))}},Bc.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Bc.N=function(){dh.$.N.call(this),ph(this),delete this.g};var mh=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).m=t,a.j=i,a.h=null,a.i=!1,a.g=null,a}return e(u)(r,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:yh(this)}},{key:"N",value:function(){e(Mc)(e(jc)(r.prototype),"N",this).call(this),this.g&&(Wc.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),r}(tl);function gh(e){tl.call(this),this.h=e,this.g={}}el(gh,tl);var kh=[];function _h(e,t,n,r){Array.isArray(n)||(n&&(kh[0]=n.toString()),n=kh);for(var i=0;i<n.length;i++){var a=Vl(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function wh(e){Ol(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Wl(e)}),e),e.g={}}function bh(){this.g=!0}function Eh(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return eh(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}gh.prototype.N=function(){gh.$.N.call(this),wh(this)},gh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},bh.prototype.Ea=function(){this.g=!1},bh.prototype.info=function(){};var Ih={},Th=null;function xh(){return Th=Th||new Xl}function Ch(e){al.call(this,Ih.Ta,e)}function Sh(e){var t=xh();$l(t,new Ch(t))}function Ah(e,t){al.call(this,Ih.STAT_EVENT,e),this.stat=t}function Rh(e){var t=xh();$l(t,new Ah(t,e))}function Nh(e,t){al.call(this,Ih.Ua,e),this.size=t}function Oh(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Wc.setTimeout((function(){e()}),t)}Ih.Ta="serverreachability",el(Ch,al),Ih.STAT_EVENT="statevent",el(Ah,al),Ih.Ua="timingevent",el(Nh,al);var Ph={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Dh={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Lh(){}function Mh(e){return e.h||(e.h=e.i())}function Uh(){}Lh.prototype.h=null;var Fh,Bh={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function jh(){al.call(this,"d")}function Vh(){al.call(this,"c")}function qh(){}function zh(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new gh(this),this.P=Wh,e=ml?125:void 0,this.V=new dh(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Hh}function Hh(){this.i=null,this.g="",this.h=!1}el(jh,al),el(Vh,al),el(qh,Lh),qh.prototype.g=function(){return new XMLHttpRequest},qh.prototype.i=function(){return{}},Fh=new qh;var Wh=45e3,Kh={},Gh={};function Qh(e,t,n){e.L=1,e.v=pf(cf(t)),e.s=n,e.S=!0,Yh(e,null)}function Yh(e,t){e.G=Date.now(),Zh(e),e.A=cf(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),Cf(n.i,"t",r),e.C=0,n=e.l.J,e.h=new Hh,e.g=Cd(e.l,n?t:null,!e.s),0<e.O&&(e.M=new mh($c(e.Pa,e,e.g),e.O)),_h(e.U,e.g,"readystatechange",e.nb),t=e.I?Pl(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Sh(),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function Jh(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function Xh(e,t,n){for(var r,i=!0;!e.J&&e.C<n.length;){if((r=$h(e,n))==Gh){4==t&&(e.o=4,Rh(14),i=!1),Eh(e.j,e.m,null,"[Incomplete Response]");break}if(r==Kh){e.o=4,Rh(15),Eh(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Eh(e.j,e.m,r,null),af(e,r)}Jh(e)&&r!=Gh&&r!=Kh&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Rh(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),kd(t),t.M=!0,Rh(11))):(Eh(e.j,e.m,n,"[Invalid Chunked Response]"),rf(e),nf(e))}function $h(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Gh:(n=Number(t.substring(n,r)),isNaN(n)?Kh:(r+=1)+n>t.length?Gh:(t=t.slice(r,r+n),e.C=r+n,t))}function Zh(e){e.Y=Date.now()+e.P,ef(e,e.P)}function ef(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Oh($c(e.lb,e),t)}function tf(e){e.B&&(Wc.clearTimeout(e.B),e.B=null)}function nf(e){0==e.l.H||e.J||bd(e.l,e)}function rf(e){tf(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,ph(e.V),wh(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function af(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||Df(n.i,e)))if(!e.K&&Df(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;wd(n),hd(n)}gd(n),Rh(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=Oh($c(n.ib,n),6e3));if(1>=Pf(n.i)&&n.oa){try{n.oa()}catch(a){}n.oa=void 0}}else Id(n,11)}else if((e.K||n.g==e)&&wd(n),!sl(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.V=a[0],a=a[1],2==n.H)if("c"==a[0]){n.K=a[1],n.pa=a[2];var o=a[3];null!=o&&(n.ra=o,n.l.info("VER="+n.ra));var s=a[4];null!=s&&(n.Ga=s,n.l.info("SVER="+n.Ga));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(Lf(h,h.h),h.h=null))}if(r.F){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.Da=f,df(r.I,r.F,f))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var d=e;if((r=n).wa=xd(r,r.J?r.pa:null,r.Y),d.K){Mf(r.i,d);var p=d,v=r.L;v&&p.setTimeout(v),p.B&&(tf(p),Zh(p)),r.g=d}else md(r);0<n.j.length&&dd(n)}else"stop"!=a[0]&&"close"!=a[0]||Id(n,7);else 3==n.H&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?Id(n,7):ld(n):"noop"!=a[0]&&n.h&&n.h.Aa(a),n.A=0)}Sh()}catch(a){}}function of(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Kc(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(Kc(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(Kc(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}(Bc=zh.prototype).setTimeout=function(e){this.P=e},Bc.nb=function(e){e=e.target;var t=this.M;t&&3==id(e)?t.l():this.Pa(e)},Bc.Pa=function(e){try{if(e==this.g)e:{var t=id(this.g),n=this.g.Ia();this.g.da();if(!(3>t)&&(3!=t||ml||this.g&&(this.h.h||this.g.ja()||ad(this.g)))){this.J||4!=t||7==n||Sh(),tf(this);var r=this.g.da();this.ca=r;t:if(Jh(this)){var i=ad(this.g);e="";var a=i.length,o=4==id(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){rf(this),nf(this);var s="";break t}this.h.i=new Wc.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,e+=this.h.i.decode(i[n],{stream:o&&n==a-1});i.splice(0,a),this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.ja();if(this.i=200==r,function(e,t,n,r,i,a,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.W,t,r),this.i){if(this.aa&&!this.K){t:{if(this.g){var u,c=this.g;if((u=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!sl(u)){var l=u;break t}}l=null}if(!(r=l)){this.i=!1,this.o=3,Rh(12),rf(this),nf(this);break e}Eh(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,af(this,r)}this.S?(Xh(this,t,s),ml&&this.i&&3==t&&(_h(this.U,this.V,"tick",this.mb),this.V.start())):(Eh(this.j,this.m,s,null),af(this,s)),4==t&&rf(this),this.i&&!this.J&&(4==t?bd(this.l,this):(this.i=!1,Zh(this)))}else(function(e){var t={};e=(e.g&&2<=id(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(var n=0;n<e.length;n++)if(!sl(e[n])){var r=oh(e[n]),i=r[0];if("string"==typeof(r=r[1])){r=r.trim();var a=t[i]||[];t[i]=a,a.push(r)}}!function(e,t){for(var n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==r&&0<s.indexOf("Unknown SID")?(this.o=3,Rh(12)):(this.o=0,Rh(13)),rf(this),nf(this)}}}catch(t){}},Bc.mb=function(){if(this.g){var e=id(this.g),t=this.g.ja();this.C<t.length&&(tf(this),Xh(this,e,t),this.i&&4!=e&&Zh(this))}},Bc.cancel=function(){this.J=!0,rf(this)},Bc.lb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(Sh(),Rh(17)),rf(this),this.o=2,nf(this)):ef(this,this.Y-e)};var sf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uf(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof uf){this.h=e.h,lf(this,e.j),this.s=e.s,this.g=e.g,hf(this,e.m),this.l=e.l;var t=e.i,n=new Ef;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ff(this,n),this.o=e.o}else e&&(t=String(e).match(sf))?(this.h=!1,lf(this,t[1]||"",!0),this.s=vf(t[2]||""),this.g=vf(t[3]||"",!0),hf(this,t[4]),this.l=vf(t[5]||"",!0),ff(this,t[6]||"",!0),this.o=vf(t[7]||"")):(this.h=!1,this.i=new Ef(null,this.h))}function cf(e){return new uf(e)}function lf(e,t,n){e.j=n?vf(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function hf(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function ff(e,t,n){t instanceof Ef?(e.i=t,function(e,t){t&&!e.j&&(If(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Tf(this,t),Cf(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=yf(t,wf)),e.i=new Ef(t,e.h))}function df(e,t,n){e.i.set(t,n)}function pf(e){return df(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function vf(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function yf(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,mf),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function mf(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}uf.prototype.toString=function(){var e=[],t=this.j;t&&e.push(yf(t,gf,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(yf(t,gf,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(yf(n,"/"==n.charAt(0)?_f:kf,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",yf(n,bf)),e.join("")};var gf=/[#\/\?@]/g,kf=/[#\?:]/g,_f=/[#\?]/g,wf=/[#\?@]/g,bf=/#/g;function Ef(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function If(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Tf(e,t){If(e),t=Sf(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function xf(e,t){return If(e),t=Sf(e,t),e.g.has(t)}function Cf(e,t,n){Tf(e,t),0<n.length&&(e.i=null,e.g.set(Sf(e,t),rl(n)),e.h+=n.length)}function Sf(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(Bc=Ef.prototype).add=function(e,t){If(this),this.i=null,e=Sf(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Bc.forEach=function(e,t){If(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},Bc.ta=function(){If(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},Bc.Z=function(e){If(this);var t=[];if("string"==typeof e)xf(this,e)&&(t=t.concat(this.g.get(Sf(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},Bc.set=function(e,t){return If(this),this.i=null,xf(this,e=Sf(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Bc.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},Bc.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var o=i;""!==a[r]&&(o+="="+encodeURIComponent(String(a[r]))),e.push(o)}}return this.i=e.join("&")};var Af=function t(n,r){"use strict";e(s)(this,t),this.g=n,this.map=r};function Rf(e){this.l=e||Nf,Wc.PerformanceNavigationTiming?e=0<(e=Wc.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(Wc.g&&Wc.g.Ka&&Wc.g.Ka()&&Wc.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Nf=10;function Of(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Pf(e){return e.h?1:e.g?e.g.size:0}function Df(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Lf(e,t){e.g?e.g.add(t):e.h=t}function Mf(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Uf(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){var t=e.i,n=!0,r=!1,i=void 0;try{for(var a,o=e.g.values()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;t=t.concat(s.F)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}return rl(e.i)}Rf.prototype.cancel=function(){if(this.i=Uf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e=!0,t=!1,n=void 0;try{for(var r,i=this.g.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.cancel()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.g.clear()}};var Ff=function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,[{key:"stringify",value:function(e){return Wc.JSON.stringify(e,void 0)}},{key:"parse",value:function(e){return Wc.JSON.parse(e,void 0)}}]),t}();function Bf(){this.g=new Ff}function jf(e,t,n){var r=n||"";try{of(e,(function(e,n){var i=e;Gc(e)&&(i=eh(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function Vf(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function qf(e){this.l=e.ec||null,this.j=e.ob||!1}function zf(e,t){Xl.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Hf,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}el(qf,Lh),qf.prototype.g=function(){return new zf(this.l,this.j)},qf.prototype.i=function(e){return function(){return e}}({}),el(zf,Xl);var Hf=0;function Wf(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function Kf(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Gf(e)}function Gf(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Bc=zf.prototype).open=function(e,t){if(this.readyState!=Hf)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Gf(this)},Bc.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||Wc).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},Bc.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Kf(this)),this.readyState=Hf},Bc.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Gf(this)),this.g&&(this.readyState=3,Gf(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Wc.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Wf(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},Bc.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Kf(this):Gf(this),3==this.readyState&&Wf(this)}},Bc.Za=function(e){this.g&&(this.response=this.responseText=e,Kf(this))},Bc.Ya=function(e){this.g&&(this.response=e,Kf(this))},Bc.ka=function(){this.g&&Kf(this)},Bc.setRequestHeader=function(e,t){this.v.append(e,t)},Bc.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Bc.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(zf.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Qf=Wc.JSON.parse;function Yf(e){Xl.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Jf,this.L=this.M=!1}el(Yf,Xl);var Jf="",Xf=/^https?$/i,$f=["POST","PUT"];function Zf(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,ed(e),nd(e)}function ed(e){e.F||(e.F=!0,$l(e,"complete"),$l(e,"error"))}function td(e){if(e.h&&void 0!==Hc&&(!e.C[1]||4!=id(e)||2!=e.da()))if(e.v&&4==id(e))vh(e.La,0,e);else if($l(e,"readystatechange"),4==id(e)){e.h=!1;try{var t,n=e.da();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.I).match(sf)[1]||null;!a&&Wc.self&&Wc.self.location&&(a=Wc.self.location.protocol.slice(0,-1)),i=!Xf.test(a?a.toLowerCase():"")}t=i}if(t)$l(e,"complete"),$l(e,"success");else{e.m=6;try{var o=2<id(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.da()+"]",ed(e)}}finally{nd(e)}}}function nd(e,t){if(e.g){rd(e);var n=e.g,r=e.C[0]?function(){}:null;e.g=null,e.C=null,t||$l(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function rd(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(Wc.clearTimeout(e.A),e.A=null)}function id(e){return e.g?e.g.readyState:0}function ad(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case Jf:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function od(e){var t="";return Ol(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function sd(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=od(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):df(e,t,n))}function ud(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function cd(e){this.Ga=0,this.j=[],this.l=new bh,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ud("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ud("baseRetryDelayMs",5e3,e),this.hb=ud("retryDelaySeedMs",1e4,e),this.eb=ud("forwardChannelMaxRetries",2,e),this.xa=ud("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Rf(e&&e.concurrentRequestLimit),this.Ja=new Bf,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function ld(e){if(fd(e),3==e.H){var t=e.W++,n=cf(e.I);if(df(n,"SID",e.K),df(n,"RID",t),df(n,"TYPE","terminate"),vd(e,n),(t=new zh(e,e.l,t)).L=2,t.v=pf(cf(n)),n=!1,Wc.navigator&&Wc.navigator.sendBeacon)try{n=Wc.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&Wc.Image&&((new Image).src=t.v,n=!0),n||(t.g=Cd(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Zh(t)}Td(e)}function hd(e){e.g&&(kd(e),e.g.cancel(),e.g=null)}function fd(e){hd(e),e.u&&(Wc.clearTimeout(e.u),e.u=null),wd(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Wc.clearTimeout(e.m),e.m=null)}function dd(e){if(!Of(e.i)&&!e.m){e.m=!0;var t=e.Na;uh||hh(),ch||(uh(),ch=!0),lh.add(t,e),e.C=0}}function pd(e,t){var n;n=t?t.m:e.W++;var r=cf(e.I);df(r,"SID",e.K),df(r,"RID",n),df(r,"AID",e.V),vd(e,r),e.o&&e.s&&sd(r,e.o,e.s),n=new zh(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=yd(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),Lf(e.i,n),Qh(n,r,t)}function vd(e,t){e.na&&Ol(e.na,(function(e,n){df(t,n,e)})),e.h&&of({},(function(e,n){df(t,n,e)}))}function yd(e,t,n){n=Math.min(e.j.length,n);var r=e.h?$c(e.h.Va,e.h,e):null;e:for(var i=e.j,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].g,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].g,l=i[u].map;if(0>(c-=a))a=Math.max(0,i[u].g-100),s=!1;else try{jf(l,o,"req"+c+"_")}catch(e){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.j.splice(0,n),t.F=e,r}function md(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;uh||hh(),ch||(uh(),ch=!0),lh.add(t,e),e.A=0}}function gd(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=Oh($c(e.Ma,e),Ed(e,e.A)),e.A++,!0)}function kd(e){null!=e.B&&(Wc.clearTimeout(e.B),e.B=null)}function _d(e){e.g=new zh(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=cf(e.wa);df(t,"RID","rpc"),df(t,"SID",e.K),df(t,"AID",e.V),df(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&df(t,"TO",e.qa),df(t,"TYPE","xmlhttp"),vd(e,t),e.o&&e.s&&sd(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=pf(cf(t)),n.s=null,n.S=!0,Yh(n,e)}function wd(e){null!=e.v&&(Wc.clearTimeout(e.v),e.v=null)}function bd(e,t){var n=null;if(e.g==t){wd(e),kd(e),e.g=null;var r=2}else{if(!Df(e.i,t))return;n=t.F,Mf(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;$l(r=xh(),new Nh(r,n)),dd(e)}else md(e);else if(3==(i=t.o)||0==i&&0<t.ca||!(1==r&&function(e,t){return!(Pf(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=Oh($c(e.Na,e,t),Ed(e,e.C)),e.C++,0)))}(e,t)||2==r&&gd(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Id(e,5);break;case 4:Id(e,10);break;case 3:Id(e,6);break;default:Id(e,2)}}function Ed(e,t){var n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Id(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=$c(e.pb,e);n||(n=new uf("//www.google.com/images/cleardot.gif"),Wc.location&&"http"==Wc.location.protocol||lf(n,"https"),pf(n)),function(e,t){var n=new bh;if(Wc.Image){var r=new Image;r.onload=Zc(Vf,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Zc(Vf,n,r,"TestLoadImage: error",!1,t),r.onabort=Zc(Vf,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Zc(Vf,n,r,"TestLoadImage: timeout",!1,t),Wc.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Rh(2);e.H=0,e.h&&e.h.za(t),Td(e),fd(e)}function Td(e){if(e.H=0,e.ma=[],e.h){var t=Uf(e.i);0==t.length&&0==e.j.length||(il(e.ma,t),il(e.ma,e.j),e.i.i.length=0,rl(e.j),e.j.length=0),e.h.ya()}}function xd(e,t,n){var r=n instanceof uf?cf(n):new uf(n);if(""!=r.g)t&&(r.g=t+"."+r.g),hf(r,r.m);else{var i=Wc.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new uf(null);r&&lf(a,r),t&&(a.g=t),i&&hf(a,i),n&&(a.l=n),r=a}return n=e.F,t=e.Da,n&&t&&df(r,n,t),df(r,"VER",e.ra),vd(e,r),r}function Cd(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new Yf(new qf({ob:!0})):new Yf(e.va)).Oa(e.J),t}function Sd(){}function Ad(){if(vl&&!(10<=Number(Tl)))throw Error("Environmental error: no available transport.")}function Rd(e,t){Xl.call(this),this.g=new cd(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!sl(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!sl(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Pd(this)}function Nd(e){jh.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Od(){Vh.call(this),this.status=1}function Pd(e){this.g=e}function Dd(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Ld(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var a=e.g[3],o=t+(a^n&(i^a))+r[0]+3614090360&4294967295;o=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=n+(o<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(i^a))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(i^a))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(i^a))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=a+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^a&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(a^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^a&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^a&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^a&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^a&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(a^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(i^a))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^a)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^a)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^a)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^a)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(a^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^a^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~a))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(a|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~a))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(a|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~a))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(a|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((a=(t=n+((o=t+(i^(n|~a))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=a+((o=i+(t^(a|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}function Md(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var a=0|e[i];r&&a==t||(n[i]=a,r=!1)}this.g=n}(Bc=Yf.prototype).Oa=function(e){this.M=e},Bc.ha=function(t,n,r,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);n=n?n.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Fh.g(),this.C=this.u?Mh(this.u):Mh(Fh),this.g.onreadystatechange=$c(this.La,this);try{this.G=!0,this.g.open(n,String(t),!0),this.G=!1}catch(e){return void Zf(this,e)}if(t=r||"",r=new Map(this.headers),i){var a=!0,o=!1,s=void 0;if(Object.getPrototypeOf(i)===Object.prototype)for(var u in i)r.set(u,i[u]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));try{for(var c,l=i.keys()[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var h=c.value;r.set(h,i.get(h))}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}}}i=Array.from(r.keys()).find((function(e){return"content-type"==e.toLowerCase()})),u=Wc.FormData&&t instanceof Wc.FormData,!(0<=nl($f,n))||i||u||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var f=!0,d=!1,p=void 0;try{for(var v,y=r[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var m=e(k)(v.value,2),g=m[0],_=m[1];this.g.setRequestHeader(g,_)}}catch(e){d=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{rd(this),0<this.B&&((this.L=function(e){return vl&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=$c(this.ua,this)):this.A=vh(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(e){Zf(this,e)}},Bc.ua=function(){void 0!==Hc&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,$l(this,"timeout"),this.abort(8))},Bc.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,$l(this,"complete"),$l(this,"abort"),nd(this))},Bc.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),nd(this,!0)),Yf.$.N.call(this)},Bc.La=function(){this.s||(this.G||this.v||this.l?td(this):this.kb())},Bc.kb=function(){td(this)},Bc.isActive=function(){return!!this.g},Bc.da=function(){try{return 2<id(this)?this.g.status:-1}catch(e){return-1}},Bc.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},Bc.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Qf(t)}},Bc.Ia=function(){return this.m},Bc.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Bc=cd.prototype).ra=8,Bc.H=1,Bc.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;var t=new zh(this,this.l,e),n=this.s;if(this.U&&(n?Ll(n=Pl(n),this.U):n=this.U),null!==this.o||this.O||(t.I=n,n=null),this.P)e:{for(var r=0,i=0;i<this.j.length;i++){var a=this.j[i];if(void 0===(a="__data__"in a.map&&"string"==typeof(a=a.map.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.j.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=yd(this,t,r),df(i=cf(this.I),"RID",e),df(i,"CVER",22),this.F&&df(i,"X-HTTP-Session-Id",this.F),vd(this,i),n&&(this.O?r="headers="+encodeURIComponent(String(od(n)))+"&"+r:this.o&&sd(i,this.o,n)),Lf(this.i,t),this.bb&&df(i,"TYPE","init"),this.P?(df(i,"$req",r),df(i,"SID","null"),t.aa=!0,Qh(t,i,null)):Qh(t,i,r),this.H=2}}else 3==this.H&&(e?pd(this,e):0==this.j.length||Of(this.i)||pd(this))},Bc.Ma=function(){if(this.u=null,_d(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Oh($c(this.jb,this),e)}},Bc.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Rh(10),hd(this),_d(this))},Bc.ib=function(){null!=this.v&&(this.v=null,hd(this),gd(this),Rh(19))},Bc.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Rh(2)):(this.l.info("Failed to ping google.com"),Rh(1))},Bc.isActive=function(){return!!this.h&&this.h.isActive(this)},(Bc=Sd.prototype).Ba=function(){},Bc.Aa=function(){},Bc.za=function(){},Bc.ya=function(){},Bc.isActive=function(){return!0},Bc.Va=function(){},Ad.prototype.g=function(e,t){return new Rd(e,t)},el(Rd,Xl),Rd.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Rh(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=xd(e,null,e.Y),dd(e)},Rd.prototype.close=function(){ld(this.g)},Rd.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=eh(e),e=n);t.j.push(new Af(t.fb++,e)),3==t.H&&dd(t)},Rd.prototype.N=function(){this.g.h=null,delete this.j,ld(this.g),delete this.g,Rd.$.N.call(this)},el(Nd,jh),el(Od,Vh),el(Pd,Sd),Pd.prototype.Ba=function(){$l(this.g,"a")},Pd.prototype.Aa=function(e){$l(this.g,new Nd(e))},Pd.prototype.za=function(e){$l(this.g,new Od)},Pd.prototype.ya=function(){$l(this.g,"b")},el(Dd,(function(){this.blockSize=-1})),Dd.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Dd.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,a=0;a<t;){if(0==i)for(;a<=n;)Ld(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<t;)if(r[i++]=e.charCodeAt(a++),i==this.blockSize){Ld(this,r),i=0;break}}else for(;a<t;)if(r[i++]=e[a++],i==this.blockSize){Ld(this,r),i=0;break}}this.h=i,this.i+=t},Dd.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var Ud={};function Fd(e){return-128<=e&&128>e?function(e,t){var n=Ud;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new Md([0|e],0>e?-1:0)})):new Md([0|e],0>e?-1:0)}function Bd(e){if(isNaN(e)||!isFinite(e))return Vd;if(0>e)return Kd(Bd(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=jd;return new Md(t,0)}var jd=4294967296,Vd=Fd(0),qd=Fd(1),zd=Fd(16777216);function Hd(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Wd(e){return-1==e.h}function Kd(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new Md(n,~e.h).add(qd)}function Gd(e,t){return e.add(Kd(t))}function Qd(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Yd(e,t){this.g=e,this.h=t}function Jd(e,t){if(Hd(t))throw Error("division by zero");if(Hd(e))return new Yd(Vd,Vd);if(Wd(e))return t=Jd(Kd(e),t),new Yd(Kd(t.g),Kd(t.h));if(Wd(t))return t=Jd(e,Kd(t)),new Yd(Kd(t.g),t.h);if(30<e.g.length){if(Wd(e)||Wd(t))throw Error("slowDivide_ only works with positive integers.");for(var n=qd,r=t;0>=r.X(e);)n=Xd(n),r=Xd(r);var i=$d(n,1),a=$d(r,1);for(r=$d(r,2),n=$d(n,2);!Hd(r);){var o=a.add(r);0>=o.X(e)&&(i=i.add(n),a=o),r=$d(r,1),n=$d(n,1)}return t=Gd(e,i.R(t)),new Yd(i,t)}for(i=Vd;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(a=Bd(n)).R(t);Wd(o)||0<o.X(e);)o=(a=Bd(n-=r)).R(t);Hd(a)&&(a=qd),i=i.add(a),e=Gd(e,o)}return new Yd(i,e)}function Xd(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new Md(n,e.h)}function $d(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],a=0;a<r;a++)i[a]=0<t?e.D(a+n)>>>t|e.D(a+n+1)<<32-t:e.D(a+n);return new Md(i,e.h)}(Bc=Md.prototype).ea=function(){if(Wd(this))return-Kd(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:jd+r)*t,t*=jd}return e},Bc.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(Hd(this))return"0";if(Wd(this))return"-"+Kd(this).toString(e);for(var t=Bd(Math.pow(e,6)),n=this,r="";;){var i=Jd(n,t).g,a=((0<(n=Gd(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(Hd(n=i))return a+r;for(;6>a.length;)a="0"+a;r=a+r}},Bc.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},Bc.X=function(e){return Wd(e=Gd(this,e))?-1:Hd(e)?0:1},Bc.abs=function(){return Wd(this)?Kd(this):this},Bc.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var a=r+(65535&this.D(i))+(65535&e.D(i)),o=(a>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,a&=65535,o&=65535,n[i]=o<<16|a}return new Md(n,-2147483648&n[n.length-1]?-1:0)},Bc.R=function(e){if(Hd(this)||Hd(e))return Vd;if(Wd(this))return Wd(e)?Kd(this).R(Kd(e)):Kd(Kd(this).R(e));if(Wd(e))return Kd(this.R(Kd(e)));if(0>this.X(zd)&&0>e.X(zd))return Bd(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var a=this.D(r)>>>16,o=65535&this.D(r),s=e.D(i)>>>16,u=65535&e.D(i);n[2*r+2*i]+=o*u,Qd(n,2*r+2*i),n[2*r+2*i+1]+=a*u,Qd(n,2*r+2*i+1),n[2*r+2*i+1]+=o*s,Qd(n,2*r+2*i+1),n[2*r+2*i+2]+=a*s,Qd(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new Md(n,0)},Bc.gb=function(e){return Jd(this,e).h},Bc.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new Md(n,this.h&e.h)},Bc.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new Md(n,this.h|e.h)},Bc.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new Md(n,this.h^e.h)},Ad.prototype.createWebChannel=Ad.prototype.g,Rd.prototype.send=Rd.prototype.u,Rd.prototype.open=Rd.prototype.m,Rd.prototype.close=Rd.prototype.close,Ph.NO_ERROR=0,Ph.TIMEOUT=8,Ph.HTTP_ERROR=6,Dh.COMPLETE="complete",Uh.EventType=Bh,Bh.OPEN="a",Bh.CLOSE="b",Bh.ERROR="c",Bh.MESSAGE="d",Xl.prototype.listen=Xl.prototype.O,Yf.prototype.listenOnce=Yf.prototype.P,Yf.prototype.getLastError=Yf.prototype.Sa,Yf.prototype.getLastErrorCode=Yf.prototype.Ia,Yf.prototype.getStatus=Yf.prototype.da,Yf.prototype.getResponseJson=Yf.prototype.Wa,Yf.prototype.getResponseText=Yf.prototype.ja,Yf.prototype.send=Yf.prototype.ha,Yf.prototype.setWithCredentials=Yf.prototype.Oa,Dd.prototype.digest=Dd.prototype.l,Dd.prototype.reset=Dd.prototype.reset,Dd.prototype.update=Dd.prototype.j,Md.prototype.add=Md.prototype.add,Md.prototype.multiply=Md.prototype.R,Md.prototype.modulo=Md.prototype.gb,Md.prototype.compare=Md.prototype.X,Md.prototype.toNumber=Md.prototype.ea,Md.prototype.toString=Md.prototype.toString,Md.prototype.getBits=Md.prototype.D,Md.fromNumber=Bd,Md.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Kd(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Bd(Math.pow(n,8)),i=Vd,a=0;a<t.length;a+=8){var o=Math.min(8,t.length-a),s=parseInt(t.substring(a,a+o),n);8>o?(o=Bd(Math.pow(n,o)),i=i.R(o).add(Bd(s))):i=(i=i.R(r)).add(Bd(s))}return i};var Zd=zc.createWebChannelTransport=function(){return new Ad},ep=zc.getStatEventTarget=function(){return xh()},tp=zc.ErrorCode=Ph,np=zc.EventType=Dh,rp=zc.Event=Ih,ip=zc.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ap=zc.FetchXmlHttpFactory=qf,op=zc.WebChannel=Uh,sp=zc.XhrIo=Yf,up=zc.Md5=Dd,cp=zc.Integer=Md,lp="@firebase/firestore",hp=function(){"use strict";function t(n){e(s)(this,t),this.uid=n}return e(u)(t,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),t}();hp.UNAUTHENTICATED=new hp(null),hp.GOOGLE_CREDENTIALS=new hp("google-credentials-uid"),hp.FIRST_PARTY=new hp("first-party-uid"),hp.MOCK_USER=new hp("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var fp="10.5.2",dp=new vt("@firebase/firestore");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(){return dp.logLevel}function vp(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(dp.logLevel<=ot.DEBUG){var a,o=r.map(gp);(a=dp).debug.apply(a,["Firestore (".concat(fp,"): ").concat(t)].concat(e(h)(o)))}}function yp(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(dp.logLevel<=ot.ERROR){var a,o=r.map(gp);(a=dp).error.apply(a,["Firestore (".concat(fp,"): ").concat(t)].concat(e(h)(o)))}}function mp(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(dp.logLevel<=ot.WARN){var a,o=r.map(gp);(a=dp).warn.apply(a,["Firestore (".concat(fp,"): ").concat(t)].concat(e(h)(o)))}}function gp(e){if("string"==typeof e)return e;try{
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */return t=e,JSON.stringify(t)}catch(t){return e}var t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(fp,") INTERNAL ASSERTION FAILED: ")+e;throw yp(t),new Error(t)}function _p(e,t){e||kp()}function wp(e,t){return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bp={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ep=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t,i)).code=t,a.message=i,a.toString=function(){return"".concat(a.name,": [code=").concat(a.code,"]: ").concat(a.message)},e(Vc)(a)}return r}(Ne),Ip=function t(){"use strict";var n=this;e(s)(this,t),this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))},Tp=function t(n,r){"use strict";e(s)(this,t),this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(n))},xp=function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(hp.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),t}(),Cp=function(){"use strict";function t(n){e(s)(this,t),this.token=n,this.changeListener=null}return e(u)(t,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),t}(),Sp=function(){"use strict";function t(n){e(s)(this,t),this.t=n,this.currentUser=hp.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return e(u)(t,[{key:"start",value:function(t,n){var r=this,i=this.i,o=function(e){return r.i!==i?(i=r.i,n(e)):Promise.resolve()},s=new Ip;this.o=function(){var e=r;r.i++,r.currentUser=r.u(),s.resolve(),s=new Ip,t.enqueueRetryable((function(){return o(e.currentUser)}))};var u=function(){var n=s,i=r;t.enqueueRetryable(e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.promise;case 2:return e.next=4,o(i.currentUser);case 4:case"end":return e.stop()}}),t)}))))},c=function(e){vp("FirebaseAuthCredentialsProvider","Auth detected"),r.auth=e,r.auth.addAuthTokenListener(r.o),u()};this.t.onInit((function(e){return c(e)})),setTimeout((function(){if(!r.auth){var e=r.t.getImmediate({optional:!0});e?c(e):(vp("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ip)}}),0),u()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(vp("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(_p("string"==typeof n.accessToken),new Tp(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return _p(null===e||"string"==typeof e),new hp(e)}}]),t}(),Ap=function(){"use strict";function t(n,r,i){e(s)(this,t),this.l=n,this.h=r,this.P=i,this.type="FirstParty",this.user=hp.FIRST_PARTY,this.I=new Map}return e(u)(t,[{key:"T",value:function(){return this.P?this.P():null}},{key:"headers",get:function(){this.I.set("X-Goog-AuthUser",this.l);var e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}]),t}(),Rp=function(){"use strict";function t(n,r,i){e(s)(this,t),this.l=n,this.h=r,this.P=i}return e(u)(t,[{key:"getToken",value:function(){return Promise.resolve(new Ap(this.l,this.h,this.P))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(hp.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),t}(),Np=function t(n){"use strict";e(s)(this,t),this.value=n,this.type="AppCheck",this.headers=new Map,n&&n.length>0&&this.headers.set("x-firebase-appcheck",this.value)},Op=function(){"use strict";function t(n){e(s)(this,t),this.A=n,this.forceRefresh=!1,this.appCheck=null,this.R=null}return e(u)(t,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable((function(){return function(e){null!=e.error&&vp("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.R;return n.R=e.token,vp("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)}))};var r=function(e){vp("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.A.onInit((function(e){return r(e)})),setTimeout((function(){if(!n.appCheck){var e=n.A.getImmediate({optional:!0});e?r(e):vp("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(_p("string"==typeof t.token),e.R=t.token,new Np(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Pp(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dp=function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,null,[{key:"newId",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=Pp(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),t}();function Lp(e,t){return e<t?-1:e>t?1:0}function Mp(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Up=function(){"use strict";function t(n,r){if(e(s)(this,t),this.seconds=n,this.nanoseconds=r,r<0)throw new Ep(bp.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ep(bp.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(n<-62135596800)throw new Ep(bp.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n);if(n>=253402300800)throw new Ep(bp.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n)}return e(u)(t,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?Lp(this.nanoseconds,e.nanoseconds):Lp(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return t.fromMillis(Date.now())}},{key:"fromDate",value:function(e){return t.fromMillis(e.getTime())}},{key:"fromMillis",value:function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))}}]),t}(),Fp=function(){"use strict";function t(n){e(s)(this,t),this.timestamp=n}return e(u)(t,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(e){return new t(e)}},{key:"min",value:function(){return new t(new Up(0,0))}},{key:"max",value:function(){return new t(new Up(253402300799,999999999))}}]),t}(),Bp=function(){"use strict";function t(n,r,i){e(s)(this,t),void 0===r?r=0:r>n.length&&kp(),void 0===i?i=n.length-r:i>n.length-r&&kp(),this.segments=n,this.offset=r,this.len=i}return e(u)(t,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(e){return 0===t.comparator(this,e)}},{key:"child",value:function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(e){n.push(e)})):n.push(e),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),t}(),jp=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(u)(r,[{key:"construct",value:function(e,t,n){return new r(e,t,n)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=[],o=!0,s=!1,u=void 0;try{for(var c,l=n[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f,d=c.value;if(d.indexOf("//")>=0)throw new Ep(bp.INVALID_ARGUMENT,"Invalid segment (".concat(d,"). Paths must not contain // in them."));(f=a).push.apply(f,e(h)(d.split("/").filter((function(e){return e.length>0}))))}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return new r(a)}},{key:"emptyPath",value:function(){return new r([])}}]),r}(Bp),Vp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,qp=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(u)(r,[{key:"construct",value:function(e,t,n){return new r(e,t,n)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return Vp.test(e)}},{key:"keyField",value:function(){return new r(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],n="",i=0,a=function(){if(0===n.length)throw new Ep(bp.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new Ep(bp.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ep(bp.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(n+=s,i++):(a(),i++)}if(a(),o)throw new Ep(bp.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new r(t)}},{key:"emptyPath",value:function(){return new r([])}}]),r}(Bp),zp=function(){"use strict";function t(n){e(s)(this,t),this.path=n}return e(u)(t,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===jp.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(e){return new t(jp.fromString(e))}},{key:"fromName",value:function(e){return new t(jp.fromString(e).popFirst(5))}},{key:"empty",value:function(){return new t(jp.emptyPath())}},{key:"comparator",value:function(e,t){return jp.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(e){return new t(new jp(e.slice()))}}]),t}(),Hp=function t(n,r,i,a){"use strict";e(s)(this,t),this.indexId=n,this.collectionGroup=r,this.fields=i,this.indexState=a};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Hp.UNKNOWN_ID=-1;function Wp(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Fp.fromTimestamp(1e9===r?new Up(n+1,0):new Up(n,r));return new Gp(i,zp.empty(),t)}function Kp(e){return new Gp(e.readTime,e.key,-1)}var Gp=function(){"use strict";function t(n,r,i){e(s)(this,t),this.readTime=n,this.documentKey=r,this.largestBatchId=i}return e(u)(t,null,[{key:"min",value:function(){return new t(Fp.min(),zp.empty(),-1)}},{key:"max",value:function(){return new t(Fp.max(),zp.empty(),-1)}}]),t}();function Qp(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=zp.comparator(e.documentKey,t.documentKey))?n:Lp(e.largestBatchId,t.largestBatchId)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yp="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Jp=function(){"use strict";function t(){e(s)(this,t),this.onCommittedListeners=[]}return e(u)(t,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),t}();function Xp(e){return $p.apply(this,arguments)}function $p(){return($p=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.code===bp.FAILED_PRECONDITION&&n.message===Yp){e.next=2;break}throw n;case 2:vp("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zp=function(){"use strict";function t(n){var r=this;e(s)(this,t),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,n((function(e){r.isDone=!0,r.result=e,r.nextCallback&&r.nextCallback(e)}),(function(e){r.isDone=!0,r.error=e,r.catchCallback&&r.catchCallback(e)}))}return e(u)(t,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(e,n){var r=this;return this.callbackAttached&&kp(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){var a=r;r.nextCallback=function(n){a.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){a.wrapFailure(n,e).next(t,i)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}}},{key:"wrapSuccess",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)}},{key:"wrapFailure",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)}}],[{key:"resolve",value:function(e){return new t((function(t,n){t(e)}))}},{key:"reject",value:function(e){return new t((function(t,n){n(e)}))}},{key:"waitFor",value:function(e){return new t((function(t,n){var r=0,i=0,a=!1;e.forEach((function(e){++r,e.next((function(){++i,a&&i===r&&t()}),(function(e){return n(e)}))})),a=!0,i===r&&t()}))}},{key:"or",value:function(e){var n=t.resolve(!1),r=!0,i=!1,a=void 0;try{for(var o,s=function(e,r){var i=r.value;n=n.next((function(e){return e?t.resolve(e):i()}))},u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)s(0,o)}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)}},{key:"mapArray",value:function(e,n){return new t((function(t,r){for(var i=function(i){var u=i;n(e[u]).next((function(e){o[u]=e,++s===a&&t(o)}),(function(e){return r(e)}))},a=e.length,o=new Array(a),s=0,u=0;u<a;u++)i(u)}))}},{key:"doWhile",value:function(e,n){return new t((function(t,r){var i=function(){!0===e()?n().next((function(){i()}),r):t()};i()}))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(e){return"IndexedDbTransactionError"===e.name}var tv=function(){"use strict";function t(n,r){var i=this;e(s)(this,t),this.previousValue=n,r&&(r.sequenceNumberHandler=function(e){return i.se(e)},this.oe=function(e){return r.writeSequenceNumber(e)})}return e(u)(t,[{key:"se",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.oe&&this.oe(e),e}}]),t}();function nv(e){return null==e}function rv(e){return 0===e&&1/e==-1/0}function iv(e){return"number"==typeof e&&Number.isInteger(e)&&!rv(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tv._e=-1;var av=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ov=(e(h)(av).concat(["documentOverlays"]),["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"]),sv=ov;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */e(h)(sv).concat(["indexConfiguration","indexState","indexEntries"]);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function uv(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function cv(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function lv(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hv=function(){"use strict";function t(n,r){e(s)(this,t),this.comparator=n,this.root=r||dv.EMPTY}return e(u)(t,[{key:"insert",value:function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,dv.BLACK,null,null))}},{key:"remove",value:function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dv.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new fv(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new fv(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new fv(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new fv(this.root,e,this.comparator,!0)}}]),t}(),fv=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.isReverse=a,this.nodeStack=[];for(var o=1;!n.isEmpty();)if(o=r?i(n.key,r):1,r&&a&&(o*=-1),o<0)n=this.isReverse?n.left:n.right;else{if(0===o){this.nodeStack.push(n);break}this.nodeStack.push(n),n=this.isReverse?n.right:n.left}}return e(u)(t,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),t}(),dv=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.key=n,this.value=r,this.color=null!=i?i:t.RED,this.left=null!=a?a:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return e(u)(t,[{key:"copy",value:function(e,n,r,i,a){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}},{key:"rotateRight",value:function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw kp();if(this.right.isRed())throw kp();var e=this.left.check();if(e!==this.right.check())throw kp();return e+(this.isRed()?0:1)}}]),t}();dv.EMPTY=null,dv.RED=!0,dv.BLACK=!1,dv.EMPTY=new(function(){"use strict";function t(){e(s)(this,t),this.size=0}return e(u)(t,[{key:"key",get:function(){throw kp()}},{key:"value",get:function(){throw kp()}},{key:"color",get:function(){throw kp()}},{key:"left",get:function(){throw kp()}},{key:"right",get:function(){throw kp()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new dv(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pv=function(){"use strict";function t(n){e(s)(this,t),this.comparator=n,this.data=new hv(this.comparator)}return e(u)(t,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new vv(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new vv(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(e){var n=new t(this.comparator);return n.data=e,n}}]),t}(),vv=function(){"use strict";function t(n){e(s)(this,t),this.iter=n}return e(u)(t,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var yv=function(){"use strict";function t(n){e(s)(this,t),this.fields=n,n.sort(qp.comparator)}return e(u)(t,[{key:"unionWith",value:function(e){var n=new pv(qp.comparator),r=!0,i=!1,a=void 0;try{for(var o,s=this.fields[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;n=n.add(u)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}var c=!0,l=!1,h=void 0;try{for(var f,d=e[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var p=f.value;n=n.add(p)}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}return new t(n.toArray())}},{key:"covers",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.fields[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.isPrefixOf(e))return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"isEqual",value:function(e){return Mp(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new t([])}}]),t}(),mv=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){var t;return e(s)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).name="Base64DecodeError",e(Vc)(t)}return r}(e(A)(Error));
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gv=Symbol.iterator,kv=function(){"use strict";function t(n){e(s)(this,t),this.binaryString=n}return e(u)(t,[{key:gv,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return Lp(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new mv("Invalid base64 string: "+e):e}}(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kv.EMPTY_BYTE_STRING=new kv("");var _v=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wv(e){if(_p(!!e),"string"==typeof e){var t=0,n=_v.exec(e);if(_p(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:bv(e.seconds),nanos:bv(e.nanos)}}function bv(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Ev(e){return"string"==typeof e?kv.fromBase64String(e):kv.fromUint8Array(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Tv(e){var t=e.mapValue.fields.__previous_value__;return Iv(t)?Tv(t):t}function xv(e){var t=wv(e.mapValue.fields.__local_write_time__.timestampValue);return new Up(t.seconds,t.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cv=function t(n,r,i,a,o,u,c,l,h){"use strict";e(s)(this,t),this.databaseId=n,this.appId=r,this.persistenceKey=i,this.host=a,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h},Sv=function(){"use strict";function t(n,r){e(s)(this,t),this.projectId=n,this.database=r||"(default)"}return e(u)(t,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}}],[{key:"empty",value:function(){return new t("","")}}]),t}(),Av={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Rv(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Iv(e)?4:Hv(e)?9007199254740991:10:kp()}function Nv(e,t){if(e===t)return!0;var n,r=Rv(e);if(r!==Rv(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return xv(e).isEqual(xv(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=wv(e.timestampValue),r=wv(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,Ev(e.bytesValue).isEqual(Ev(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return bv(e.geoPointValue.latitude)===bv(t.geoPointValue.latitude)&&bv(e.geoPointValue.longitude)===bv(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return bv(e.integerValue)===bv(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=bv(e.doubleValue),r=bv(t.doubleValue);return n===r?rv(n)===rv(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Mp(e.arrayValue.values||[],t.arrayValue.values||[],Nv);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(uv(n)!==uv(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Nv(n[i],r[i])))return!1;return!0}(e,t);default:return kp()}}function Ov(e,t){return void 0!==(e.values||[]).find((function(e){return Nv(e,t)}))}function Pv(e,t){if(e===t)return 0;var n,r,i,a,o=Rv(e),s=Rv(t);if(o!==s)return Lp(o,s);switch(o){case 0:case 9007199254740991:return 0;case 1:return Lp(e.booleanValue,t.booleanValue);case 2:return r=t,i=bv((n=e).integerValue||n.doubleValue),a=bv(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return Dv(e.timestampValue,t.timestampValue);case 4:return Dv(xv(e),xv(t));case 5:return Lp(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Ev(e),r=Ev(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=Lp(n[i],r[i]);if(0!==a)return a}return Lp(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=Lp(bv(e.latitude),bv(t.latitude));return 0!==n?n:Lp(bv(e.longitude),bv(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=Pv(n[i],r[i]);if(a)return a}return Lp(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Av.mapValue&&t===Av.mapValue)return 0;if(e===Av.mapValue)return 1;if(t===Av.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=Lp(r[o],a[o]);if(0!==s)return s;var u=Pv(n[r[o]],i[a[o]]);if(0!==u)return u}return Lp(r.length,a.length)}(e.mapValue,t.mapValue);default:throw kp()}}function Dv(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Lp(e,t);var n=wv(e),r=wv(t),i=Lp(n.seconds,r.seconds);return 0!==i?i:Lp(n.nanos,r.nanos)}function Lv(e){return Mv(e)}function Mv(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(t=e.timestampValue,n=wv(t),"time(".concat(n.seconds,",").concat(n.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Ev(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return zp.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){var t="[",n=!0,r=!0,i=!1,a=void 0;try{for(var o,s=(e.values||[])[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;n?n=!1:t+=",",t+=Mv(u)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return t+"]"}(e.arrayValue):"mapValue"in e?function(e){var t=Object.keys(e.fields||{}).sort(),n="{",r=!0,i=!0,a=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r?r=!1:n+=",",n+="".concat(c,":").concat(Mv(e.fields[c]))}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return n+"}"}(e.mapValue):kp();var t,n}function Uv(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Fv(e){return!!e&&"integerValue"in e}function Bv(e){return!!e&&"arrayValue"in e}function jv(e){return!!e&&"nullValue"in e}function Vv(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function qv(e){return!!e&&"mapValue"in e}function zv(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return cv(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=zv(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=zv(e.arrayValue.values[r]);return n}return Object.assign({},e)}function Hv(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wv=function(){"use strict";function t(n){e(s)(this,t),this.value=n}return e(u)(t,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!qv(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=zv(t)}},{key:"setAll",value:function(e){var t=this,n=qp.emptyPath(),r={},i=[];e.forEach((function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=zv(e):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());qv(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return Nv(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];qv(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){cv(t,(function(t,n){return e[t]=n}));var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;delete e[u]}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"clone",value:function(){return new t(zv(this.value))}}],[{key:"empty",value:function(){return new t({mapValue:{}})}}]),t}();function Kv(e){var t=[];return cv(e.fields,(function(e,n){var r=new qp([e]);if(qv(n)){var i=Kv(n.mapValue).fields,a=!0,o=!1,s=void 0;if(0===i.length)t.push(r);else try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;t.push(r.child(l))}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}}else t.push(r)})),new yv(t)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var Gv=function(){"use strict";function t(n,r,i,a,o,u,c){e(s)(this,t),this.key=n,this.documentType=r,this.version=i,this.readTime=a,this.createTime=o,this.data=u,this.documentState=c}return e(u)(t,[{key:"convertToFoundDocument",value:function(e,t){return!this.createTime.isEqual(Fp.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=Wv.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=Wv.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=Fp.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}},{key:"mutableCopy",value:function(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(e){return new t(e,0,Fp.min(),Fp.min(),Fp.min(),Wv.empty(),0)}},{key:"newFoundDocument",value:function(e,n,r,i){return new t(e,1,n,Fp.min(),r,i,0)}},{key:"newNoDocument",value:function(e,n){return new t(e,2,n,Fp.min(),Fp.min(),Wv.empty(),0)}},{key:"newUnknownDocument",value:function(e,n){return new t(e,3,n,Fp.min(),Fp.min(),Wv.empty(),2)}}]),t}(),Qv=function t(n,r){"use strict";e(s)(this,t),this.position=n,this.inclusive=r};
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yv(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?zp.comparator(zp.fromName(o.referenceValue),n.key):Pv(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function Jv(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!Nv(e.position[n],t.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xv=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";e(s)(this,t),this.field=n,this.dir=r};function $v(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zv=function t(){"use strict";e(s)(this,t)},ey=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this)).field=t,o.op=i,o.value=a,e(Vc)(o)}return e(u)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Pv(t,this.value)):null!==t&&Rv(this.value)===Rv(t)&&this.matchesComparison(Pv(t,this.value))}},{key:"matchesComparison",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return kp()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}}],[{key:"create",value:function(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new uy(e,t,n):"array-contains"===t?new fy(e,n):"in"===t?new dy(e,n):"not-in"===t?new py(e,n):"array-contains-any"===t?new vy(e,n):new r(e,t,n)}},{key:"createKeyFieldInFilter",value:function(e,t,n){return"in"===t?new cy(e,n):new ly(e,n)}}]),r}(Zv),ty=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).filters=t,a.op=i,a.ue=null,e(Vc)(a)}return e(u)(r,[{key:"matches",value:function(e){return ny(this)?void 0===this.filters.find((function(t){return!t.matches(e)})):void 0!==this.filters.find((function(t){return t.matches(e)}))}},{key:"getFlattenedFilters",value:function(){return null!==this.ue||(this.ue=this.filters.reduce((function(e,t){return e.concat(t.getFlattenedFilters())}),[])),this.ue}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}}],[{key:"create",value:function(e,t){return new r(e,t)}}]),r}(Zv);function ny(e){return"and"===e.op}function ry(e){return iy(e)&&ny(e)}function iy(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.filters[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value instanceof ty)return!1}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!0}function ay(e){if(e instanceof ey)return e.field.canonicalString()+e.op.toString()+Lv(e.value);if(ry(e))return e.filters.map((function(e){return ay(e)})).join(",");var t=e.filters.map((function(e){return ay(e)})).join(",");return"".concat(e.op,"(").concat(t,")")}function oy(e,t){return e instanceof ey?(n=e,(r=t)instanceof ey&&n.op===r.op&&n.field.isEqual(r.field)&&Nv(n.value,r.value)):e instanceof ty?function(e,t){return t instanceof ty&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((function(e,n,r){return e&&oy(n,t.filters[r])}),!0)}(e,t):void kp();var n,r}function sy(e){return e instanceof ey?"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(Lv(t.value)):e instanceof ty?function(e){return e.op.toString()+" {"+e.getFilters().map(sy).join(" ,")+"}"}(e):"Filter";var t}var uy=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this,t,i,a)).key=zp.fromName(a.referenceValue),e(Vc)(o)}return e(u)(r,[{key:"matches",value:function(e){var t=zp.comparator(e.key,this.key);return this.matchesComparison(t)}}]),r}(ey),cy=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t,"in",i)).keys=hy("in",i),e(Vc)(a)}return e(u)(r,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),r}(ey),ly=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t,"not-in",i)).keys=hy("not-in",i),e(Vc)(a)}return e(u)(r,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),r}(ey);function hy(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return zp.fromName(e.referenceValue)}))}var fy=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){return e(s)(this,r),n.call(this,t,"array-contains",i)}return e(u)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return Bv(t)&&Ov(t.arrayValue,this.value)}}]),r}(ey),dy=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){return e(s)(this,r),n.call(this,t,"in",i)}return e(u)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&Ov(this.value.arrayValue,t)}}]),r}(ey),py=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){return e(s)(this,r),n.call(this,t,"not-in",i)}return e(u)(r,[{key:"matches",value:function(e){if(Ov(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!Ov(this.value.arrayValue,t)}}]),r}(ey),vy=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){return e(s)(this,r),n.call(this,t,"array-contains-any",i)}return e(u)(r,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!Bv(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return Ov(t.value.arrayValue,e)}))}}]),r}(ey),yy=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;e(s)(this,t),this.path=n,this.collectionGroup=r,this.orderBy=i,this.filters=a,this.limit=o,this.startAt=u,this.endAt=c,this.ce=null};function my(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new yy(e,t,n,r,i,a,o)}function gy(e){var t=wp(e);if(null===t.ce){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return ay(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return(t=e).field.canonicalString()+t.dir;var t})).join(","),nv(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return Lv(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return Lv(e)})).join(",")),t.ce=n}return t.ce}function ky(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!$v(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(!oy(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Jv(e.startAt,t.startAt)&&Jv(e.endAt,t.endAt)}function _y(e){return zp.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var wy=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;e(s)(this,t),this.path=n,this.collectionGroup=r,this.explicitOrderBy=i,this.filters=a,this.limit=o,this.limitType=u,this.startAt=c,this.endAt=l,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt};function by(e,t,n,r,i,a,o,s){return new wy(e,t,n,r,i,a,o,s)}function Ey(e){return new wy(e)}function Iy(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Ty(e){return null!==e.collectionGroup}function xy(e){var t,n,r=wp(e);if(null===r.le){r.le=[];var i=new Set,a=!0,o=!1,s=void 0;try{for(var u,c=r.explicitOrderBy[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;r.le.push(l),i.add(l.field.canonicalString())}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}var h=r.explicitOrderBy.length>0?r.explicitOrderBy[r.explicitOrderBy.length-1].dir:"asc";(t=r,n=new pv(qp.comparator),t.filters.forEach((function(e){e.getFlattenedFilters().forEach((function(e){e.isInequality()&&(n=n.add(e.field))}))})),n).forEach((function(e){i.has(e.canonicalString())||e.isKeyField()||r.le.push(new Xv(e,h))})),i.has(qp.keyField().canonicalString())||r.le.push(new Xv(qp.keyField(),h))}return r.le}function Cy(e){var t=wp(e);return t.he||(t.he=Sy(t,xy(e))),t.he}function Sy(e,t){if("F"===e.limitType)return my(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);t=t.map((function(e){var t="desc"===e.dir?"asc":"desc";return new Xv(e.field,t)}));var n=e.endAt?new Qv(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Qv(e.startAt.position,e.startAt.inclusive):null;return my(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}function Ay(e,t){var n=e.filters.concat([t]);return new wy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Ry(e,t,n){return new wy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ny(e,t){return ky(Cy(e),Cy(t))&&e.limitType===t.limitType}function Oy(e){return"".concat(gy(Cy(e)),"|lt:").concat(e.limitType)}function Py(e){return"Query(target=".concat((t=Cy(e),n=t.path.canonicalString(),null!==t.collectionGroup&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=", filters: [".concat(t.filters.map((function(e){return sy(e)})).join(", "),"]")),nv(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=", orderBy: [".concat(t.orderBy.map((function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t})).join(", "),"]")),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return Lv(e)})).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return Lv(e)})).join(",")),"Target(".concat(n,")")),"; limitType=").concat(e.limitType,")");var t,n}function Dy(e,t){return t.isFoundDocument()&&(i=e,o=(a=t).key.path,null!==i.collectionGroup?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):zp.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o))&&function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=xy(e)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(!s.field.isKeyField()&&null===t.data.field(s.field))return!1}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(e,t)&&function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=e.filters[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){if(!a.value.matches(t))return!1}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){var r=Yv(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,xy(n),r)||n.endAt&&!function(e,t,n){var r=Yv(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,xy(n),r)));var n,r,i,a,o}function Ly(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function My(e){return function(t,n){var r=!1,i=!0,a=!1,o=void 0;try{for(var s,u=xy(e)[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=Uy(c,t,n);if(0!==l)return l;r=r||c.field.isKeyField()}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return 0}}function Uy(e,t,n){var r,i,a,o,s=e.field.isKeyField()?zp.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),o=i.data.field(r),null!==a&&null!==o?Pv(a,o):kp());switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return kp()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fy=function(){"use strict";function t(n,r){e(s)(this,t),this.mapKeyFn=n,this.equalsFn=r,this.inner={},this.innerSize=0}return e(u)(t,[{key:"get",value:function(t){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){var i=!0,a=!1,o=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=e(k)(s.value,2),l=c[0],h=c[1];if(this.equalsFn(l,t))return h}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(t){cv(this.inner,(function(n,r){var i=!0,a=!1,o=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=e(k)(s.value,2),l=c[0],h=c[1];t(l,h)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}}))}},{key:"isEmpty",value:function(){return lv(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),t}(),By=new hv(zp.comparator);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(){return By}var Vy=new hv(zp.comparator);function qy(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Vy,i=!0,a=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r=r.insert(c.key,c)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return r}function zy(e){var t=Vy;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function Hy(){return Ky()}function Wy(){return Ky()}function Ky(){return new Fy((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var Gy=new hv(zp.comparator),Qy=new pv(zp.comparator);function Yy(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Qy,i=!0,a=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r=r.add(c)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return r}var Jy=new pv(Lp);function Xy(){return Jy}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $y(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:rv(t)?"-0":t}}function Zy(e){return{integerValue:""+e}}function em(e,t){return iv(t)?Zy(t):$y(e,t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tm=function t(){"use strict";e(s)(this,t),this._=void 0};function nm(e,t,n){return e instanceof am?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&Iv(i)&&(i=Tv(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof om?sm(e,t):e instanceof um?cm(e,t):function(e,t){var n=im(e,t),r=hm(n)+hm(e.Ie);return Fv(n)&&Fv(e.Ie)?Zy(r):$y(e.serializer,r)}(e,t);var r,i,a}function rm(e,t,n){return e instanceof om?sm(e,t):e instanceof um?cm(e,t):n}function im(e,t){return e instanceof lm?Fv(n=t)||(r=n)&&"doubleValue"in r?t:{integerValue:0}:null;var n,r}var am=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return r}(tm),om=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).elements=t,e(Vc)(i)}return r}(tm);function sm(e,t){var n=fm(t),r=!0,i=!1,a=void 0;try{for(var o,s=function(e,t){var r=t.value;n.some((function(e){return Nv(e,r)}))||n.push(r)},u=e.elements[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)s(0,o)}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var um=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).elements=t,e(Vc)(i)}return r}(tm);function cm(e,t){var n=fm(t),r=!0,i=!1,a=void 0;try{for(var o,s=function(e,t){var r=t.value;n=n.filter((function(e){return!Nv(e,r)}))},u=e.elements[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)s(0,o)}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var lm=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).serializer=t,a.Ie=i,e(Vc)(a)}return r}(tm);function hm(e){return bv(e.integerValue||e.doubleValue)}function fm(e){return Bv(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dm=function t(n,r){"use strict";e(s)(this,t),this.field=n,this.transform=r};var pm=function t(n,r){"use strict";e(s)(this,t),this.version=n,this.transformResults=r},vm=function(){"use strict";function t(n,r){e(s)(this,t),this.updateTime=n,this.exists=r}return e(u)(t,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new t}},{key:"exists",value:function(e){return new t(void 0,e)}},{key:"updateTime",value:function(e){return new t(e)}}]),t}();function ym(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var mm=function t(){"use strict";e(s)(this,t)};function gm(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Rm(e.key,vm.none()):new Em(e.key,e.data,vm.none());var n=e.data,r=Wv.empty(),i=new pv(qp.comparator),a=!0,o=!1,s=void 0;try{for(var u,c=t.fields[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(!i.has(l)){var h=n.field(l);null===h&&l.length>1&&(l=l.popLast(),h=n.field(l)),null===h?r.delete(l):r.set(l,h),i=i.add(l)}}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}return new Im(e.key,r,new yv(i.toArray()),vm.none())}function km(e,t,n){var r,i,a,o,s;e instanceof Em?(i=t,a=n,o=(r=e).value.clone(),s=xm(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):e instanceof Im?function(e,t,n){if(ym(e.precondition,t)){var r=xm(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Tm(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function _m(e,t,n,r){return e instanceof Em?function(e,t,n,r){if(!ym(e.precondition,t))return n;var i=e.value.clone(),a=Cm(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Im?function(e,t,n,r){if(!ym(e.precondition,t))return n;var i=Cm(e.fieldTransforms,r,t),a=t.data;return a.setAll(Tm(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):(i=t,a=n,ym(e.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function wm(e,t){var n=null,r=!0,i=!1,a=void 0;try{for(var o,s=e.fieldTransforms[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value,c=t.data.field(u.field),l=im(u.transform,c||null);null!=l&&(null===n&&(n=Wv.empty()),n.set(u.field,l))}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n||null}function bm(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Mp(n,r,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof om&&r instanceof om||n instanceof um&&r instanceof um?Mp(n.elements,r.elements,Nv):n instanceof lm&&r instanceof lm?Nv(n.Ie,r.Ie):n instanceof am&&r instanceof am);var n,r}(e,t)}))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}var Em=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a){var o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return e(s)(this,r),(o=n.call(this)).key=t,o.value=i,o.precondition=a,o.fieldTransforms=u,o.type=0,e(Vc)(o)}return e(u)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(mm),Im=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a,o){var u,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return e(s)(this,r),(u=n.call(this)).key=t,u.data=i,u.fieldMask=a,u.precondition=o,u.fieldTransforms=c,u.type=1,e(Vc)(u)}return e(u)(r,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),r}(mm);function Tm(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function xm(e,t,n){var r=new Map;_p(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,rm(o,s,n[i]))}return r}function Cm(e,t,n){var r=new Map,i=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=c.transform,h=n.data.field(c.field);r.set(c.field,nm(l,h,t))}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return r}var Sm,Am,Rm=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).key=t,a.precondition=i,a.type=2,a.fieldTransforms=[],e(Vc)(a)}return e(u)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(mm),Nm=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).key=t,a.precondition=i,a.type=3,a.fieldTransforms=[],e(Vc)(a)}return e(u)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(mm),Om=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.batchId=n,this.localWriteTime=r,this.baseMutations=i,this.mutations=a}return e(u)(t,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&km(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=this.baseMutations[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;s.key.isEqual(e.key)&&(t=_m(s,e,t,this.localWriteTime))}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var u=!0,c=!1,l=void 0;try{for(var h,f=this.mutations[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value;d.key.isEqual(e.key)&&(t=_m(d,e,t,this.localWriteTime))}}catch(e){c=!0,l=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=Wy();return this.mutations.forEach((function(i){var a=e.get(i.key),o=a.overlayedDocument,s=n.applyToLocalView(o,a.mutatedFields),u=gm(o,s=t.has(i.key)?null:s);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Fp.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),Yy())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&Mp(this.mutations,e.mutations,(function(e,t){return bm(e,t)}))&&Mp(this.baseMutations,e.baseMutations,(function(e,t){return bm(e,t)}))}}]),t}(),Pm=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.batch=n,this.commitVersion=r,this.mutationResults=i,this.docVersions=a}return e(u)(t,null,[{key:"from",value:function(e,n,r){_p(e.mutations.length===r.length);for(var i=Gy,a=e.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new t(e,n,r,i)}}]),t}(),Dm=function(){"use strict";function t(n,r){e(s)(this,t),this.largestBatchId=n,this.mutation=r}return e(u)(t,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),t}(),Lm=function t(n,r){"use strict";e(s)(this,t),this.count=n,this.unchangedNames=r};function Mm(e){switch(e){default:return kp();case bp.CANCELLED:case bp.UNKNOWN:case bp.DEADLINE_EXCEEDED:case bp.RESOURCE_EXHAUSTED:case bp.INTERNAL:case bp.UNAVAILABLE:case bp.UNAUTHENTICATED:return!1;case bp.INVALID_ARGUMENT:case bp.NOT_FOUND:case bp.ALREADY_EXISTS:case bp.PERMISSION_DENIED:case bp.FAILED_PRECONDITION:case bp.ABORTED:case bp.OUT_OF_RANGE:case bp.UNIMPLEMENTED:case bp.DATA_LOSS:return!0}}function Um(e){if(void 0===e)return yp("GRPC error has no .code"),bp.UNKNOWN;switch(e){case Sm.OK:return bp.OK;case Sm.CANCELLED:return bp.CANCELLED;case Sm.UNKNOWN:return bp.UNKNOWN;case Sm.DEADLINE_EXCEEDED:return bp.DEADLINE_EXCEEDED;case Sm.RESOURCE_EXHAUSTED:return bp.RESOURCE_EXHAUSTED;case Sm.INTERNAL:return bp.INTERNAL;case Sm.UNAVAILABLE:return bp.UNAVAILABLE;case Sm.UNAUTHENTICATED:return bp.UNAUTHENTICATED;case Sm.INVALID_ARGUMENT:return bp.INVALID_ARGUMENT;case Sm.NOT_FOUND:return bp.NOT_FOUND;case Sm.ALREADY_EXISTS:return bp.ALREADY_EXISTS;case Sm.PERMISSION_DENIED:return bp.PERMISSION_DENIED;case Sm.FAILED_PRECONDITION:return bp.FAILED_PRECONDITION;case Sm.ABORTED:return bp.ABORTED;case Sm.OUT_OF_RANGE:return bp.OUT_OF_RANGE;case Sm.UNIMPLEMENTED:return bp.UNIMPLEMENTED;case Sm.DATA_LOSS:return bp.DATA_LOSS;default:return kp()}}(Am=Sm||(Sm={}))[Am.OK=0]="OK",Am[Am.CANCELLED=1]="CANCELLED",Am[Am.UNKNOWN=2]="UNKNOWN",Am[Am.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Am[Am.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Am[Am.NOT_FOUND=5]="NOT_FOUND",Am[Am.ALREADY_EXISTS=6]="ALREADY_EXISTS",Am[Am.PERMISSION_DENIED=7]="PERMISSION_DENIED",Am[Am.UNAUTHENTICATED=16]="UNAUTHENTICATED",Am[Am.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Am[Am.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Am[Am.ABORTED=10]="ABORTED",Am[Am.OUT_OF_RANGE=11]="OUT_OF_RANGE",Am[Am.UNIMPLEMENTED=12]="UNIMPLEMENTED",Am[Am.INTERNAL=13]="INTERNAL",Am[Am.UNAVAILABLE=14]="UNAVAILABLE",Am[Am.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Fm=null;
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bm(){return new TextEncoder}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jm=new cp([4294967295,4294967295],0);function Vm(e){var t=Bm().encode(e),n=new up;return n.update(t),new Uint8Array(n.digest())}function qm(e){var t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new cp([n,r],0),new cp([i,a],0)]}var zm=function(){"use strict";function t(n,r,i){if(e(s)(this,t),this.bitmap=n,this.padding=r,this.hashCount=i,r<0||r>=8)throw new Hm("Invalid padding: ".concat(r));if(i<0)throw new Hm("Invalid hash count: ".concat(i));if(n.length>0&&0===this.hashCount)throw new Hm("Invalid hash count: ".concat(i));if(0===n.length&&0!==r)throw new Hm("Invalid padding when bitmap length is 0: ".concat(r));this.Te=8*n.length-r,this.Ee=cp.fromNumber(this.Te)}return e(u)(t,[{key:"de",value:function(e,t,n){var r=e.add(t.multiply(cp.fromNumber(n)));return 1===r.compare(jm)&&(r=new cp([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ee).toNumber()}},{key:"Ae",value:function(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}},{key:"mightContain",value:function(t){if(0===this.Te)return!1;for(var n=Vm(t),r=e(k)(qm(n),2),i=r[0],a=r[1],o=0;o<this.hashCount;o++){var s=this.de(i,a,o);if(!this.Ae(s))return!1}return!0}},{key:"insert",value:function(t){if(0!==this.Te)for(var n=Vm(t),r=e(k)(qm(n),2),i=r[0],a=r[1],o=0;o<this.hashCount;o++){var s=this.de(i,a,o);this.Re(s)}}},{key:"Re",value:function(e){var t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}],[{key:"create",value:function(e,n,r){var i=e%8==0?0:8-e%8,a=new t(new Uint8Array(Math.ceil(e/8)),i,n);return r.forEach((function(e){return a.insert(e)})),a}}]),t}(),Hm=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){var t;return e(s)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).name="BloomFilterError",e(Vc)(t)}return r}(e(A)(Error)),Wm=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.snapshotVersion=n,this.targetChanges=r,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=o}return e(u)(t,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(e,n,r){var i=new Map;return i.set(e,Km.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(Fp.min(),i,new hv(Lp),jy(),Yy())}}]),t}(),Km=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.resumeToken=n,this.current=r,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=o}return e(u)(t,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(e,n,r){return new t(r,n,Yy(),Yy(),Yy())}}]),t}(),Gm=function t(n,r,i,a){"use strict";e(s)(this,t),this.Ve=n,this.removedTargetIds=r,this.key=i,this.me=a},Qm=function t(n,r){"use strict";e(s)(this,t),this.targetId=n,this.fe=r},Ym=function t(n,r){"use strict";var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kv.EMPTY_BYTE_STRING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e(s)(this,t),this.state=n,this.targetIds=r,this.resumeToken=i,this.cause=a},Jm=function(){"use strict";function t(){e(s)(this,t),this.ge=0,this.pe=Zm(),this.ye=kv.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}return e(u)(t,[{key:"current",get:function(){return this.we}},{key:"resumeToken",get:function(){return this.ye}},{key:"be",get:function(){return 0!==this.ge}},{key:"De",get:function(){return this.Se}},{key:"Ce",value:function(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}},{key:"ve",value:function(){var e=Yy(),t=Yy(),n=Yy();return this.pe.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:kp()}})),new Km(this.ye,this.we,e,t,n)}},{key:"Fe",value:function(){this.Se=!1,this.pe=Zm()}},{key:"Me",value:function(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}},{key:"xe",value:function(e){this.Se=!0,this.pe=this.pe.remove(e)}},{key:"Oe",value:function(){this.ge+=1}},{key:"Ne",value:function(){this.ge-=1}},{key:"Be",value:function(){this.Se=!0,this.we=!0}}]),t}(),Xm=function(){"use strict";function t(n){e(s)(this,t),this.Le=n,this.ke=new Map,this.qe=jy(),this.Qe=$m(),this.Ke=new hv(Lp)}return e(u)(t,[{key:"$e",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.Ve[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;e.me&&e.me.isFoundDocument()?this.Ue(o,e.me):this.We(o,e.key,e.me)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var s=!0,u=!1,c=void 0;try{for(var l,h=e.removedTargetIds[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;this.We(f,e.key,e.me)}}catch(e){u=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}}},{key:"Ge",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.ze(n);switch(e.state){case 0:t.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||t.removeTarget(n);break;case 3:t.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:t.je(n)&&(t.He(n),r.Ce(e.resumeToken));break;default:kp()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((function(e,r){n.je(r)&&t(r)}))}},{key:"Je",value:function(e){var t=e.targetId,n=e.fe.count,r=this.Ye(t);if(r){var i=r.target;if(_y(i))if(0===n){var a=new zp(i.path);this.We(t,a,Gv.newNoDocument(a,Fp.min()))}else _p(1===n);else{var o=this.Ze(t);if(o!==n){var s=this.Xe(e),u=s?this.et(s,e,o):1;if(0!==u){this.He(t);var c=2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,c)}null==Fm||Fm.tt(function(e,t,n,r,i){var a,o,s,u,c,l,h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},f=t.unchangedNames;return f&&(h.bloomFilter={applied:0===i,hashCount:null!==(a=null==f?void 0:f.hashCount)&&void 0!==a?a:0,bitmapLength:null!==(u=null===(s=null===(o=null==f?void 0:f.bits)||void 0===o?void 0:o.bitmap)||void 0===s?void 0:s.length)&&void 0!==u?u:0,padding:null!==(l=null===(c=null==f?void 0:f.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:function(e){var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(o,e.fe,this.Le.nt(),s,u))}}}}},{key:"Xe",value:function(e){var t=e.fe.unchangedNames;if(!t||!t.bits)return null;var n,r,i=t.bits,a=i.bitmap,o=void 0===a?"":a,s=i.padding,u=void 0===s?0:s,c=t.hashCount,l=void 0===c?0:c;try{n=Ev(o).toUint8Array()}catch(e){if(e instanceof mv)return mp("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{r=new zm(n,u,l)}catch(e){return mp(e instanceof Hm?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===r.Te?null:r}},{key:"et",value:function(e,t,n){return t.fe.count===n-this.rt(e,t.targetId)?0:2}},{key:"rt",value:function(e,t){var n=this,r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach((function(r){var a=n.Le.nt(),o="projects/".concat(a.projectId,"/databases/").concat(a.database,"/documents/").concat(r.path.canonicalString());e.mightContain(o)||(n.We(t,r,null),i++)})),i}},{key:"it",value:function(e){var t=this,n=new Map;this.ke.forEach((function(r,i){var a=t.Ye(i);if(a){if(r.current&&_y(a.target)){var o=new zp(a.target.path);null!==t.qe.get(o)||t.st(i,o)||t.We(i,o,Gv.newNoDocument(o,e))}r.De&&(n.set(i,r.ve()),r.Fe())}}));var r=Yy();this.Qe.forEach((function(e,n){var i=t,a=!0;n.forEachWhile((function(e){var t=i.Ye(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(a=!1,!1)})),a&&(r=r.add(e))})),this.qe.forEach((function(t,n){return n.setReadTime(e)}));var i=new Wm(e,n,this.Ke,this.qe,r);return this.qe=jy(),this.Qe=$m(),this.Ke=new hv(Lp),i}},{key:"Ue",value:function(e,t){if(this.je(e)){var n=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,n),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}}},{key:"We",value:function(e,t,n){if(this.je(e)){var r=this.ze(e);this.st(e,t)?r.Me(t,1):r.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),n&&(this.qe=this.qe.insert(t,n))}}},{key:"removeTarget",value:function(e){this.ke.delete(e)}},{key:"Ze",value:function(e){var t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Oe",value:function(e){this.ze(e).Oe()}},{key:"ze",value:function(e){var t=this.ke.get(e);return t||(t=new Jm,this.ke.set(e,t)),t}},{key:"ot",value:function(e){var t=this.Qe.get(e);return t||(t=new pv(Lp),this.Qe=this.Qe.insert(e,t)),t}},{key:"je",value:function(e){var t=null!==this.Ye(e);return t||vp("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Ye",value:function(e){var t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}},{key:"He",value:function(e){var t=this;this.ke.set(e,new Jm),this.Le.getRemoteKeysForTarget(e).forEach((function(n){t.We(e,n,null)}))}},{key:"st",value:function(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}]),t}();function $m(){return new hv(zp.comparator)}function Zm(){return new hv(zp.comparator)}var eg={asc:"ASCENDING",desc:"DESCENDING"},tg={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ng={and:"AND",or:"OR"},rg=function t(n,r){"use strict";e(s)(this,t),this.databaseId=n,this.useProto3Json=r};function ig(e,t){return e.useProto3Json||nv(t)?t:{value:t}}function ag(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function og(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function sg(e,t){return ag(e,t.toTimestamp())}function ug(e){return _p(!!e),Fp.fromTimestamp((t=wv(e),new Up(t.seconds,t.nanos)));var t}function cg(e,t){return(n=e,new jp(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function lg(e){var t=jp.fromString(e);return _p(Sg(t)),t}function hg(e,t){return cg(e.databaseId,t.path)}function fg(e,t){var n=lg(t);if(n.get(1)!==e.databaseId.projectId)throw new Ep(bp.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ep(bp.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new zp(yg(n))}function dg(e,t){return cg(e.databaseId,t)}function pg(e){var t=lg(e);return 4===t.length?jp.emptyPath():yg(t)}function vg(e){return new jp(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function yg(e){return _p(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function mg(e,t,n){return{name:hg(e,t),fields:n.value.mapValue.fields}}function gg(e,t){var n,r,i;if(t instanceof Em)n={update:mg(e,t.key,t.value)};else if(t instanceof Rm)n={delete:hg(e,t.key)};else if(t instanceof Im)n={update:mg(e,t.key,t.data),updateMask:(r=t.fieldMask,i=[],r.fields.forEach((function(e){return i.push(e.canonicalString())})),{fieldPaths:i})};else{if(!(t instanceof Nm))return kp();n={verify:hg(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof am)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof om)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof um)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof lm)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw kp()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:sg(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:kp()}(e,t.precondition)),n}function kg(e,t){return{documents:[dg(e,t.path)]}}function _g(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=dg(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=dg(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length)return Cg(ty.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map((function(e){return{field:Tg((t=e).field),direction:Eg(t.dir)};var t}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s=ig(e,t.limit);return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function wg(e){var t=pg(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){_p(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o,s,u=[];n.where&&(o=n.where,u=(s=bg(o))instanceof ty&&ry(s)?s.getFilters():[s]);var c=[];n.orderBy&&(c=n.orderBy.map((function(e){return new Xv(xg((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t})));var l=null;n.limit&&(l=function(e){var t;return nv(t="object"==typeof e?e.value:e)?null:t}(n.limit));var h=null;n.startAt&&(h=function(e){var t=!!e.before,n=e.values||[];return new Qv(n,t)}(n.startAt));var f=null;return n.endAt&&(f=function(e){var t=!e.before,n=e.values||[];return new Qv(n,t)}(n.endAt)),by(t,i,c,u,l,"F",h,f)}function bg(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=xg(e.unaryFilter.field);return ey.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=xg(e.unaryFilter.field);return ey.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=xg(e.unaryFilter.field);return ey.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=xg(e.unaryFilter.field);return ey.create(i,"!=",{nullValue:"NULL_VALUE"});default:return kp()}}(e):void 0!==e.fieldFilter?(n=e,ey.create(xg(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return kp()}}(n.fieldFilter.op),n.fieldFilter.value)):void 0!==e.compositeFilter?(t=e,ty.create(t.compositeFilter.filters.map((function(e){return bg(e)})),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return kp()}}(t.compositeFilter.op))):kp();var t,n}function Eg(e){return eg[e]}function Ig(e){return tg[e]}function Tg(e){return{fieldPath:e.canonicalString()}}function xg(e){return qp.fromServerFormat(e.fieldPath)}function Cg(e){return e instanceof ey?function(e){if("=="===e.op){if(Vv(e.value))return{unaryFilter:{field:Tg(e.field),op:"IS_NAN"}};if(jv(e.value))return{unaryFilter:{field:Tg(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Vv(e.value))return{unaryFilter:{field:Tg(e.field),op:"IS_NOT_NAN"}};if(jv(e.value))return{unaryFilter:{field:Tg(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Tg(e.field),op:Ig(e.op),value:e.value}}}(e):e instanceof ty?(r=(t=e).getFilters().map((function(e){return Cg(e)})),1===r.length?r[0]:{compositeFilter:{op:(n=t.op,ng[n]),filters:r}}):kp();var t,n,r}function Sg(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ag=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fp.min(),u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Fp.min(),c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:kv.EMPTY_BYTE_STRING,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;e(s)(this,t),this.target=n,this.targetId=r,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=c,this.expectedCount=l}return e(u)(t,[{key:"withSequenceNumber",value:function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}},{key:"withResumeToken",value:function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}},{key:"withExpectedCount",value:function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}},{key:"withLastLimboFreeSnapshotVersion",value:function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}]),t}(),Rg=function t(n){"use strict";e(s)(this,t),this.ut=n};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ng(e){var t=wg({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Ry(t,t.limit,"L"):t}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Og=function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,[{key:"ht",value:function(e,t){this.Pt(e,t),t.It()}},{key:"Pt",value:function(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(bv(e.integerValue));else if("doubleValue"in e){var n=bv(e.doubleValue);isNaN(n)?this.Tt(t,13):(this.Tt(t,15),rv(n)?t.Et(0):t.Et(n))}else if("timestampValue"in e){var r=e.timestampValue;this.Tt(t,20),"string"==typeof r?t.dt(r):(t.dt("".concat(r.seconds||"")),t.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(Ev(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.Tt(t,45),t.Et(i.latitude||0),t.Et(i.longitude||0)}else"mapValue"in e?Hv(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):kp()}},{key:"At",value:function(e,t){this.Tt(t,25),this.wt(e,t)}},{key:"wt",value:function(e,t){t.dt(e)}},{key:"gt",value:function(e,t){var n=e.fields||{};this.Tt(t,55);var r=!0,i=!1,a=void 0;try{for(var o,s=Object.keys(n)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;this.At(u,t),this.Pt(n[u],t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"yt",value:function(e,t){var n=e.values||[];this.Tt(t,50);var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;this.Pt(u,t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"ft",value:function(e,t){var n=this;this.Tt(t,37),zp.fromName(e).path.forEach((function(e){n.Tt(t,60),n.wt(e,t)}))}},{key:"Tt",value:function(e,t){e.Et(t)}},{key:"Rt",value:function(e){e.Et(2)}}]),t}();Og.St=new Og;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Pg=function(){"use strict";function t(){e(s)(this,t),this.on=new Dg}return e(u)(t,[{key:"addToCollectionParentIndex",value:function(e,t){return this.on.add(t),Zp.resolve()}},{key:"getCollectionParents",value:function(e,t){return Zp.resolve(this.on.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Zp.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Zp.resolve()}},{key:"deleteAllFieldIndexes",value:function(e){return Zp.resolve()}},{key:"createTargetIndexes",value:function(e,t){return Zp.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Zp.resolve(null)}},{key:"getIndexType",value:function(e,t){return Zp.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Zp.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Zp.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Zp.resolve(Gp.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Zp.resolve(Gp.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Zp.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Zp.resolve()}}]),t}(),Dg=function(){"use strict";function t(){e(s)(this,t),this.index={}}return e(u)(t,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new pv(jp.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new pv(jp.comparator)).toArray()}}]),t}();new Uint8Array(0);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Lg=function(){"use strict";function t(n,r,i){e(s)(this,t),this.cacheSizeCollectionThreshold=n,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=i}return e(u)(t,null,[{key:"withCacheSize",value:function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Lg.DEFAULT_COLLECTION_PERCENTILE=10,Lg.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Lg.DEFAULT=new Lg(41943040,Lg.DEFAULT_COLLECTION_PERCENTILE,Lg.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Lg.DISABLED=new Lg(-1,0,0);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Mg=function(){"use strict";function t(n){e(s)(this,t),this.xn=n}return e(u)(t,[{key:"next",value:function(){return this.xn+=2,this.xn}}],[{key:"On",value:function(){return new t(0)}},{key:"Nn",value:function(){return new t(-1)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ug=function(){"use strict";function t(){e(s)(this,t),this.changes=new Fy((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return e(u)(t,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,Gv.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Zp.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Fg=function t(n,r){"use strict";e(s)(this,t),this.overlayedDocument=n,this.mutatedFields=r},Bg=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.remoteDocumentCache=n,this.mutationQueue=r,this.documentOverlayCache=i,this.indexManager=a}return e(u)(t,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(i){return r=i,n.remoteDocumentCache.getEntry(e,t)})).next((function(e){return null!==r&&_m(r.mutation,e,yv.empty(),Up.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,Yy()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Yy(),r=this,i=Hy();return this.populateOverlays(e,i,t).next((function(){return r.computeViews(e,t,i,n).next((function(e){var t=qy();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=Hy();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,Yy())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var i=jy(),a=Ky(),o=Ky();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Im)?i=i.insert(t.key,t):void 0!==o?(a.set(t.key,o.mutation.getFieldMask()),_m(o.mutation,t,o.mutation.getFieldMask(),Up.now())):a.set(t.key,yv.empty())})),this.recalculateAndSaveOverlays(e,i).next((function(e){return e.forEach((function(e,t){return a.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new Fg(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=Ky(),i=new hv((function(e,t){return e-t})),a=Yy();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n=!0,a=!1,o=void 0;try{for(var s,u=function(e,n){var a=n.value;a.keys().forEach((function(e){var n=t.get(e);if(null!==n){var o=r.get(e)||yv.empty();o=a.applyToLocalView(n,o),r.set(e,o);var s=(i.get(a.batchId)||Yy()).add(e);i=i.insert(a.batchId,s)}}))},c=e[Symbol.iterator]();!(n=(s=c.next()).done);n=!0)u(0,s)}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}})).next((function(){for(var o=[],s=i.getReverseIterator();s.hasNext();){var u=s.getNext(),c=u.key,l=u.value,h=Wy();l.forEach((function(e){if(!a.has(e)){var n=gm(t.get(e),r.get(e));null!==n&&h.set(e,n),a=a.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,c,h))}return Zp.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){return i=t,zp.isDocumentKey(i.path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Ty(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r);var i}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(a){var o=i,s=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Zp.resolve(Hy()),u=-1,c=a;return s.next((function(t){return Zp.forEach(t,(function(t,n){return u<n.largestBatchId&&(u=n.largestBatchId),a.get(t)?Zp.resolve():o.remoteDocumentCache.getEntry(e,t).next((function(e){c=c.insert(t,e)}))})).next((function(){return o.populateOverlays(e,t,a)})).next((function(){return o.computeViews(e,c,t,Yy())})).next((function(e){return{batchId:u,changes:zy(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new zp(t)).next((function(e){var t=qy();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n,r){var i=this,a=t.collectionGroup,o=qy();return this.indexManager.getCollectionParents(e,a).next((function(s){return Zp.forEach(s,(function(s){var u,c,l=(u=t,c=s.child(a),new wy(c,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt));return i.getDocumentsMatchingCollectionQuery(e,l,n,r).next((function(e){e.forEach((function(e,t){o=o.insert(e,t)}))}))})).next((function(){return o}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n,r){var i,a=this;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((function(o){return i=o,a.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)})).next((function(e){i.forEach((function(t,n){var r=n.getKey();null===e.get(r)&&(e=e.insert(r,Gv.newInvalidDocument(r)))}));var n=qy();return e.forEach((function(e,r){var a=i.get(e);void 0!==a&&_m(a.mutation,r,yv.empty(),Up.now()),Dy(t,r)&&(n=n.insert(e,r))})),n}))}}]),t}(),jg=function(){"use strict";function t(n){e(s)(this,t),this.serializer=n,this.ur=new Map,this.cr=new Map}return e(u)(t,[{key:"getBundleMetadata",value:function(e,t){return Zp.resolve(this.ur.get(t))}},{key:"saveBundleMetadata",value:function(e,t){return this.ur.set(t.id,{id:(n=t).id,version:n.version,createTime:ug(n.createTime)}),Zp.resolve();var n}},{key:"getNamedQuery",value:function(e,t){return Zp.resolve(this.cr.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.cr.set(t.name,{name:(n=t).name,query:Ng(n.bundledQuery),readTime:ug(n.readTime)}),Zp.resolve();var n}}]),t}(),Vg=function(){"use strict";function t(){e(s)(this,t),this.overlays=new hv(zp.comparator),this.lr=new Map}return e(u)(t,[{key:"getOverlay",value:function(e,t){return Zp.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=Hy();return Zp.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,i){r.lt(e,t,i)})),Zp.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.lr.get(n);return void 0!==i&&(i.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.lr.delete(n)),Zp.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=Hy(),i=t.length+1,a=new zp(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&s.largestBatchId>n&&r.set(s.getKey(),s)}return Zp.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new hv((function(e,t){return e-t})),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=i.get(o.largestBatchId);null===s&&(s=Hy(),i=i.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=Hy(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return u.set(e,t)})),!(u.size()>=r)););return Zp.resolve(u)}},{key:"lt",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.lr.get(r.largestBatchId).delete(n.key);this.lr.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new Dm(t,n));var a=this.lr.get(t);void 0===a&&(a=Yy(),this.lr.set(t,a)),this.lr.set(t,a.add(n.key))}}]),t}(),qg=function(){"use strict";function t(){e(s)(this,t),this.hr=new pv(zg.Pr),this.Ir=new pv(zg.Tr)}return e(u)(t,[{key:"isEmpty",value:function(){return this.hr.isEmpty()}},{key:"addReference",value:function(e,t){var n=new zg(e,t);this.hr=this.hr.add(n),this.Ir=this.Ir.add(n)}},{key:"Er",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.dr(new zg(e,t))}},{key:"Ar",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"Rr",value:function(e){var t=this,n=new zp(new jp([])),r=new zg(n,e),i=new zg(n,e+1),a=[];return this.Ir.forEachInRange([r,i],(function(e){t.dr(e),a.push(e.key)})),a}},{key:"Vr",value:function(){var e=this;this.hr.forEach((function(t){return e.dr(t)}))}},{key:"dr",value:function(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}},{key:"mr",value:function(e){var t=new zp(new jp([])),n=new zg(t,e),r=new zg(t,e+1),i=Yy();return this.Ir.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i}},{key:"containsKey",value:function(e){var t=new zg(e,0),n=this.hr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),t}(),zg=function(){"use strict";function t(n,r){e(s)(this,t),this.key=n,this.gr=r}return e(u)(t,null,[{key:"Pr",value:function(e,t){return zp.comparator(e.key,t.key)||Lp(e.gr,t.gr)}},{key:"Tr",value:function(e,t){return Lp(e.gr,t.gr)||zp.comparator(e.key,t.key)}}]),t}(),Hg=function(){"use strict";function t(n,r){e(s)(this,t),this.indexManager=n,this.referenceDelegate=r,this.mutationQueue=[],this.pr=1,this.yr=new pv(zg.Pr)}return e(u)(t,[{key:"checkEmpty",value:function(e){return Zp.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new Om(i,t,n,r);this.mutationQueue.push(a);var o=!0,s=!1,u=void 0;try{for(var c,l=r[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;this.yr=this.yr.add(new zg(h.key,i)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast())}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return Zp.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Zp.resolve(this.wr(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.Sr(n),i=r<0?0:r;return Zp.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Zp.resolve(0===this.mutationQueue.length?-1:this.pr-1)}},{key:"getAllMutationBatches",value:function(e){return Zp.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new zg(t,0),i=new zg(t,Number.POSITIVE_INFINITY),a=[];return this.yr.forEachInRange([r,i],(function(e){var t=n.wr(e.gr);a.push(t)})),Zp.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new pv(Lp);return t.forEach((function(e){var t=new zg(e,0),i=new zg(e,Number.POSITIVE_INFINITY);n.yr.forEachInRange([t,i],(function(e){r=r.add(e.gr)}))})),Zp.resolve(this.br(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;zp.isDocumentKey(i)||(i=i.child(""));var a=new zg(new zp(i),0),o=new pv(Lp);return this.yr.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.gr)),!0)}),a),Zp.resolve(this.br(o))}},{key:"br",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.wr(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;_p(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();var r=this.yr;return Zp.forEach(t.mutations,(function(i){var a=new zg(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.yr=r}))}},{key:"Fn",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new zg(t,0),r=this.yr.firstAfterOrEqual(n);return Zp.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,Zp.resolve()}},{key:"Dr",value:function(e,t){return this.Sr(e)}},{key:"Sr",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"wr",value:function(e){var t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),t}(),Wg=function(){"use strict";function t(n){e(s)(this,t),this.Cr=n,this.docs=new hv(zp.comparator),this.size=0}return e(u)(t,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.Cr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Zp.resolve(n?n.document.mutableCopy():Gv.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=jy();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():Gv.newInvalidDocument(e))})),Zp.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){for(var i=jy(),a=t.path,o=new zp(a.child("")),s=this.docs.getIteratorFrom(o);s.hasNext();){var u=s.getNext(),c=u.key,l=u.value.document;if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Qp(Kp(l),n)<=0||(r.has(l.key)||Dy(t,l))&&(i=i.insert(l.key,l.mutableCopy()))}return Zp.resolve(i)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){kp()}},{key:"vr",value:function(e,t){return Zp.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new Kg(this)}},{key:"getSize",value:function(e){return Zp.resolve(this.size)}}]),t}(),Kg=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this))._r=t,e(Vc)(i)}return e(u)(r,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(t._r.addEntry(e,i)):t._r.removeEntry(r)})),Zp.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this._r.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this._r.getEntries(e,t)}}]),r}(Ug),Gg=function(){"use strict";function t(n){e(s)(this,t),this.persistence=n,this.Fr=new Fy((function(e){return gy(e)}),ky),this.lastRemoteSnapshotVersion=Fp.min(),this.highestTargetId=0,this.Mr=0,this.Or=new qg,this.targetCount=0,this.Nr=Mg.On()}return e(u)(t,[{key:"forEachTarget",value:function(e,t){return this.Fr.forEach((function(e,n){return t(n)})),Zp.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Zp.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Zp.resolve(this.Mr)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Nr.next(),Zp.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Mr&&(this.Mr=t),Zp.resolve()}},{key:"kn",value:function(e){this.Fr.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Nr=new Mg(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.kn(t),this.targetCount+=1,Zp.resolve()}},{key:"updateTargetData",value:function(e,t){return this.kn(t),Zp.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,Zp.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Fr.forEach((function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Fr.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)})),Zp.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(e){return Zp.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Fr.get(t)||null;return Zp.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Or.Er(t,n),Zp.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Or.Ar(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),Zp.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Or.Rr(t),Zp.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Or.mr(t);return Zp.resolve(n)}},{key:"containsKey",value:function(e,t){return Zp.resolve(this.Or.containsKey(t))}}]),t}(),Qg=function(){"use strict";function t(n,r){var i=this;e(s)(this,t),this.Br={},this.overlays={},this.Lr=new tv(0),this.kr=!1,this.kr=!0,this.referenceDelegate=n(this),this.qr=new Gg(this),this.indexManager=new Pg,this.remoteDocumentCache=new Wg((function(e){return i.referenceDelegate.Qr(e)})),this.serializer=new Rg(r),this.Kr=new jg(this.serializer)}return e(u)(t,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.kr=!1,Promise.resolve()}},{key:"started",get:function(){return this.kr}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new Vg,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Br[e.toKey()];return n||(n=new Hg(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.qr}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Kr}},{key:"runTransaction",value:function(e,t,n){var r=this;vp("MemoryPersistence","Starting transaction:",e);var i=new Yg(this.Lr.next());return this.referenceDelegate.$r(),n(i).next((function(e){return r.referenceDelegate.Ur(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"Wr",value:function(e,t){return Zp.or(Object.values(this.Br).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),t}(),Yg=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).currentSequenceNumber=t,e(Vc)(i)}return r}(Jp),Jg=function(){"use strict";function t(n){e(s)(this,t),this.persistence=n,this.Gr=new qg,this.zr=null}return e(u)(t,[{key:"Hr",get:function(){if(this.zr)return this.zr;throw kp()}},{key:"addReference",value:function(e,t,n){return this.Gr.addReference(n,t),this.Hr.delete(n.toString()),Zp.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Gr.removeReference(n,t),this.Hr.add(n.toString()),Zp.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Hr.add(t.toString()),Zp.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Gr.Rr(t.targetId).forEach((function(e){return n.Hr.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){var t=n;e.forEach((function(e){return t.Hr.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"$r",value:function(){this.zr=new Set}},{key:"Ur",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Zp.forEach(this.Hr,(function(r){var i=zp.fromPath(r);return t.Jr(e,i).next((function(e){e||n.removeEntry(i,Fp.min())}))})).next((function(){return t.zr=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.Jr(e,t).next((function(e){e?n.Hr.delete(t.toString()):n.Hr.add(t.toString())}))}},{key:"Qr",value:function(e){return 0}},{key:"Jr",value:function(e,t){var n=this;return Zp.or([function(){return Zp.resolve(n.Gr.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Wr(e,t)}])}}],[{key:"jr",value:function(e){return new t(e)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Xg=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.targetId=n,this.fromCache=r,this.ki=i,this.qi=a}return e(u)(t,null,[{key:"Qi",value:function(e,n){var r=Yy(),i=Yy(),a=!0,o=!1,s=void 0;try{for(var u,c=n.docChanges[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:i=i.add(l.doc.key)}}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}return new t(e,n.fromCache,r,i)}}]),t}(),$g=function(){"use strict";function t(){e(s)(this,t),this._documentReadCount=0}return e(u)(t,[{key:"documentReadCount",get:function(){return this._documentReadCount}},{key:"incrementDocumentReadCount",value:function(e){this._documentReadCount+=e}}]),t}(),Zg=function(){"use strict";function t(){e(s)(this,t),this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}return e(u)(t,[{key:"initialize",value:function(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this,a={result:null};return this.zi(e,t).next((function(e){a.result=e})).next((function(){if(!a.result)return i.ji(e,t,r,n).next((function(e){a.result=e}))})).next((function(){var n=i;if(!a.result){var r=new $g;return i.Hi(e,t,r).next((function(i){if(a.result=i,n.$i)return n.Ji(e,t,r,i.size)}))}})).next((function(){return a.result}))}},{key:"Ji",value:function(e,t,n,r){return n.documentReadCount<this.Ui?(pp()<=ot.DEBUG&&vp("QueryEngine","SDK will not create cache indexes for query:",Py(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),Zp.resolve()):(pp()<=ot.DEBUG&&vp("QueryEngine","Query:",Py(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Wi*r?(pp()<=ot.DEBUG&&vp("QueryEngine","The SDK decides to create cache indexes for query:",Py(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Cy(t))):Zp.resolve())}},{key:"zi",value:function(t,n){var r=this;if(Iy(n))return Zp.resolve(null);var i=Cy(n);return this.indexManager.getIndexType(t,i).next((function(a){return 0===a?null:(null!==n.limit&&1===a&&(n=Ry(n,null,"F"),i=Cy(n)),r.indexManager.getDocumentsMatchingTarget(t,i).next((function(a){var o=r,s=Yy.apply(void 0,e(h)(a));return r.Gi.getDocuments(t,s).next((function(e){return o.indexManager.getMinOffset(t,i).next((function(r){var i=o.Yi(n,e);return o.Zi(n,i,s,r.readTime)?o.zi(t,Ry(n,null,"F")):o.Xi(t,i,n,r)}))}))})))}))}},{key:"ji",value:function(e,t,n,r){var i=this;return Iy(t)||r.isEqual(Fp.min())?Zp.resolve(null):this.Gi.getDocuments(e,n).next((function(a){var o=i.Yi(t,a);return i.Zi(t,o,n,r)?Zp.resolve(null):(pp()<=ot.DEBUG&&vp("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Py(t)),i.Xi(e,o,t,Wp(r,-1)).next((function(e){return e})))}))}},{key:"Yi",value:function(e,t){var n=new pv(My(e));return t.forEach((function(t,r){Dy(e,r)&&(n=n.add(r))})),n}},{key:"Zi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Hi",value:function(e,t,n){return pp()<=ot.DEBUG&&vp("QueryEngine","Using full collection scan to execute query:",Py(t)),this.Gi.getDocumentsMatchingQuery(e,t,Gp.min(),n)}},{key:"Xi",value:function(e,t,n,r){return this.Gi.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),t}(),ek=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.persistence=n,this.es=r,this.serializer=a,this.ts=new hv(Lp),this.ns=new Fy((function(e){return gy(e)}),ky),this.rs=new Map,this.ss=n.getRemoteDocumentCache(),this.qr=n.getTargetCache(),this.Kr=n.getBundleCache(),this.os(i)}return e(u)(t,[{key:"os",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Bg(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.ts)}))}}]),t}();
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tk(e,t,n,r){return new ek(e,t,n,r)}function nk(e,t){return rk.apply(this,arguments)}function rk(){return(rk=e(a)(e(m).mark((function t(n,r){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=wp(n),e.next=3,i.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return i.mutationQueue.getAllMutationBatches(e).next((function(n){return t=n,i.os(r),i.mutationQueue.getAllMutationBatches(e)})).next((function(n){var r=[],a=[],o=Yy(),s=!0,u=!1,c=void 0;try{for(var l,h=t[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;r.push(f.batchId);var d=!0,p=!1,v=void 0;try{for(var y,m=f.mutations[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var g=y.value;o=o.add(g.key)}}catch(e){p=!0,v=e}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}}}catch(e){u=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}var k=!0,_=!1,w=void 0;try{for(var b,E=n[Symbol.iterator]();!(k=(b=E.next()).done);k=!0){var I=b.value;a.push(I.batchId);var T=!0,x=!1,C=void 0;try{for(var S,A=I.mutations[Symbol.iterator]();!(T=(S=A.next()).done);T=!0){var R=S.value;o=o.add(R.key)}}catch(e){x=!0,C=e}finally{try{T||null==A.return||A.return()}finally{if(x)throw C}}}}catch(e){_=!0,w=e}finally{try{k||null==E.return||E.return()}finally{if(_)throw w}}return i.localDocuments.getDocuments(e,o).next((function(e){return{_s:e,removedBatchIds:r,addedBatchIds:a}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ik(e,t){var n=wp(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r,i,a,o,s,u,c,l=t.batch.keys(),h=n.ss.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,o=h,s=a.batch,u=s.keys(),c=Zp.resolve(),u.forEach((function(e){c=c.next((function(){return o.getEntry(i,e)})).next((function(t){var n=a.docVersions.get(e);_p(null!==n),t.version.compareTo(n)<0&&(s.applyToRemoteDocument(t,a),t.isValidDocument()&&(t.setReadTime(a.commitVersion),o.addEntry(t)))}))})),c.next((function(){return r.mutationQueue.removeMutationBatch(i,s)}))).next((function(){return h.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,l,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=Yy(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,l)}))}))}function ak(e){var t=wp(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.qr.getLastRemoteSnapshotVersion(e)}))}function ok(e,t){var n=wp(e),r=t.snapshotVersion,i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var a=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;var o=[];t.targetChanges.forEach((function(a,s){var u=i.get(s);if(u){o.push(n.qr.removeMatchingKeys(e,a.removedDocuments,s).next((function(){return n.qr.addMatchingKeys(e,a.addedDocuments,s)})));var c,l,h,f=u.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(s)?f=f.withResumeToken(kv.EMPTY_BYTE_STRING,Fp.min()).withLastLimboFreeSnapshotVersion(Fp.min()):a.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(a.resumeToken,r)),i=i.insert(s,f),l=f,h=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&o.push(n.qr.updateTargetData(e,f))}}));var s=jy(),u=Yy();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(sk(e,a,t.documentUpdates).next((function(e){s=e.us,u=e.cs}))),!r.isEqual(Fp.min())){var c=n.qr.getLastRemoteSnapshotVersion(e).next((function(t){return n.qr.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return Zp.waitFor(o).next((function(){return a.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)})).next((function(){return s}))})).then((function(e){return n.ts=i,e}))}function sk(e,t,n){var r=Yy(),i=Yy();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=jy();return n.forEach((function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(Fp.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):vp("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)})),{us:r,cs:i}}))}function uk(e,t){var n=wp(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function ck(e,t){var n=wp(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.qr.getTargetData(e,t).next((function(i){return i?(r=i,Zp.resolve(r)):n.qr.allocateTargetId(e).next((function(i){return r=new Ag(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.qr.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.ts.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ts=n.ts.insert(e.targetId,e),n.ns.set(t,e.targetId)),e}))}function lk(e,t,n){return hk.apply(this,arguments)}function hk(){return(hk=e(a)(e(m).mark((function t(n,r,i){var a,o,s;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=wp(n),o=a.ts.get(r),s=i?"readwrite":"readwrite-primary",e.prev=1,e.t0=i,e.t0){e.next=6;break}return e.next=6,a.persistence.runTransaction("Release target",s,(function(e){return a.persistence.referenceDelegate.removeTarget(e,o)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),ev(e.t1)){e.next=12;break}throw e.t1;case 12:vp("LocalStore","Failed to update sequence numbers for target ".concat(r,": ").concat(e.t1));case 13:a.ts=a.ts.remove(r),a.ns.delete(o.target);case 14:case"end":return e.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}function fk(e,t,n){var r=wp(e),i=Fp.min(),a=Yy();return r.persistence.runTransaction("Execute query","readwrite",(function(e){return(o=r,s=e,u=Cy(t),c=wp(o),l=c.ns.get(u),void 0!==l?Zp.resolve(c.ts.get(l)):c.qr.getTargetData(s,u)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(e,t.targetId).next((function(e){a=e}))})).next((function(){return r.es.getDocumentsMatchingQuery(e,t,n?i:Fp.min(),n?a:Yy())})).next((function(e){return dk(r,Ly(t),e),{documents:e,ls:a}}));var o,s,u,c,l}))}function dk(e,t,n){var r=e.rs.get(t)||Fp.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.rs.set(t,r)}var pk=function(){"use strict";function t(){e(s)(this,t),this.activeTargetIds=Xy()}return e(u)(t,[{key:"ds",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"As",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Es",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),t}(),vk=function(){"use strict";function t(){e(s)(this,t),this.eo=new pk,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e(u)(t,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.eo.ds(e),this.no[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.no[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.eo.As(e)}},{key:"isLocalQueryTarget",value:function(e){return this.eo.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.no[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.eo.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.eo.activeTargetIds.has(e)}},{key:"start",value:function(){return this.eo=new pk,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),t}(),yk=function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,[{key:"ro",value:function(e){}},{key:"shutdown",value:function(){}}]),t}(),mk=function(){"use strict";function t(){var n=this;e(s)(this,t),this.io=function(){return n.so()},this.oo=function(){return n._o()},this.ao=[],this.uo()}return e(u)(t,[{key:"ro",value:function(e){this.ao.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}},{key:"uo",value:function(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}},{key:"so",value:function(){vp("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e=!0,t=!1,n=void 0;try{for(var r,i=this.ao[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)(0)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"_o",value:function(){vp("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e=!0,t=!1,n=void 0;try{for(var r,i=this.ao[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)(1)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}}],[{key:"D",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),t}(),gk=null;function kk(){return null===gk?gk=268435456+Math.round(2147483648*Math.random()):gk++,"0x"+gk.toString(16)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var _k={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},wk=function(){"use strict";function t(n){e(s)(this,t),this.co=n.co,this.lo=n.lo}return e(u)(t,[{key:"ho",value:function(e){this.Po=e}},{key:"Io",value:function(e){this.To=e}},{key:"onMessage",value:function(e){this.Eo=e}},{key:"close",value:function(){this.lo()}},{key:"send",value:function(e){this.co(e)}},{key:"Ao",value:function(){this.Po()}},{key:"Ro",value:function(e){this.To(e)}},{key:"Vo",value:function(e){this.Eo(e)}}]),t}(),bk="WebChannelConnection",Ek=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this,t)).forceLongPolling=t.forceLongPolling,i.autoDetectLongPolling=t.autoDetectLongPolling,i.useFetchStreams=t.useFetchStreams,i.longPollingOptions=t.longPollingOptions,e(Vc)(i)}return e(u)(r,[{key:"Do",value:function(e,t,n,r){var i=kk();return new Promise((function(a,o){var s=new sp;s.setWithCredentials(!0),s.listenOnce(np.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case tp.NO_ERROR:var t=s.getResponseJson();vp(bk,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),a(t);break;case tp.TIMEOUT:vp(bk,"RPC '".concat(e,"' ").concat(i," timed out")),o(new Ep(bp.DEADLINE_EXCEEDED,"Request time out"));break;case tp.HTTP_ERROR:var n=s.getStatus();if(vp(bk,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson();Array.isArray(r)&&(r=r[0]);var u=null==r?void 0:r.error;if(u&&u.status&&u.message){var c=(l=u.status,h=l.toLowerCase().replace(/_/g,"-"),Object.values(bp).indexOf(h)>=0?h:bp.UNKNOWN);o(new Ep(c,u.message))}else o(new Ep(bp.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Ep(bp.UNAVAILABLE,"Connection failed."));break;default:kp()}}finally{vp(bk,"RPC '".concat(e,"' ").concat(i," completed."))}var l,h}));var u=JSON.stringify(r);vp(bk,"RPC '".concat(e,"' ").concat(i," sending request:"),r),s.send(t,"POST",u,n,15)}))}},{key:"vo",value:function(e,t,n){var r=kk(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Zd(),o=ep(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(s.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(s.xmlHttpFactory=new ap({})),this.bo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;var c=i.join("");vp(bk,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),s);var l=a.createWebChannel(c,s),h=!1,f=!1,d=new wk({co:function(t){f?vp(bk,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(vp(bk,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),l.open(),h=!0),vp(bk,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),l.send(t))},lo:function(){return l.close()}}),p=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return p(l,op.EventType.OPEN,(function(){f||vp(bk,"RPC '".concat(e,"' stream ").concat(r," transport opened."))})),p(l,op.EventType.CLOSE,(function(){f||(f=!0,vp(bk,"RPC '".concat(e,"' stream ").concat(r," transport closed")),d.Ro())})),p(l,op.EventType.ERROR,(function(t){f||(f=!0,mp(bk,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),d.Ro(new Ep(bp.UNAVAILABLE,"The operation could not be completed")))})),p(l,op.EventType.MESSAGE,(function(t){var n;if(!f){var i=t.data[0];_p(!!i);var a=i,o=a.error||(null===(n=a[0])||void 0===n?void 0:n.error);if(o){vp(bk,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);var s=o.status,u=function(e){var t=Sm[e];if(void 0!==t)return Um(t)}(s),c=o.message;void 0===u&&(u=bp.INTERNAL,c="Unknown error status: "+s+" with message "+o.message),f=!0,d.Ro(new Ep(u,c)),l.close()}else vp(bk,"RPC '".concat(e,"' stream ").concat(r," received:"),i),d.Vo(i)}})),p(o,rp.STAT_EVENT,(function(t){t.stat===ip.PROXY?vp(bk,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===ip.NOPROXY&&vp(bk,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((function(){d.Ao()}),0),d}}]),r}(function(){"use strict";function t(n){e(s)(this,t),this.databaseInfo=n,this.databaseId=n.databaseId;var r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo="projects/".concat(i,"/databases/").concat(a),this.po="(default)"===this.databaseId.database?"project_id=".concat(i):"project_id=".concat(i,"&database_id=").concat(a)}return e(u)(t,[{key:"yo",get:function(){return!1}},{key:"wo",value:function(e,t,n,r,i){var a=kk(),o=this.So(e,t);vp("RestConnection","Sending RPC '".concat(e,"' ").concat(a,":"),o,n);var s={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(s,r,i),this.Do(e,o,s,n).then((function(t){return vp("RestConnection","Received RPC '".concat(e,"' ").concat(a,": "),t),t}),(function(t){throw mp("RestConnection","RPC '".concat(e,"' ").concat(a," failed with error: "),t,"url: ",o,"request:",n),t}))}},{key:"Co",value:function(e,t,n,r,i,a){return this.wo(e,t,n,r,i)}},{key:"bo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+fp,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"So",value:function(e,t){var n=_k[e];return"".concat(this.mo,"/v1/").concat(t,":").concat(n)}}]),t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tk(e){return new rg(e,!0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xk=function(){"use strict";function t(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;e(s)(this,t),this.si=n,this.timerId=r,this.Fo=i,this.Mo=a,this.xo=o,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}return e(u)(t,[{key:"reset",value:function(){this.Oo=0}},{key:"Lo",value:function(){this.Oo=this.xo}},{key:"ko",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&vp("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Oo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.No=this.si.enqueueAfterDelay(this.timerId,i,(function(){return t.Bo=Date.now(),e()})),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}},{key:"Qo",value:function(){null!==this.No&&(this.No.skipDelay(),this.No=null)}},{key:"cancel",value:function(){null!==this.No&&(this.No.cancel(),this.No=null)}},{key:"qo",value:function(){return(Math.random()-.5)*this.Oo}}]),t}(),Ck=function(){"use strict";function t(n,r,i,a,o,u,c,l){e(s)(this,t),this.si=n,this.Ko=i,this.$o=a,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new xk(n,r)}return e(u)(t,[{key:"jo",value:function(){return 1===this.state||5===this.state||this.Ho()}},{key:"Ho",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Jo()}},{key:"stop",value:function(){var t=this;return e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.jo(),!e.t0){e.next=4;break}return e.next=4,t.close(0);case 4:case"end":return e.stop()}}),n)})))()}},{key:"Yo",value:function(){this.state=0,this.zo.reset()}},{key:"Zo",value:function(){var e=this;this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,(function(){return e.Xo()})))}},{key:"e_",value:function(e){this.t_(),this.stream.send(e)}},{key:"Xo",value:function(){var t=this;return e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.Ho()){e.next=2;break}return e.abrupt("return",t.close(0));case 2:case"end":return e.stop()}}),n)})))()}},{key:"t_",value:function(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}},{key:"n_",value:function(){this.Go&&(this.Go.cancel(),this.Go=null)}},{key:"close",value:function(t,n){var r=this;return e(a)(e(m).mark((function i(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.t_(),r.n_(),r.zo.cancel(),r.Uo++,4!==t?r.zo.reset():n&&n.code===bp.RESOURCE_EXHAUSTED?(yp(n.toString()),yp("Using maximum backoff delay to prevent overloading the backend."),r.zo.Lo()):n&&n.code===bp.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.r_(),r.stream.close(),r.stream=null),r.state=t,e.next=9,r.listener.Io(n);case 9:case"end":return e.stop()}}),i)})))()}},{key:"r_",value:function(){}},{key:"auth",value:function(){var t=this;this.state=1;var n=this.i_(this.Uo),r=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(n){var i=e(k)(n,2),a=i[0],o=i[1];t.Uo===r&&t.s_(a,o)}),(function(e){var r=t;n((function(){var t=new Ep(bp.UNKNOWN,"Fetching auth token failed: "+e.message);return r.o_(t)}))}))}},{key:"s_",value:function(e,t){var n=this,r=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho((function(){var e=n;r((function(){return e.state=2,e.Go=e.si.enqueueAfterDelay(e.$o,1e4,(function(){return e.Ho()&&(e.state=3),Promise.resolve()})),e.listener.ho()}))})),this.stream.Io((function(e){var t=n;r((function(){return t.o_(e)}))})),this.stream.onMessage((function(e){var t=n;r((function(){return t.onMessage(e)}))}))}},{key:"Jo",value:function(){var t=this;this.state=5,this.zo.ko(e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.state=0,t.start();case 1:case"end":return e.stop()}}),n)}))))}},{key:"o_",value:function(e){return vp("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"i_",value:function(e){var t=this;return function(n){var r=t;t.si.enqueueAndForget((function(){return r.Uo===e?n():(vp("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),t}(),Sk=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a,o,u,c){var l;return e(s)(this,r),(l=n.call(this,t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,a,o,c)).serializer=u,e(Vc)(l)}return e(u)(r,[{key:"__",value:function(e,t){return this.connection.vo("Listen",e,t)}},{key:"onMessage",value:function(e){this.zo.reset();var t=function(e,t){var n,r;if("targetChange"in t){t.targetChange;var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:kp(),a=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(_p(void 0===t||"string"==typeof t),kv.fromBase64String(t||"")):(_p(void 0===t||t instanceof Uint8Array),kv.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?bp.UNKNOWN:Um(e.code);return new Ep(t,e.message||"")}(s);n=new Ym(i,a,o,u||null)}else if("documentChange"in t){t.documentChange;var c=t.documentChange;c.document,c.document.name,c.document.updateTime;var l=fg(e,c.document.name),h=ug(c.document.updateTime),f=c.document.createTime?ug(c.document.createTime):Fp.min(),d=new Wv({mapValue:{fields:c.document.fields}}),p=Gv.newFoundDocument(l,h,f,d),v=c.targetIds||[],y=c.removedTargetIds||[];n=new Gm(v,y,p.key,p)}else if("documentDelete"in t){t.documentDelete;var m=t.documentDelete;m.document;var g=fg(e,m.document),k=m.readTime?ug(m.readTime):Fp.min(),_=Gv.newNoDocument(g,k),w=m.removedTargetIds||[];n=new Gm([],w,_.key,_)}else if("documentRemove"in t){t.documentRemove;var b=t.documentRemove;b.document;var E=fg(e,b.document),I=b.removedTargetIds||[];n=new Gm([],I,E,null)}else{if(!("filter"in t))return kp();t.filter;var T=t.filter;T.targetId;var x=T.count,C=void 0===x?0:x,S=T.unchangedNames,A=new Lm(C,S),R=T.targetId;n=new Qm(R,A)}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Fp.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?Fp.min():t.readTime?ug(t.readTime):Fp.min()}(e);return this.listener.a_(t,n)}},{key:"u_",value:function(e){var t={};t.database=vg(this.serializer),t.addTarget=function(e,t){var n,r=t.target;if((n=_y(r)?{documents:kg(e,r)}:{query:_g(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=og(e,t.resumeToken);var i=ig(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(Fp.min())>0){n.readTime=ag(e,t.snapshotVersion.toTimestamp());var a=ig(e,t.expectedCount);null!==a&&(n.expectedCount=a)}return n}(this.serializer,e);var n,r=(this.serializer,null==(n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return kp()}}(e.purpose))?null:{"goog-listen-tags":n});r&&(t.labels=r),this.e_(t)}},{key:"c_",value:function(e){var t={};t.database=vg(this.serializer),t.removeTarget=e,this.e_(t)}}]),r}(Ck),Ak=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a,o,u,c){var l;return e(s)(this,r),(l=n.call(this,t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,a,o,c)).serializer=u,l.l_=!1,e(Vc)(l)}return e(u)(r,[{key:"h_",get:function(){return this.l_}},{key:"start",value:function(){this.l_=!1,this.lastStreamToken=void 0,e(Mc)(e(jc)(r.prototype),"start",this).call(this)}},{key:"r_",value:function(){this.l_&&this.P_([])}},{key:"__",value:function(e,t){return this.connection.vo("Write",e,t)}},{key:"onMessage",value:function(e){if(_p(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();var t=(r=e.writeResults,i=e.commitTime,r&&r.length>0?(_p(void 0!==i),r.map((function(e){return n=i,(r=(t=e).updateTime?ug(t.updateTime):ug(n)).isEqual(Fp.min())&&(r=ug(n)),new pm(r,t.transformResults||[]);var t,n,r}))):[]),n=ug(e.commitTime);return this.listener.I_(n,t)}var r,i;return _p(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}},{key:"E_",value:function(){var e={};e.database=vg(this.serializer),this.e_(e)}},{key:"P_",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return gg(t.serializer,e)}))};this.e_(n)}}]),r}(Ck),Rk=function(t){"use strict";e(x)(r,(function t(){e(s)(this,t)}));var n=e(M)(r);function r(t,i,a,o){var u;return e(s)(this,r),(u=n.call(this)).authCredentials=t,u.appCheckCredentials=i,u.connection=a,u.serializer=o,u.d_=!1,e(Vc)(u)}return e(u)(r,[{key:"A_",value:function(){if(this.d_)throw new Ep(bp.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"wo",value:function(t,n,r){var i=this;return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=e(k)(a,2),s=o[0],u=o[1];return i.connection.wo(t,n,r,s,u)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===bp.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new Ep(bp.UNKNOWN,e.toString())}))}},{key:"Co",value:function(t,n,r,i){var a=this;return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(o){var s=e(k)(o,2),u=s[0],c=s[1];return a.connection.Co(t,n,r,u,c,i)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===bp.UNAUTHENTICATED&&(a.authCredentials.invalidateToken(),a.appCheckCredentials.invalidateToken()),e):new Ep(bp.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.d_=!0}}]),r}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nk=function(){"use strict";function t(n,r){e(s)(this,t),this.asyncQueue=n,this.onlineStateHandler=r,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}return e(u)(t,[{key:"g_",value:function(){var e=this;0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.m_=null,e.y_("Backend didn't respond within 10 seconds."),e.p_("Offline"),Promise.resolve()})))}},{key:"w_",value:function(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.p_("Offline")))}},{key:"set",value:function(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}},{key:"p_",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"y_",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.f_?(yp(t),this.f_=!1):vp("OnlineStateTracker",t)}},{key:"S_",value:function(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}]),t}(),Ok=function t(n,r,i,o,u){"use strict";var c=this;e(s)(this,t),this.localStore=n,this.datastore=r,this.asyncQueue=i,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=u,this.F_.ro((function(t){var n=c;i.enqueueAndForget(e(a)(e(m).mark((function t(){return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=zk(n),!t.t0){t.next=5;break}return vp("RemoteStore","Restarting streams for network reachability change."),t.next=5,function(){var t=e(a)(e(m).mark((function t(n){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=wp(n)).C_.add(4),e.next=4,Lk(r);case 4:return r.M_.set("Unknown"),r.C_.delete(4),e.next=8,Pk(r);case 8:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(n);case 5:case"end":return t.stop()}}),t)}))))})),this.M_=new Nk(i,o)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pk(e){return Dk.apply(this,arguments)}function Dk(){return(Dk=e(a)(e(m).mark((function t(n){var r,i,a,o,s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,i=!1,a=void 0,!zk(n)){e.next=25;break}e.prev=2,o=n.v_[Symbol.iterator]();case 4:if(r=(s=o.next()).done){e.next=11;break}return u=s.value,e.next=8,u(!0);case 8:r=!0,e.next=4;break;case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),i=!0,a=e.t0;case 17:e.prev=17,e.prev=18,r||null==o.return||o.return();case 20:if(e.prev=20,!i){e.next=23;break}throw a;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}}),t,null,[[2,13,17,25],[18,,20,24]])})))).apply(this,arguments)}function Lk(e){return Mk.apply(this,arguments)}function Mk(){return(Mk=e(a)(e(m).mark((function t(n){var r,i,a,o,s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!0,i=!1,a=void 0,e.prev=1,o=n.v_[Symbol.iterator]();case 3:if(r=(s=o.next()).done){e.next=10;break}return u=s.value,e.next=7,u(!1);case 7:r=!0,e.next=3;break;case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),i=!0,a=e.t0;case 16:e.prev=16,e.prev=17,r||null==o.return||o.return();case 19:if(e.prev=19,!i){e.next=22;break}throw a;case 22:return e.finish(19);case 23:return e.finish(16);case 24:case"end":return e.stop()}}),t,null,[[1,12,16,24],[17,,19,23]])})))).apply(this,arguments)}function Uk(e,t){var n=wp(e);n.D_.has(t.targetId)||(n.D_.set(t.targetId,t),qk(n)?Vk(n):g_(n).Ho()&&Bk(n,t))}function Fk(e,t){var n=wp(e),r=g_(n);n.D_.delete(t),r.Ho()&&jk(n,t),0===n.D_.size&&(r.Ho()?r.Zo():zk(n)&&n.M_.set("Unknown"))}function Bk(e,t){if(e.x_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Fp.min())>0){var n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}g_(e).u_(t)}function jk(e,t){e.x_.Oe(t),g_(e).c_(t)}function Vk(e){e.x_=new Xm({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},_t:function(t){return e.D_.get(t)||null},nt:function(){return e.datastore.serializer.databaseId}}),g_(e).start(),e.M_.g_()}function qk(e){return zk(e)&&!g_(e).jo()&&e.D_.size>0}function zk(e){return 0===wp(e).C_.size}function Hk(e){e.x_=void 0}function Wk(e){return Kk.apply(this,arguments)}function Kk(){return(Kk=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.D_.forEach((function(e,t){Bk(n,e)}));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Gk(e,t){return Qk.apply(this,arguments)}function Qk(){return(Qk=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Hk(n),qk(n)?(n.M_.w_(r),Vk(n)):n.M_.set("Unknown");case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Yk(e,t,n){return Jk.apply(this,arguments)}function Jk(){return Jk=e(a)(e(m).mark((function t(n,r,i){var o;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.M_.set("Online"),!(r instanceof Ym&&2===r.state&&r.cause)){t.next=13;break}return t.prev=1,t.next=4,function(){var t=e(a)(e(m).mark((function t(n,r){var i,a,o,s,u,c,l;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=r.cause,a=!0,o=!1,s=void 0,e.prev=2,u=r.targetIds[Symbol.iterator]();case 4:if(a=(c=u.next()).done){e.next=15;break}if(l=c.value,e.t0=n.D_.has(l),!e.t0){e.next=12;break}return e.next=10,n.remoteSyncer.rejectListen(l,i);case 10:n.D_.delete(l),n.x_.removeTarget(l);case 12:a=!0,e.next=4;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(2),o=!0,s=e.t1;case 21:e.prev=21,e.prev=22,a||null==u.return||u.return();case 24:if(e.prev=24,!o){e.next=27;break}throw s;case 27:return e.finish(24);case 28:return e.finish(21);case 29:case"end":return e.stop()}}),t,null,[[2,17,21,29],[22,,24,28]])})));return function(e,n){return t.apply(this,arguments)}}()(n,r);case 4:t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(1),vp("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),t.t0),t.next=11,Xk(n,t.t0);case 11:case 22:t.next=29;break;case 13:if(r instanceof Gm?n.x_.$e(r):r instanceof Qm?n.x_.Je(r):n.x_.Ge(r),i.isEqual(Fp.min())){t.next=29;break}return t.prev=14,t.next=17,ak(n.localStore);case 17:if(o=t.sent,t.t1=i.compareTo(o)>=0,!t.t1){t.next=22;break}return t.next=22,function(e,t){var n=e.x_.it(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.D_.get(r);i&&e.D_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t,n){var r=e.D_.get(t);if(r){e.D_.set(t,r.withResumeToken(kv.EMPTY_BYTE_STRING,r.snapshotVersion)),jk(e,t);var i=new Ag(r.target,t,n,r.sequenceNumber);Bk(e,i)}})),e.remoteSyncer.applyRemoteEvent(n)}(n,i);case 24:return t.prev=24,t.t2=t.catch(14),vp("RemoteStore","Failed to raise snapshot:",t.t2),t.next=29,Xk(n,t.t2);case 29:case"end":return t.stop()}}),t,null,[[1,6],[14,24]])}))),Jk.apply(this,arguments)}function Xk(e,t,n){return $k.apply(this,arguments)}function $k(){return($k=e(a)(e(m).mark((function t(n,r,i){return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ev(r)){t.next=2;break}throw r;case 2:return n.C_.add(1),t.next=5,Lk(n);case 5:n.M_.set("Offline"),i||(i=function(){return ak(n.localStore)}),n.asyncQueue.enqueueRetryable(e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vp("RemoteStore","Retrying IndexedDB access"),e.next=3,i();case 3:return n.C_.delete(1),e.next=6,Pk(n);case 6:case"end":return e.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Zk(e,t){return t().catch((function(n){return Xk(e,n,t)}))}function e_(e){return t_.apply(this,arguments)}function t_(){return(t_=e(a)(e(m).mark((function t(n){var r,i,a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=wp(n),i=k_(r),a=r.b_.length>0?r.b_[r.b_.length-1].batchId:-1;case 2:if(!n_(r)){e.next=19;break}return e.prev=3,e.next=6,uk(r.localStore,a);case 6:if(null!==(o=e.sent)){e.next=10;break}return 0===r.b_.length&&i.Zo(),e.abrupt("break",19);case 10:a=o.batchId,r_(r,o),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,Xk(r,e.t0);case 17:e.next=2;break;case 19:i_(r)&&a_(r);case 20:case"end":return e.stop()}}),t,null,[[3,13]])})))).apply(this,arguments)}function n_(e){return zk(e)&&e.b_.length<10}function r_(e,t){e.b_.push(t);var n=k_(e);n.Ho()&&n.h_&&n.P_(t.mutations)}function i_(e){return zk(e)&&!k_(e).jo()&&e.b_.length>0}function a_(e){k_(e).start()}function o_(e){return s_.apply(this,arguments)}function s_(){return(s_=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k_(n).E_();case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function u_(e){return c_.apply(this,arguments)}function c_(){return(c_=e(a)(e(m).mark((function t(n){var r,i,a,o,s,u,c;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=k_(n),i=!0,a=!1,o=void 0,e.prev=2,s=n.b_[Symbol.iterator]();!(i=(u=s.next()).done);i=!0)c=u.value,r.P_(c.mutations);e.next=10;break;case 6:e.prev=6,e.t0=e.catch(2),a=!0,o=e.t0;case 10:e.prev=10,e.prev=11,i||null==s.return||s.return();case 13:if(e.prev=13,!a){e.next=16;break}throw o;case 16:return e.finish(13);case 17:return e.finish(10);case 18:case"end":return e.stop()}}),t,null,[[2,6,10,18],[11,,13,17]])})))).apply(this,arguments)}function l_(e,t,n){return h_.apply(this,arguments)}function h_(){return(h_=e(a)(e(m).mark((function t(n,r,i){var a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.b_.shift(),o=Pm.from(a,r,i),e.next=3,Zk(n,(function(){return n.remoteSyncer.applySuccessfulWrite(o)}));case 3:return e.next=5,e_(n);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function f_(e,t){return d_.apply(this,arguments)}function d_(){return d_=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=r&&k_(n).h_,!t.t0){t.next=4;break}return t.next=4,function(){var t=e(a)(e(m).mark((function t(n,r){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Mm(t=r.code)||t===bp.ABORTED){e.next=7;break}return i=n.b_.shift(),k_(n).Yo(),e.next=5,Zk(n,(function(){return n.remoteSyncer.rejectFailedWrite(i.batchId,r)}));case 5:return e.next=7,e_(n);case 7:case"end":return e.stop()}var t}),t)})));return function(e,n){return t.apply(this,arguments)}}()(n,r);case 4:i_(n)&&a_(n);case 5:case"end":return t.stop()}}),t)}))),d_.apply(this,arguments)}function p_(e,t){return v_.apply(this,arguments)}function v_(){return(v_=e(a)(e(m).mark((function t(n,r){var i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=wp(n)).asyncQueue.verifyOperationInProgress(),vp("RemoteStore","RemoteStore received new credentials"),a=zk(i),i.C_.add(3),e.next=6,Lk(i);case 6:return a&&i.M_.set("Unknown"),e.next=9,i.remoteSyncer.handleCredentialChange(r);case 9:return i.C_.delete(3),e.next=12,Pk(i);case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function y_(e,t){return m_.apply(this,arguments)}function m_(){return(m_=e(a)(e(m).mark((function t(n,r){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=wp(n),!r){e.next=7;break}return i.C_.delete(2),e.next=5,Pk(i);case 5:e.next=13;break;case 7:if(e.t0=r,e.t0){e.next=13;break}return i.C_.add(2),e.next=12,Lk(i);case 12:i.M_.set("Unknown");case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function g_(t){return t.O_||(t.O_=(r=t.datastore,i=t.asyncQueue,o={ho:Wk.bind(null,t),Io:Gk.bind(null,t),a_:Yk.bind(null,t)},(s=wp(r)).A_(),new Sk(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,o)),t.v_.push((n=e(a)(e(m).mark((function n(r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=4;break}t.O_.Yo(),qk(t)?Vk(t):t.M_.set("Unknown"),e.next=7;break;case 4:return e.next=6,t.O_.stop();case 6:Hk(t);case 7:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))),t.O_;var n,r,i,o,s}function k_(t){return t.N_||(t.N_=(r=t.datastore,i=t.asyncQueue,o={ho:o_.bind(null,t),Io:f_.bind(null,t),T_:u_.bind(null,t),I_:l_.bind(null,t)},(s=wp(r)).A_(),new Ak(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,o)),t.v_.push((n=e(a)(e(m).mark((function n(r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return t.N_.Yo(),e.next=4,e_(t);case 4:e.next=9;break;case 6:return e.next=8,t.N_.stop();case 8:t.b_.length>0&&(vp("RemoteStore","Stopping write stream with ".concat(t.b_.length," pending writes")),t.b_=[]);case 9:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))),t.N_
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */;var n,r,i,o,s}var __=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.asyncQueue=n,this.timerId=r,this.targetTimeMs=i,this.op=a,this.removalCallback=o,this.deferred=new Ip,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return e(u)(t,[{key:"promise",get:function(){return this.deferred.promise}},{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ep(bp.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}],[{key:"createAndSchedule",value:function(e,n,r,i,a){var o=new t(e,n,Date.now()+r,i,a);return o.start(r),o}}]),t}();function w_(e,t){if(yp("AsyncQueue","".concat(t,": ").concat(e)),ev(e))return new Ep(bp.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var b_=function(){"use strict";function t(n){e(s)(this,t),this.comparator=n?function(e,t){return n(e,t)||zp.comparator(e.key,t.key)}:function(e,t){return zp.comparator(e.key,t.key)},this.keyedMap=qy(),this.sortedSet=new hv(this.comparator)}return e(u)(t,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}],[{key:"emptySet",value:function(e){return new t(e.comparator)}}]),t}(),E_=function(){"use strict";function t(){e(s)(this,t),this.B_=new hv(zp.comparator)}return e(u)(t,[{key:"track",value:function(e){var t=e.doc.key,n=this.B_.get(t);n?0!==e.type&&3===n.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==n.type?this.B_=this.B_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.B_=this.B_.remove(t):1===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):kp():this.B_=this.B_.insert(t,e)}},{key:"L_",value:function(){var e=[];return this.B_.inorderTraversal((function(t,n){e.push(n)})),e}}]),t}(),I_=function(){"use strict";function t(n,r,i,a,o,u,c,l,h){e(s)(this,t),this.query=n,this.docs=r,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}return e(u)(t,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ny(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(e,n,r,i,a){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new t(e,n,b_.emptySet(n),o,r,i,!0,!1,a)}}]),t}(),T_=function t(){"use strict";e(s)(this,t),this.k_=void 0,this.listeners=[]},x_=function t(){"use strict";e(s)(this,t),this.queries=new Fy((function(e){return Oy(e)}),Ny),this.onlineState="Unknown",this.q_=new Set};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C_(e,t){return S_.apply(this,arguments)}function S_(){return(S_=e(a)(e(m).mark((function t(n,r){var i,a,o,s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=wp(n),a=r.query,o=!1,(s=i.queries.get(a))||(o=!0,s=new T_),!o){e.next=13;break}return e.prev=3,e.next=6,i.onListen(a);case 6:s.k_=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),u=w_(e.t0,"Initialization of query '".concat(Py(r.query),"' failed")),e.abrupt("return",void r.onError(u));case 13:i.queries.set(a,s),s.listeners.push(r),r.Q_(i.onlineState),s.k_&&r.K_(s.k_)&&P_(i);case 14:case"end":return e.stop()}}),t,null,[[3,9]])})))).apply(this,arguments)}function A_(e,t){return R_.apply(this,arguments)}function R_(){return(R_=e(a)(e(m).mark((function t(n,r){var i,a,o,s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=wp(n),a=r.query,o=!1,(s=i.queries.get(a))&&(u=s.listeners.indexOf(r))>=0&&(s.listeners.splice(u,1),o=0===s.listeners.length),!o){e.next=6;break}return e.abrupt("return",(i.queries.delete(a),i.onUnlisten(a)));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function N_(e,t){var n=wp(e),r=!1,i=!0,a=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=c.query,h=n.queries.get(l);if(h){var f=!0,d=!1,p=void 0;try{for(var v,y=h.listeners[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){v.value.K_(c)&&(r=!0)}}catch(e){d=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}h.k_=c}}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}r&&P_(n)}function O_(e,t,n){var r=wp(e),i=r.queries.get(t),a=!0,o=!1,s=void 0;if(i)try{for(var u,c=i.listeners[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.onError(n)}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}r.queries.delete(t)}function P_(e){e.q_.forEach((function(e){e.next()}))}var D_=function(){"use strict";function t(n,r,i){e(s)(this,t),this.query=n,this.U_=r,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=i||{}}return e(u)(t,[{key:"K_",value:function(e){if(!this.options.includeMetadataChanges){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e.docChanges[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;3!==s.type&&t.push(s)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}e=new I_(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var u=!1;return this.W_?this.z_(e)&&(this.U_.next(e),u=!0):this.j_(e,this.onlineState)&&(this.H_(e),u=!0),this.G_=e,u}},{key:"onError",value:function(e){this.U_.error(e)}},{key:"Q_",value:function(e){this.onlineState=e;var t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}},{key:"j_",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.J_||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"z_",value:function(e){if(e.docChanges.length>0)return!0;var t=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"H_",value:function(e){e=I_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var L_=function t(n){"use strict";e(s)(this,t),this.key=n},M_=function t(n){"use strict";e(s)(this,t),this.key=n},U_=function(){"use strict";function t(n,r){e(s)(this,t),this.query=n,this.ia=r,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=Yy(),this.mutatedKeys=Yy(),this._a=My(n),this.aa=new b_(this._a)}return e(u)(t,[{key:"ua",get:function(){return this.ia}},{key:"ca",value:function(e,t){var n=this,r=t?t.la:new E_,i=t?t.aa:this.aa,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),h=Dy(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.ha(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n._a(h,u)>0||c&&n._a(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{aa:o,la:r,Zi:s,mutatedKeys:a}}},{key:"ha",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;var a=e.la.L_();a.sort((function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kp()}})(n)-a(i)||r._a(e.doc,t.doc);var n,i,a})),this.Pa(n);var o=t?this.Ia():[],s=0===this.oa.size&&this.current?1:0,u=s!==this.sa;return this.sa=s,0!==a.length||u?{snapshot:new I_(this.query,e.aa,i,a,e.mutatedKeys,0===s,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ta:o}:{Ta:o}}},{key:"Q_",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new E_,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}},{key:"Ea",value:function(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}},{key:"Pa",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.ia=t.ia.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.ia=t.ia.delete(e)})),this.current=e.current)}},{key:"Ia",value:function(){var e=this;if(!this.current)return[];var t=this.oa;this.oa=Yy(),this.aa.forEach((function(t){e.Ea(t.key)&&(e.oa=e.oa.add(t.key))}));var n=[];return t.forEach((function(t){e.oa.has(t)||n.push(new M_(t))})),this.oa.forEach((function(e){t.has(e)||n.push(new L_(e))})),n}},{key:"da",value:function(e){this.ia=e.ls,this.oa=Yy();var t=this.ca(e.documents);return this.applyChanges(t,!0)}},{key:"Aa",value:function(){return I_.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}]),t}(),F_=function t(n,r,i){"use strict";e(s)(this,t),this.query=n,this.targetId=r,this.view=i},B_=function t(n){"use strict";e(s)(this,t),this.key=n,this.Ra=!1},j_=function(){"use strict";function t(n,r,i,a,o,u){e(s)(this,t),this.localStore=n,this.remoteStore=r,this.eventManager=i,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.Va={},this.ma=new Fy((function(e){return Oy(e)}),Ny),this.fa=new Map,this.ga=new Set,this.pa=new hv(zp.comparator),this.ya=new Map,this.wa=new qg,this.Sa={},this.ba=new Map,this.Da=Mg.Nn(),this.onlineState="Unknown",this.Ca=void 0}return e(u)(t,[{key:"isPrimaryClient",get:function(){return!0===this.Ca}}]),t}();function V_(e,t){return q_.apply(this,arguments)}function q_(){return(q_=e(a)(e(m).mark((function t(n,r){var i,a,o,s,u,c;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=yw(n),!(s=i.ma.get(r))){e.next=7;break}a=s.targetId,i.sharedClientState.addLocalQueryTarget(a),o=s.view.Aa(),e.next=16;break;case 7:return e.next=9,ck(i.localStore,Cy(r));case 9:return u=e.sent,c=i.sharedClientState.addLocalQueryTarget(u.targetId),a=u.targetId,e.next=14,z_(i,r,a,"current"===c,u.resumeToken);case 14:o=e.sent,i.isPrimaryClient&&Uk(i.remoteStore,u);case 16:return e.abrupt("return",o);case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function z_(e,t,n,r,i){return H_.apply(this,arguments)}function H_(){return H_=e(a)(e(m).mark((function t(n,r,i,o,s){var u,c,l,h,f,d;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.va=function(t,r,i){return(o=e(a)(e(m).mark((function t(n,r,i,a){var o,s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.view.ca(i),e.t0=o.Zi,!e.t0){e.next=6;break}return e.next=5,fk(n.localStore,r.query,!1).then((function(e){var t=e.documents;return r.view.ca(t,o)}));case 5:o=e.sent;case 6:return s=a&&a.targetChanges.get(r.targetId),u=r.view.applyChanges(o,n.isPrimaryClient,s),e.abrupt("return",(uw(n,r.targetId,u.Ta),u.snapshot));case 8:case"end":return e.stop()}}),t)}))),function(e,t,n,r){return o.apply(this,arguments)})(n,t,r,i);var o},t.next=3,fk(n.localStore,r,!0);case 3:return u=t.sent,c=new U_(r,u.ls),l=c.ca(u.documents),h=Km.createSynthesizedTargetChangeForCurrentChange(i,o&&"Offline"!==n.onlineState,s),f=c.applyChanges(l,n.isPrimaryClient,h),uw(n,i,f.Ta),d=new F_(r,i,c),t.abrupt("return",(n.ma.set(r,d),n.fa.has(i)?n.fa.get(i).push(r):n.fa.set(i,[r]),f.snapshot));case 11:case"end":return t.stop()}}),t)}))),H_.apply(this,arguments)}function W_(e,t){return K_.apply(this,arguments)}function K_(){return(K_=e(a)(e(m).mark((function t(n,r){var i,a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=wp(n),a=i.ma.get(r),!((o=i.fa.get(a.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(i.fa.set(a.targetId,o.filter((function(e){return!Ny(e,r)}))),void i.ma.delete(r)));case 3:if(!i.isPrimaryClient){e.next=11;break}if(i.sharedClientState.removeLocalQueryTarget(a.targetId),e.t0=i.sharedClientState.isActiveQueryTarget(a.targetId),e.t0){e.next=9;break}return e.next=9,lk(i.localStore,a.targetId,!1).then((function(){i.sharedClientState.clearQueryState(a.targetId),Fk(i.remoteStore,a.targetId),ow(i,a.targetId)})).catch(Xp);case 9:e.next=14;break;case 11:return ow(i,a.targetId),e.next=14,lk(i.localStore,a.targetId,!0);case 14:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function G_(e,t,n){return Q_.apply(this,arguments)}function Q_(){return Q_=e(a)(e(m).mark((function t(n,r,i){var a,o,s;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=mw(n),e.prev=1,e.next=4,function(e,t){var n,r,i=wp(e),a=Up.now(),o=t.reduce((function(e,t){return e.add(t.key)}),Yy());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var s=jy(),u=Yy();return i.ss.getEntries(e,o).next((function(e){(s=e).forEach((function(e,t){t.isValidDocument()||(u=u.add(e))}))})).next((function(){return i.localDocuments.getOverlayedDocuments(e,s)})).next((function(r){n=r;var o=[],s=!0,u=!1,c=void 0;try{for(var l,h=t[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value,d=wm(f,n.get(f.key).overlayedDocument);null!=d&&o.push(new Im(f.key,d,Kv(d.value.mapValue),vm.exists(!0)))}}catch(e){u=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}return i.mutationQueue.addMutationBatch(e,a,o,t)})).next((function(t){r=t;var a=t.applyToLocalDocumentSet(n,u);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)}))})).then((function(){return{batchId:r.batchId,changes:zy(n)}}))}(a.localStore,r);case 4:return o=e.sent,a.sharedClientState.addPendingMutation(o.batchId),t=a,u=o.batchId,c=i,l=void 0,(l=t.Sa[t.currentUser.toKey()])||(l=new hv(Lp)),l=l.insert(u,c),t.Sa[t.currentUser.toKey()]=l,e.next=9,hw(a,o.changes);case 9:return e.next=11,e_(a.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),s=w_(e.t0,"Failed to persist write"),i.reject(s);case 17:case"end":return e.stop()}var t,u,c,l}),t,null,[[1,13]])}))),Q_.apply(this,arguments)}function Y_(e,t){return J_.apply(this,arguments)}function J_(){return(J_=e(a)(e(m).mark((function t(n,r){var i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=wp(n),e.prev=1,e.next=4,ok(i.localStore,r);case 4:return a=e.sent,r.targetChanges.forEach((function(e,t){var n=i.ya.get(t);n&&(_p(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Ra=!0:e.modifiedDocuments.size>0?_p(n.Ra):e.removedDocuments.size>0&&(_p(n.Ra),n.Ra=!1))})),e.next=8,hw(i,a,r);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Xp(e.t0);case 14:case"end":return e.stop()}}),t,null,[[1,10]])})))).apply(this,arguments)}function X_(e,t,n){var r=wp(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.ma.forEach((function(e,n){var r=n.view.Q_(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=wp(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var i=!0,a=!1,o=void 0;try{for(var s,u=n.listeners[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){s.value.Q_(t)&&(r=!0)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}})),r&&P_(n)}(r.eventManager,t),i.length&&r.Va.a_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function $_(e,t,n){return Z_.apply(this,arguments)}function Z_(){return(Z_=e(a)(e(m).mark((function t(n,r,i){var a,o,s,u,c,l;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=wp(n)).sharedClientState.updateQueryState(r,"rejected",i),o=a.ya.get(r),!(s=o&&o.key)){e.next=14;break}return u=(u=new hv(zp.comparator)).insert(s,Gv.newNoDocument(s,Fp.min())),c=Yy().add(s),l=new Wm(Fp.min(),new Map,new hv(Lp),u,c),e.next=9,Y_(a,l);case 9:a.pa=a.pa.remove(s),a.ya.delete(r),lw(a),e.next=16;break;case 14:return e.next=16,lk(a.localStore,r,!1).then((function(){return ow(a,r,i)})).catch(Xp);case 16:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ew(e,t){return tw.apply(this,arguments)}function tw(){return(tw=e(a)(e(m).mark((function t(n,r){var i,a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=wp(n),a=r.batch.batchId,e.prev=1,e.next=4,ik(i.localStore,r);case 4:return o=e.sent,aw(i,a,null),iw(i,a),i.sharedClientState.updateMutationState(a,"acknowledged"),e.next=10,hw(i,o);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Xp(e.t0);case 16:case"end":return e.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}function nw(e,t,n){return rw.apply(this,arguments)}function rw(){return(rw=e(a)(e(m).mark((function t(n,r,i){var a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=wp(n),e.prev=1,e.next=4,function(e,t){var n=wp(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return _p(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(a.localStore,r);case 4:return o=e.sent,aw(a,r,i),iw(a,r),a.sharedClientState.updateMutationState(r,"rejected",i),e.next=10,hw(a,o);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Xp(e.t0);case 16:case"end":return e.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}function iw(e,t){(e.ba.get(t)||[]).forEach((function(e){e.resolve()})),e.ba.delete(t)}function aw(e,t,n){var r=wp(e),i=r.Sa[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.Sa[r.currentUser.toKey()]=i}}function ow(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r=!0,i=!1,a=void 0;try{for(var o,s=e.fa.get(t)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;e.ma.delete(u),n&&e.Va.Fa(u,n)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}e.fa.delete(t),e.isPrimaryClient&&e.wa.Rr(t).forEach((function(t){e.wa.containsKey(t)||sw(e,t)}))}function sw(e,t){e.ga.delete(t.path.canonicalString());var n=e.pa.get(t);null!==n&&(Fk(e.remoteStore,n),e.pa=e.pa.remove(t),e.ya.delete(n),lw(e))}function uw(e,t,n){var r=!0,i=!1,a=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;u instanceof L_?(e.wa.addReference(u.key,t),cw(e,u)):u instanceof M_?(vp("SyncEngine","Document no longer in limbo: "+u.key),e.wa.removeReference(u.key,t),e.wa.containsKey(u.key)||sw(e,u.key)):kp()}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}function cw(e,t){var n=t.key,r=n.path.canonicalString();e.pa.get(n)||e.ga.has(r)||(vp("SyncEngine","New document in limbo: "+n),e.ga.add(r),lw(e))}function lw(e){for(;e.ga.size>0&&e.pa.size<e.maxConcurrentLimboResolutions;){var t=e.ga.values().next().value;e.ga.delete(t);var n=new zp(jp.fromString(t)),r=e.Da.next();e.ya.set(r,new B_(n)),e.pa=e.pa.insert(n,r),Uk(e.remoteStore,new Ag(Cy(Ey(n.path)),r,"TargetPurposeLimboResolution",tv._e))}}function hw(e,t,n){return fw.apply(this,arguments)}function fw(){return fw=e(a)(e(m).mark((function t(n,r,i){var o,s,u,c;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=wp(n),s=[],u=[],c=[],t.t0=o.ma.isEmpty(),t.t0){t.next=9;break}return o.ma.forEach((function(e,t){c.push(o.va(t,r,i).then((function(e){if((e||i)&&o.isPrimaryClient&&o.sharedClientState.updateQueryState(t.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){s.push(e);var n=Xg.Qi(t.targetId,e);u.push(n)}})))})),t.next=6,Promise.all(c);case 6:return o.Va.a_(s),t.next=9,function(){var t=e(a)(e(m).mark((function t(n,r){var i,a,o,s,u,c,l,h,f,d,p;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=wp(n),e.prev=1,e.next=4,i.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return Zp.forEach(r,(function(t){return Zp.forEach(t.ki,(function(n){return i.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return Zp.forEach(t.qi,(function(n){return i.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),ev(e.t0)){e.next=10;break}throw e.t0;case 10:vp("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:for(a=!0,o=!1,s=void 0,e.prev=12,u=r[Symbol.iterator]();!(a=(c=u.next()).done);a=!0)l=c.value,h=l.targetId,l.fromCache||(f=i.ts.get(h),d=f.snapshotVersion,p=f.withLastLimboFreeSnapshotVersion(d),i.ts=i.ts.insert(h,p));e.next=20;break;case 16:e.prev=16,e.t1=e.catch(12),o=!0,s=e.t1;case 20:e.prev=20,e.prev=21,a||null==u.return||u.return();case 23:if(e.prev=23,!o){e.next=26;break}throw s;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),t,null,[[1,6],[12,16,20,28],[21,,23,27]])})));return function(e,n){return t.apply(this,arguments)}}()(o.localStore,u);case 9:case"end":return t.stop()}}),t)}))),fw.apply(this,arguments)}function dw(e,t){return pw.apply(this,arguments)}function pw(){return(pw=e(a)(e(m).mark((function t(n,r){var i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=wp(n)).currentUser.isEqual(r)){e.next=11;break}return vp("SyncEngine","User change. New user:",r.toKey()),e.next=5,nk(i.localStore,r);case 5:return a=e.sent,i.currentUser=r,function(e,t){e.ba.forEach((function(e){e.forEach((function(e){e.reject(new Ep(bp.CANCELLED,t))}))})),e.ba.clear()}(i,"'waitForPendingWrites' promise is rejected due to a user change."),i.sharedClientState.handleUserChange(r,a.removedBatchIds,a.addedBatchIds),e.next=11,hw(i,a._s);case 11:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function vw(e,t){var n=wp(e),r=n.ya.get(t);if(r&&r.Ra)return Yy().add(r.key);var i=Yy(),a=n.fa.get(t);if(!a)return i;var o=!0,s=!1,u=void 0;try{for(var c,l=a[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value,f=n.ma.get(h);i=i.unionWith(f.view.ua)}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return i}function yw(e){var t=wp(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Y_.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=vw.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=$_.bind(null,t),t.Va.a_=N_.bind(null,t.eventManager),t.Va.Fa=O_.bind(null,t.eventManager),t}function mw(e){var t=wp(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=ew.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=nw.bind(null,t),t}var gw=function(){"use strict";function t(){e(s)(this,t),this.synchronizeTabs=!1}return e(u)(t,[{key:"initialize",value:function(t){var n=this;return e(a)(e(m).mark((function r(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.serializer=Tk(t.databaseInfo.databaseId),n.sharedClientState=n.createSharedClientState(t),n.persistence=n.createPersistence(t),e.next=5,n.persistence.start();case 5:n.localStore=n.createLocalStore(t),n.gcScheduler=n.createGarbageCollectionScheduler(t,n.localStore),n.indexBackfillerScheduler=n.createIndexBackfillerScheduler(t,n.localStore);case 8:case"end":return e.stop()}}),r)})))()}},{key:"createGarbageCollectionScheduler",value:function(e,t){return null}},{key:"createIndexBackfillerScheduler",value:function(e,t){return null}},{key:"createLocalStore",value:function(e){return tk(this.persistence,new Zg,e.initialUser,this.serializer)}},{key:"createPersistence",value:function(e){return new Qg(Jg.jr,this.serializer)}},{key:"createSharedClientState",value:function(e){return new vk}},{key:"terminate",value:function(){var t=this;return e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.gcScheduler&&t.gcScheduler.stop(),e.next=3,t.sharedClientState.shutdown();case 3:return e.next=5,t.persistence.shutdown();case 5:case"end":return e.stop()}}),n)})))()}}]),t}(),kw=function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,[{key:"initialize",value:function(t,n){var r=this;return e(a)(e(m).mark((function i(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r.localStore,e.t0){e.next=12;break}return r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=function(e){return X_(r.syncEngine,e,1)},r.remoteStore.remoteSyncer.handleCredentialChange=dw.bind(null,r.syncEngine),e.next=12,y_(r.remoteStore,r.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),i)})))()}},{key:"createEventManager",value:function(e){return new x_}},{key:"createDatastore",value:function(e){var t,n=Tk(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new Ek(t));return function(e,t,n,r){return new Rk(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return X_(o.syncEngine,e,0)},a=mk.D()?new mk:new yk,new Ok(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=e.initialUser,s=e.maxConcurrentLimboResolutions,u=t,c=new j_(n,r,i,a,o,s),u&&(c.Ca=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(t=e(a)(e(m).mark((function t(n){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=wp(n),vp("RemoteStore","RemoteStore shutting down."),r.C_.add(5),e.next=5,Lk(r);case 5:r.F_.shutdown(),r.M_.set("Unknown");case 7:case"end":return e.stop()}}),t)}))),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var _w=function(){"use strict";function t(n){e(s)(this,t),this.observer=n,this.muted=!1}return e(u)(t,[{key:"next",value:function(e){this.observer.next&&this.Oa(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Oa(this.observer.error,e):yp("Uncaught Error in snapshot listener:",e.toString())}},{key:"Na",value:function(){this.muted=!0}},{key:"Oa",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),t}(),ww=function(){"use strict";function t(n,r,i,o){var u=this;e(s)(this,t);var c,l=this;this.authCredentials=n,this.appCheckCredentials=r,this.asyncQueue=i,this.databaseInfo=o,this.user=hp.UNAUTHENTICATED,this.clientId=Dp.newId(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(i,(c=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vp("FirestoreClient","Received user=",n.uid),e.next=3,l.authCredentialListener(n);case 3:l.user=n;case 4:case"end":return e.stop()}}),t)}))),function(e){return c.apply(this,arguments)})),this.appCheckCredentials.start(i,(function(e){return vp("FirestoreClient","Received new app check token=",e),u.appCheckCredentialListener(e,u.user)}))}return e(u)(t,[{key:"getConfiguration",value:function(){var t=this;return e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),n)})))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Ep(bp.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){this.asyncQueue.enterRestrictedMode();var t=new Ip,n=this;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=n._onlineComponents,!e.t0){e.next=5;break}return e.next=5,n._onlineComponents.terminate();case 5:if(e.t1=n._offlineComponents,!e.t1){e.next=9;break}return e.next=9,n._offlineComponents.terminate();case 9:n.authCredentials.shutdown(),n.appCheckCredentials.shutdown(),t.resolve(),e.next=18;break;case 14:e.prev=14,e.t2=e.catch(0),i=w_(e.t2,"Failed to shutdown persistence"),t.reject(i);case 18:case"end":return e.stop()}}),r,null,[[0,14]])})))),t.promise}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bw(e,t){return Ew.apply(this,arguments)}function Ew(){return Ew=e(a)(e(m).mark((function t(n,r){var i,o;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.asyncQueue.verifyOperationInProgress(),vp("FirestoreClient","Initializing OfflineComponentProvider"),t.next=3,n.getConfiguration();case 3:return i=t.sent,t.next=6,r.initialize(i);case 6:o=i.initialUser,n.setCredentialChangeListener(function(){var t=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=o.isEqual(n),e.t0){e.next=5;break}return e.next=4,nk(r.localStore,n);case 4:o=n;case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.persistence.setDatabaseDeletedListener((function(){return n.terminate()})),n._offlineComponents=r;case 8:case"end":return t.stop()}}),t)}))),Ew.apply(this,arguments)}function Iw(e,t){return Tw.apply(this,arguments)}function Tw(){return(Tw=e(a)(e(m).mark((function t(n,r){var i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.asyncQueue.verifyOperationInProgress(),e.next=3,Cw(n);case 3:return i=e.sent,vp("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,n.getConfiguration();case 7:return a=e.sent,e.next=10,r.initialize(i,a);case 10:n.setCredentialChangeListener((function(e){return p_(r.remoteStore,e)})),n.setAppCheckTokenChangeListener((function(e,t){return p_(r.remoteStore,t)})),n._onlineComponents=r;case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function xw(e){return"FirebaseError"===e.name?e.code===bp.FAILED_PRECONDITION||e.code===bp.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}function Cw(e){return Sw.apply(this,arguments)}function Sw(){return(Sw=e(a)(e(m).mark((function t(n){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n._offlineComponents){e.next=21;break}if(!n._uninitializedComponentsProvider){e.next=18;break}return vp("FirestoreClient","Using user provided OfflineComponentProvider"),e.prev=3,e.next=6,bw(n,n._uninitializedComponentsProvider._offline);case 6:e.next=16;break;case 8:if(e.prev=8,e.t0=e.catch(3),xw(r=e.t0)){e.next=13;break}throw r;case 13:return mp("Error using user provided cache. Falling back to memory cache: "+r),e.next=16,bw(n,new gw);case 16:e.next=21;break;case 18:return vp("FirestoreClient","Using default OfflineComponentProvider"),e.next=21,bw(n,new gw);case 21:return e.abrupt("return",n._offlineComponents);case 22:case"end":return e.stop()}}),t,null,[[3,8]])})))).apply(this,arguments)}function Aw(e){return Rw.apply(this,arguments)}function Rw(){return(Rw=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n._onlineComponents,e.t0){e.next=11;break}if(!n._uninitializedComponentsProvider){e.next=8;break}return vp("FirestoreClient","Using user provided OnlineComponentProvider"),e.next=6,Iw(n,n._uninitializedComponentsProvider._online);case 6:e.next=11;break;case 8:return vp("FirestoreClient","Using default OnlineComponentProvider"),e.next=11,Iw(n,new kw);case 11:return e.abrupt("return",(e.t0,n._onlineComponents));case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Nw(e){return Aw(e).then((function(e){return e.syncEngine}))}function Ow(e){return Pw.apply(this,arguments)}function Pw(){return(Pw=e(a)(e(m).mark((function t(n){var r,i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Aw(n);case 2:return r=e.sent,i=r.eventManager,e.abrupt("return",(i.onListen=V_.bind(null,r.syncEngine),i.onUnlisten=W_.bind(null,r.syncEngine),i));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Dw(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new Ip;return t.asyncQueue.enqueueAndForget(e(a)(e(m).mark((function a(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n,r,i){var a=new _w({next:function(n){t.enqueueAndForget((function(){return A_(e,o)})),n.fromCache&&"server"===r.source?i.reject(new Ep(bp.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new D_(n,a,{includeMetadataChanges:!0,J_:!0});return C_(e,o)},e.next=3,Ow(t);case 3:return e.t1=e.sent,e.t2=t.asyncQueue,e.t3=n,e.t4=r,e.t5=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4,e.t5));case 9:case"end":return e.stop()}}),a)})))),i.promise}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Lw(e){var t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var Mw=new Map;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(e,t,n){if(!n)throw new Ep(bp.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Fw(e){if(!zp.isDocumentKey(e))throw new Ep(bp.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Bw(e){if(zp.isDocumentKey(e))throw new Ep(bp.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function jw(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":kp()}function Vw(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ep(bp.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=jw(e);throw new Ep(bp.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var qw=function(){"use strict";function t(n){var r,i;if(e(s)(this,t),void 0===n.host){if(void 0!==n.ssl)throw new Ep(bp.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=n.host,this.ssl=null===(r=n.ssl)||void 0===r||r;if(this.credentials=n.credentials,this.ignoreUndefinedProperties=!!n.ignoreUndefinedProperties,this.localCache=n.localCache,void 0===n.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new Ep(bp.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=n.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Ep(bp.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",n.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",n.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!n.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===n.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!n.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Lw(null!==(i=n.experimentalLongPollingOptions)&&void 0!==i?i:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Ep(bp.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new Ep(bp.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new Ep(bp.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!n.useFetchStreams}return e(u)(t,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}]),t}(),zw=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this._authCredentials=n,this._appCheckCredentials=r,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qw({}),this._settingsFrozen=!1}return e(u)(t,[{key:"app",get:function(){if(!this._app)throw new Ep(bp.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new Ep(bp.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qw(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new xp;switch(e.type){case"firstParty":return new Rp(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ep(bp.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=Mw.get(e))&&(vp("ComponentProvider","Removing Datastore"),Mw.delete(e),t.terminate()),Promise.resolve();var e,t}}]),t}();function Hw(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=Vw(e,zw))._getSettings(),o="".concat(t,":").concat(n);if("firestore.googleapis.com"!==a.host&&a.host!==o&&mp("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),i.mockUserToken){var s,u;if("string"==typeof i.mockUserToken)s=i.mockUserToken,u=hp.MOCK_USER;else{s=be(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new Ep(bp.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new hp(c)}e._authCredentials=new Cp(new Tp(s,u))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ww=function(){"use strict";function t(n,r,i){e(s)(this,t),this.converter=r,this._query=i,this.type="query",this.firestore=n}return e(u)(t,[{key:"withConverter",value:function(e){return new t(this.firestore,e,this._query)}}]),t}(),Kw=function(){"use strict";function t(n,r,i){e(s)(this,t),this.converter=r,this._key=i,this.type="document",this.firestore=n}return e(u)(t,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new Gw(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(e){return new t(this.firestore,e,this._key)}}]),t}(),Gw=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this,t,i,Ey(a)))._path=a,o.type="collection",e(Vc)(o)}return e(u)(r,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new Kw(this.firestore,null,new zp(e))}},{key:"withConverter",value:function(e){return new r(this.firestore,e,this._path)}}]),r}(Ww);function Qw(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(t=nt(t),Uw("collection","path",n),t instanceof zw){var o,s=(o=jp).fromString.apply(o,[n].concat(e(h)(i)));return Bw(s),new Gw(t,null,s)}var u;if(!(t instanceof Kw||t instanceof Gw))throw new Ep(bp.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=t._path.child((u=jp).fromString.apply(u,[n].concat(e(h)(i))));return Bw(c),new Gw(t.firestore,null,c)}function Yw(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(t=nt(t),1===arguments.length&&(n=Dp.newId()),Uw("doc","path",n),t instanceof zw){var o,s=(o=jp).fromString.apply(o,[n].concat(e(h)(i)));return Fw(s),new Kw(t,null,new zp(s))}var u;if(!(t instanceof Kw||t instanceof Gw))throw new Ep(bp.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=t._path.child((u=jp).fromString.apply(u,[n].concat(e(h)(i))));return Fw(c),new Kw(t.firestore,t instanceof Gw?t.converter:null,new zp(c))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Jw=function(){"use strict";function t(){var n=this;e(s)(this,t),this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new xk(this,"async_queue_retry"),this.iu=function(){var e=Ik();e&&vp("AsyncQueue","Visibility state changed to "+e.visibilityState),n.zo.Qo()};var r=Ik();r&&"function"==typeof r.addEventListener&&r.addEventListener("visibilitychange",this.iu)}return e(u)(t,[{key:"isShuttingDown",get:function(){return this.Za}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.su(),this.ou(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Za){this.Za=!0,this.nu=e||!1;var t=Ik();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.iu)}}},{key:"enqueue",value:function(e){var t=this;if(this.su(),this.Za)return new Promise((function(){}));var n=new Ip;return this.ou((function(){return t.Za&&t.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Ya.push(e),t._u()}))}},{key:"_u",value:function(){var t=this;return e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===t.Ya.length){e.next=14;break}return e.prev=1,e.next=4,t.Ya[0]();case 4:t.Ya.shift(),t.zo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),ev(e.t0)){e.next=12;break}throw e.t0;case 12:vp("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:t.Ya.length>0&&t.zo.ko((function(){return t._u()}));case 14:case"end":return e.stop()}}),n,null,[[1,8]])})))()}},{key:"ou",value:function(e){var t=this,n=this.Ja.then((function(){return t.tu=!0,e().catch((function(e){var n,r;throw t.eu=e,t.tu=!1,yp("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e})).then((function(e){return t.tu=!1,e}))}));return this.Ja=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.su(),this.ru.indexOf(e)>-1&&(t=0);var i=__.createAndSchedule(this,e,t,n,(function(e){return r.au(e)}));return this.Xa.push(i),i}},{key:"su",value:function(){this.eu&&kp()}},{key:"verifyOperationInProgress",value:function(){}},{key:"uu",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:return r=t.Ja,e.next=4,r;case 4:if(r!==t.Ja){e.next=1;break}case 5:case"end":return e.stop()}}),n)})))()}},{key:"cu",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.Xa[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.timerId===e)return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"lu",value:function(e){var t=this;return this.uu().then((function(){t.Xa.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n=!0,r=!1,i=void 0;try{for(var a,o=t.Xa[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(s.skipDelay(),"all"!==e&&s.timerId===e)break}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t.uu()}))}},{key:"hu",value:function(e){this.ru.push(e)}},{key:"au",value:function(e){var t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}]),t}();var Xw=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a,o){var u;return e(s)(this,r),(u=n.call(this,t,i,a,o)).type="firestore",u._queue=new Jw,u._persistenceKey=(null==o?void 0:o.name)||"[DEFAULT]",e(Vc)(u)}return e(u)(r,[{key:"_terminate",value:function(){return this._firestoreClient||Zw(this),this._firestoreClient.terminate()}}]),r}(zw);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(e){return e._firestoreClient||Zw(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Zw(e){var t,n,r,i,a,o,s,u=e._freezeSettings(),c=(i=e._databaseId,a=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",o=e._persistenceKey,new Cv(i,a,o,(s=u).host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,Lw(s.experimentalLongPollingOptions),s.useFetchStreams));e._firestoreClient=new ww(e._authCredentials,e._appCheckCredentials,e._queue,c),(null===(n=u.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=u.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:u.localCache.kind,_offline:u.localCache._offlineComponentProvider,_online:u.localCache._onlineComponentProvider})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var eb=function(){"use strict";function t(n){e(s)(this,t),this._byteString=n}return e(u)(t,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(e){try{return new t(kv.fromBase64String(e))}catch(e){throw new Ep(bp.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}},{key:"fromUint8Array",value:function(e){return new t(kv.fromUint8Array(e))}}]),t}(),tb=function(){"use strict";function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e(s)(this,t);for(var a=0;a<r.length;++a)if(0===r[a].length)throw new Ep(bp.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qp(r)}return e(u)(t,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var nb=function t(n){"use strict";e(s)(this,t),this._methodName=n},rb=function(){"use strict";function t(n,r){if(e(s)(this,t),!isFinite(n)||n<-90||n>90)throw new Ep(bp.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+n);if(!isFinite(r)||r<-180||r>180)throw new Ep(bp.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=n,this._long=r}return e(u)(t,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return Lp(this._lat,e._lat)||Lp(this._long,e._long)}}]),t}(),ib=/^__.*__$/,ab=function(){"use strict";function t(n,r,i){e(s)(this,t),this.data=n,this.fieldMask=r,this.fieldTransforms=i}return e(u)(t,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new Im(e,this.data,this.fieldMask,t,this.fieldTransforms):new Em(e,this.data,t,this.fieldTransforms)}}]),t}(),ob=function(){"use strict";function t(n,r,i){e(s)(this,t),this.data=n,this.fieldMask=r,this.fieldTransforms=i}return e(u)(t,[{key:"toMutation",value:function(e,t){return new Im(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw kp()}}var ub=function(){"use strict";function t(n,r,i,a,o,u){e(s)(this,t),this.settings=n,this.databaseId=r,this.serializer=i,this.ignoreUndefinedProperties=a,void 0===o&&this.Pu(),this.fieldTransforms=o||[],this.fieldMask=u||[]}return e(u)(t,[{key:"path",get:function(){return this.settings.path}},{key:"Iu",get:function(){return this.settings.Iu}},{key:"Tu",value:function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"Eu",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Tu({path:n,du:!1});return r.Au(e),r}},{key:"Ru",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Tu({path:n,du:!1});return r.Pu(),r}},{key:"Vu",value:function(e){return this.Tu({path:void 0,du:!0})}},{key:"mu",value:function(e){return Tb(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"Pu",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.Au(this.path.get(e))}},{key:"Au",value:function(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(sb(this.Iu)&&ib.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}]),t}(),cb=function(){"use strict";function t(n,r,i){e(s)(this,t),this.databaseId=n,this.ignoreUndefinedProperties=r,this.serializer=i||Tk(n)}return e(u)(t,[{key:"pu",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new ub({Iu:e,methodName:t,gu:n,path:qp.emptyPath(),du:!1,fu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}]),t}();function lb(e){var t=e._freezeSettings(),n=Tk(e._databaseId);return new cb(e._databaseId,!!t.ignoreUndefinedProperties,n)}function hb(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.pu(a.merge||a.mergeFields?2:0,t,n,i);wb("Data must be an object, but it was:",o,r);var s,u,c=kb(r,o);if(a.merge)s=new yv(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l=[],h=!0,f=!1,d=void 0;try{for(var p,v=a.mergeFields[Symbol.iterator]();!(h=(p=v.next()).done);h=!0){var y=p.value,m=bb(t,y,n);if(!o.contains(m))throw new Ep(bp.INVALID_ARGUMENT,"Field '".concat(m,"' is specified in your field mask but missing from your input data."));xb(l,m)||l.push(m)}}catch(e){f=!0,d=e}finally{try{h||null==v.return||v.return()}finally{if(f)throw d}}s=new yv(l),u=o.fieldTransforms.filter((function(e){return s.covers(e.field)}))}else s=null,u=o.fieldTransforms;return new ab(new Wv(c),s,u)}var fb=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(u)(r,[{key:"_toFieldTransform",value:function(e){if(2!==e.Iu)throw 1===e.Iu?e.mu("".concat(this._methodName,"() can only appear at the top level of your update data")):e.mu("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof r}}]),r}(nb);function db(e,t,n){return new ub({Iu:3,gu:t.settings.gu,methodName:e._methodName,du:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}var pb=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t)).yu=i,e(Vc)(a)}return e(u)(r,[{key:"_toFieldTransform",value:function(e){var t=db(this,e,!0),n=this.yu.map((function(e){return gb(e,t)})),r=new om(n);return new dm(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),r}(nb);function vb(e,t,n,r){var i=e.pu(1,t,n);wb("Data must be an object, but it was:",i,r);var a=[],o=Wv.empty();cv(r,(function(e,r){var s=Ib(t,e,n);r=nt(r);var u=i.Ru(s);if(r instanceof fb)a.push(s);else{var c=gb(r,u);null!=c&&(a.push(s),o.set(s,c))}}));var s=new yv(a);return new ob(o,s,i.fieldTransforms)}function yb(e,t,n,r,i,a){var o=e.pu(1,t,n),s=[bb(t,r,n)],u=[i];if(a.length%2!=0)throw new Ep(bp.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(bb(t,a[c])),u.push(a[c+1]);for(var l=[],h=Wv.empty(),f=s.length-1;f>=0;--f)if(!xb(l,s[f])){var d=s[f],p=u[f];p=nt(p);var v=o.Ru(d);if(p instanceof fb)l.push(d);else{var y=gb(p,v);null!=y&&(l.push(d),h.set(d,y))}}var m=new yv(l);return new ob(h,m,o.fieldTransforms)}function mb(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return gb(n,e.pu(r?4:3,t))}function gb(e,t){if(_b(e=nt(e)))return wb("Unsupported field value:",t,e),kb(e,t);if(e instanceof nb)return function(e,t){if(!sb(t.Iu))throw t.mu("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.mu("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.du&&4!==t.Iu)throw t.mu("Nested arrays are not supported");return function(e,t){var n=[],r=0,i=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=gb(s.value,t.Vu(r));null==c&&(c={nullValue:"NULL_VALUE"}),n.push(c),r++}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=nt(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return em(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=Up.fromDate(e);return{timestampValue:ag(t.serializer,n)}}if(e instanceof Up){var r=new Up(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ag(t.serializer,r)}}if(e instanceof rb)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof eb)return{bytesValue:og(t.serializer,e._byteString)};if(e instanceof Kw){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.mu("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:cg(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.mu("Unsupported field value: ".concat(jw(e)))}(e,t)}function kb(e,t){var n={};return lv(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):cv(e,(function(e,r){var i=gb(r,t.Eu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function _b(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Up||e instanceof rb||e instanceof eb||e instanceof Kw||e instanceof nb)}function wb(e,t,n){if(!_b(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){var r=jw(n);throw"an object"===r?t.mu(e+" a custom object"):t.mu(e+" "+r)}var i}function bb(e,t,n){if((t=nt(t))instanceof tb)return t._internalPath;if("string"==typeof t)return Ib(e,t);throw Tb("Field path arguments must be of type string or ",e,!1,void 0,n)}var Eb=new RegExp("[~\\*/\\[\\]]");function Ib(t,n,r){if(n.search(Eb)>=0)throw Tb("Invalid field path (".concat(n,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,r);try{return e(Lc)(tb,e(h)(n.split(".")))._internalPath}catch(e){throw Tb("Invalid field path (".concat(n,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,r)}}function Tb(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new Ep(bp.INVALID_ARGUMENT,s+e+u)}function xb(e,t){return e.some((function(e){return e.isEqual(t)}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cb=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this._firestore=n,this._userDataWriter=r,this._key=i,this._document=a,this._converter=o}return e(u)(t,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new Kw(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new Sb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(Ab("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),t}(),Sb=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(u)(r,[{key:"data",value:function(){return e(Mc)(e(jc)(r.prototype),"data",this).call(this)}}]),r}(Cb);function Ab(e,t){return"string"==typeof t?Ib(e,t):t instanceof tb?t._internalPath:t._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rb(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Ep(bp.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Nb=function t(){"use strict";e(s)(this,t)},Ob=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return r}(Nb);function Pb(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var a=[];t instanceof Nb&&a.push(t),function(e){var t=e.filter((function(e){return e instanceof Mb})).length,n=e.filter((function(e){return e instanceof Db})).length;if(t>1||t>0&&n>0)throw new Ep(bp.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a=a.concat(r));var o=!0,s=!1,u=void 0;try{for(var c,l=a[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;e=h._apply(e)}}catch(e){s=!0,u=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return e}var Db=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this))._field=t,o._op=i,o._value=a,o.type="where",e(Vc)(o)}return e(u)(r,[{key:"_apply",value:function(e){var t=this._parse(e);return Bb(e._query,t),new Ww(e.firestore,e.converter,Ay(e._query,t))}},{key:"_parse",value:function(e){var t=lb(e.firestore);return function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Ep(bp.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){Fb(o,a);var u=[],c=!0,l=!1,h=void 0;try{for(var f,d=o[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var p=f.value;u.push(Ub(r,e,p))}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}s={arrayValue:{values:u}}}else s=Ub(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||Fb(o,a),s=mb(n,t,o,"in"===a||"not-in"===a);return ey.create(i,a,s)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}],[{key:"_create",value:function(e,t,n){return new r(e,t,n)}}]),r}(Ob);function Lb(e,t,n){var r=t,i=Ab("where",e);return Db._create(i,r,n)}var Mb=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).type=t,a._queryConstraints=i,e(Vc)(a)}return e(u)(r,[{key:"_parse",value:function(e){var t=this._queryConstraints.map((function(t){return t._parse(e)})).filter((function(e){return e.getFilters().length>0}));return 1===t.length?t[0]:ty.create(t,this._getOperator())}},{key:"_apply",value:function(e){var t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){var n=e,r=t.getFlattenedFilters(),i=!0,a=!1,o=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;Bb(n,c),n=Ay(n,c)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}}(e._query,t),new Ww(e.firestore,e.converter,Ay(e._query,t)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(e,t){return new r(e,t)}}]),r}(Nb);function Ub(e,t,n){if("string"==typeof(n=nt(n))){if(""===n)throw new Ep(bp.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ty(t)&&-1!==n.indexOf("/"))throw new Ep(bp.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(jp.fromString(n));if(!zp.isDocumentKey(r))throw new Ep(bp.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Uv(e,new zp(r))}if(n instanceof Kw)return Uv(e,n._key);throw new Ep(bp.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(jw(n),"."))}function Fb(e,t){if(!Array.isArray(e)||0===e.length)throw new Ep(bp.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Bb(e,t){var n=function(e,t){var n=!0,r=!1,i=void 0,a=!0,o=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;try{for(var h,f=l.getFlattenedFilters()[Symbol.iterator]();!(n=(h=f.next()).done);n=!0){var d=h.value;if(t.indexOf(d.op)>=0)return d.op}}catch(e){r=!0,i=e}finally{try{n||null==f.return||f.return()}finally{if(r)throw i}}}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Ep(bp.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Ep(bp.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}var jb=function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Rv(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bv(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ev(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw kp()}}},{key:"convertObject",value:function(e,t){return this.convertObjectMap(e.fields,t)}},{key:"convertObjectMap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",n=this,r={};return cv(e,(function(e,i){r[e]=n.convertValue(i,t)})),r}},{key:"convertGeoPoint",value:function(e){return new rb(bv(e.latitude),bv(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=Tv(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(xv(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=wv(e);return new Up(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=jp.fromString(e);_p(Sg(n));var r=new Sv(n.get(1),n.get(3)),i=new zp(n.popFirst(5));return r.isEqual(t)||yp("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vb(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var qb=function(){"use strict";function t(n,r){e(s)(this,t),this.hasPendingWrites=n,this.fromCache=r}return e(u)(t,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),t}(),zb=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a,o,u,c){var l;return e(s)(this,r),(l=n.call(this,t,i,a,o,c))._firestore=t,l._firestoreImpl=t,l.metadata=u,e(Vc)(l)}return e(u)(r,[{key:"exists",value:function(){return e(Mc)(e(jc)(r.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new Hb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(Ab("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),r}(Cb),Hb=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(u)(r,[{key:"data",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e(Mc)(e(jc)(r.prototype),"data",this).call(this,t)}}]),r}(zb),Wb=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this._firestore=n,this._userDataWriter=r,this._snapshot=a,this.metadata=new qb(a.hasPendingWrites,a.fromCache),this.query=i}return e(u)(t,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new Hb(n._firestore,n._userDataWriter,r.key,r,new qb(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ep(bp.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new Hb(e._firestore,e._userDataWriter,t.doc.key,t.doc,new qb(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new Hb(e._firestore,e._userDataWriter,t.doc.key,t.doc,new qb(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:Kb(t.type),doc:n,oldIndex:i,newIndex:a}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),t}();function Kb(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kp()}}var Gb=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).firestore=t,e(Vc)(i)}return e(u)(r,[{key:"convertBytes",value:function(e){return new eb(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Kw(this.firestore,null,t)}}]),r}(jb);function Qb(e){e=Vw(e,Ww);var t=Vw(e.firestore,Xw),n=$w(t),r=new Gb(t);return Rb(e._query),Dw(n,e._query).then((function(n){return new Wb(t,r,e,n)}))}function Yb(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];e=Vw(e,Kw);var o=Vw(e.firestore,Xw),s=lb(o);return Xb(o,[("string"==typeof(t=nt(t))||t instanceof tb?yb(s,"updateDoc",e._key,t,n,i):vb(s,"updateDoc",e._key,t)).toMutation(e._key,vm.exists(!0))])}function Jb(e,t){var n=Vw(e.firestore,Xw),r=Yw(e),i=Vb(e.converter,t);return Xb(n,[hb(lb(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,vm.exists(!1))]).then((function(){return r}))}function Xb(t,n){return r=$w(t),i=n,o=new Ip,r.asyncQueue.enqueueAndForget(e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=G_,e.next=3,Nw(r);case 3:return e.t1=e.sent,e.t2=i,e.t3=o,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}}),t)})))),o.promise;var r,i,o}function $b(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new pb("arrayUnion",t)}new WeakMap;
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];fp=Xt,Kt(new rt("firestore",(function(e,n){var r=n.instanceIdentifier,i=n.options,a=e.getProvider("app").getImmediate(),o=new Xw(new Sp(e.getProvider("auth-internal")),new Op(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Ep(bp.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sv(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),en(lp,"4.3.2",e),en(lp,"4.3.2","esm2017")}();T=i("ds8z5"),l=i("hKHmD"),jc=i("fVNic");function Zb(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;function eE(){return e(l)({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var tE=eE,nE=new Oe("auth","Firebase",eE()),rE=new vt("@firebase/auth");function iE(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a;rE.logLevel<=ot.WARN&&(a=rE).warn.apply(a,["Auth (".concat(Xt,"): ").concat(t)].concat(e(h)(r)))}function aE(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a;rE.logLevel<=ot.ERROR&&(a=rE).error.apply(a,["Auth (".concat(Xt,"): ").concat(t)].concat(e(h)(r)))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];throw cE.apply(void 0,[t].concat(e(h)(r)))}function sE(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return cE.apply(void 0,[t].concat(e(h)(r)))}function uE(t,n,r){var i=Object.assign(Object.assign({},tE()),e(l)({},n,r));return new Oe("auth","Firebase",i).create(n,{appName:t.name})}function cE(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a;if("string"!=typeof t){var o,s=r[0],u=e(h)(r.slice(1));return u[0]&&(u[0].appName=t.name),(o=t._errorFactory).create.apply(o,[s].concat(e(h)(u)))}return(a=nE).create.apply(a,[t].concat(e(h)(r)))}function lE(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(!t)throw cE.apply(void 0,[n].concat(e(h)(i)))}function hE(e){var t="INTERNAL ASSERTION FAILED: "+e;throw aE(t),new Error(t)}function fE(e,t){e||hE(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dE(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function pE(){return"http:"===vE()||"https:"===vE()}function vE(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var yE=function(){"use strict";function t(n,r){e(s)(this,t),this.shortDelay=n,this.longDelay=r,fE(r>n,"Short delay should be less than long delay!"),this.isMobile=Ie()||xe()}return e(u)(t,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(pE()||Te()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(e,t){fE(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gE,kE=function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void hE("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void hE("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void hE("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),t}(),_E=(gE={},e(l)(gE,"CREDENTIAL_MISMATCH","custom-token-mismatch"),e(l)(gE,"MISSING_CUSTOM_TOKEN","internal-error"),e(l)(gE,"INVALID_IDENTIFIER","invalid-email"),e(l)(gE,"MISSING_CONTINUE_URI","internal-error"),e(l)(gE,"INVALID_PASSWORD","wrong-password"),e(l)(gE,"MISSING_PASSWORD","missing-password"),e(l)(gE,"EMAIL_EXISTS","email-already-in-use"),e(l)(gE,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),e(l)(gE,"INVALID_IDP_RESPONSE","invalid-credential"),e(l)(gE,"INVALID_PENDING_TOKEN","invalid-credential"),e(l)(gE,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),e(l)(gE,"MISSING_REQ_TYPE","internal-error"),e(l)(gE,"EMAIL_NOT_FOUND","user-not-found"),e(l)(gE,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),e(l)(gE,"EXPIRED_OOB_CODE","expired-action-code"),e(l)(gE,"INVALID_OOB_CODE","invalid-action-code"),e(l)(gE,"MISSING_OOB_CODE","internal-error"),e(l)(gE,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),e(l)(gE,"INVALID_ID_TOKEN","invalid-user-token"),e(l)(gE,"TOKEN_EXPIRED","user-token-expired"),e(l)(gE,"USER_NOT_FOUND","user-token-expired"),e(l)(gE,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),e(l)(gE,"PASSWORD_DOES_NOT_MEET_REQUIREMENTS","password-does-not-meet-requirements"),e(l)(gE,"INVALID_CODE","invalid-verification-code"),e(l)(gE,"INVALID_SESSION_INFO","invalid-verification-id"),e(l)(gE,"INVALID_TEMPORARY_PROOF","invalid-credential"),e(l)(gE,"MISSING_SESSION_INFO","missing-verification-id"),e(l)(gE,"SESSION_EXPIRED","code-expired"),e(l)(gE,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),e(l)(gE,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),e(l)(gE,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),e(l)(gE,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),e(l)(gE,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),e(l)(gE,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),e(l)(gE,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),e(l)(gE,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),e(l)(gE,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),e(l)(gE,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),e(l)(gE,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),e(l)(gE,"RECAPTCHA_NOT_ENABLED","recaptcha-not-enabled"),e(l)(gE,"MISSING_RECAPTCHA_TOKEN","missing-recaptcha-token"),e(l)(gE,"INVALID_RECAPTCHA_TOKEN","invalid-recaptcha-token"),e(l)(gE,"INVALID_RECAPTCHA_ACTION","invalid-recaptcha-action"),e(l)(gE,"MISSING_CLIENT_TYPE","missing-client-type"),e(l)(gE,"MISSING_RECAPTCHA_VERSION","missing-recaptcha-version"),e(l)(gE,"INVALID_RECAPTCHA_VERSION","invalid-recaptcha-version"),e(l)(gE,"INVALID_REQ_TYPE","invalid-req-type"),gE),wE=new yE(3e4,6e4);function bE(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function EE(e,t,n,r){return IE.apply(this,arguments)}function IE(){return IE=e(a)(e(m).mark((function t(n,r,i,o){var s,u=arguments;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=u.length>4&&void 0!==u[4]?u[4]:{},t.abrupt("return",TE(n,s,e(a)(e(m).mark((function t(){var a,s,u,c;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},s={},o&&("GET"===r?s=o:a={body:JSON.stringify(o)}),u=We(Object.assign({key:n.config.apiKey},s)).slice(1),e.next=6,n._getAdditionalHeaders();case 6:return(c=e.sent)["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode),e.abrupt("return",kE.fetch()(AE(n,n.config.apiHost,i,u),Object.assign({method:r,headers:c,referrerPolicy:"no-referrer"},a)));case 10:case"end":return e.stop()}}),t)})))));case 2:case"end":return t.stop()}}),t)}))),IE.apply(this,arguments)}function TE(e,t,n){return xE.apply(this,arguments)}function xE(){return(xE=e(a)(e(m).mark((function t(n,r,i){var a,o,s,u,c,l,h,f,d;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n._canInitEmulator=!1,a=Object.assign(Object.assign({},_E),r),t.prev=2,o=new NE(n),t.next=6,Promise.race([i(),o.promise]);case 6:return s=t.sent,o.clearNetworkTimeout(),t.next=10,s.json();case 10:if(!("needConfirmation"in(u=t.sent))){t.next=13;break}throw OE(n,"account-exists-with-different-credential",u);case 13:if(!s.ok||"errorMessage"in u){t.next=17;break}return t.abrupt("return",u);case 17:if(c=s.ok?u.errorMessage:u.error.message,l=e(k)(c.split(" : "),2),h=l[0],f=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==h){t.next=23;break}throw OE(n,"credential-already-in-use",u);case 23:if("EMAIL_EXISTS"!==h){t.next=27;break}throw OE(n,"email-already-in-use",u);case 27:if("USER_DISABLED"!==h){t.next=29;break}throw OE(n,"user-disabled",u);case 29:if(d=a[h]||h.toLowerCase().replace(/[_\s]+/g,"-"),!f){t.next=34;break}throw uE(n,d,f);case 34:oE(n,d);case 35:t.next=42;break;case 37:if(t.prev=37,t.t0=t.catch(2),!(t.t0 instanceof Ne)){t.next=41;break}throw t.t0;case 41:oE(n,"network-request-failed",{message:String(t.t0)});case 42:case"end":return t.stop()}}),t,null,[[2,37]])})))).apply(this,arguments)}function CE(e,t,n,r){return SE.apply(this,arguments)}function SE(){return SE=e(a)(e(m).mark((function t(n,r,i,a){var o,s,u=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=u.length>4&&void 0!==u[4]?u[4]:{},e.next=3,EE(n,r,i,a,o);case 3:return"mfaPendingCredential"in(s=e.sent)&&oE(n,"multi-factor-auth-required",{_serverResponse:s}),e.abrupt("return",s);case 6:case"end":return e.stop()}}),t)}))),SE.apply(this,arguments)}function AE(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?mE(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}function RE(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var NE=function(){"use strict";function t(n){var r=this;e(s)(this,t),this.auth=n,this.timer=null,this.promise=new Promise((function(e,t){var n=r;r.timer=setTimeout((function(){return t(sE(n.auth,"network-request-failed"))}),wE.get())}))}return e(u)(t,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),t}();function OE(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=sE(e,t,r);return i.customData._tokenResponse=n,i}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(e){return void 0!==e&&void 0!==e.enterprise}var DE=function(){"use strict";function t(n){if(e(s)(this,t),this.siteKey="",this.recaptchaEnforcementState=[],void 0===n.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=n.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=n.recaptchaEnforcementState}return e(u)(t,[{key:"getProviderEnforcementState",value:function(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;var t=!0,n=!1,r=void 0;try{for(var i,a=this.recaptchaEnforcementState[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(o.provider&&o.provider===e)return RE(o.enforcementState)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}},{key:"isProviderEnabled",value:function(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}]),t}();function LE(e,t){return ME.apply(this,arguments)}function ME(){return(ME=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",EE(n,"GET","/v2/recaptchaConfig",bE(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function UE(e,t){return FE.apply(this,arguments)}function FE(){return(FE=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",EE(n,"POST","/v1/accounts:delete",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function BE(e,t){return jE.apply(this,arguments)}function jE(){return(jE=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",EE(n,"POST","/v1/accounts:lookup",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VE(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qE(){return qE=e(a)(e(m).mark((function t(n){var r,i,a,o,s,u,c=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>1&&void 0!==c[1]&&c[1],i=nt(n),e.next=4,i.getIdToken(r);case 4:return a=e.sent,lE((o=HE(a))&&o.exp&&o.auth_time&&o.iat,i.auth,"internal-error"),s="object"==typeof o.firebase?o.firebase:void 0,u=null==s?void 0:s.sign_in_provider,e.abrupt("return",{claims:o,token:a,authTime:VE(zE(o.auth_time)),issuedAtTime:VE(zE(o.iat)),expirationTime:VE(zE(o.exp)),signInProvider:u||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),t)}))),qE.apply(this,arguments)}function zE(e){return 1e3*Number(e)}function HE(t){var n=e(k)(t.split("."),3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return aE("JWT malformed, contained fewer than 3 sections"),null;try{var o=fe(i);return o?JSON.parse(o):(aE("Failed to decode base64 JWT payload"),null)}catch(e){return aE("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function WE(e,t){return KE.apply(this,arguments)}function KE(){return KE=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){var i=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.length>2&&void 0!==i[2]&&i[2])){e.next=3;break}return e.abrupt("return",r);case 3:return e.prev=3,e.next=6,r;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof Ne&&GE(e.t0))){e.next=15;break}if(n.auth.currentUser!==n){e.next=15;break}return e.next=15,n.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),t,null,[[3,9]])}))),KE.apply(this,arguments)}function GE(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var QE=function(){"use strict";function t(n){e(s)(this,t),this.user=n,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return e(u)(t,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t),r=this;this.timerId=setTimeout(e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.iteration();case 2:case"end":return e.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var t=this;return e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),"auth/network-request-failed"===(null===e.t0||void 0===e.t0?void 0:e.t0.code)&&t.schedule(!0),e.abrupt("return");case 9:t.schedule();case 10:case"end":return e.stop()}}),n,null,[[0,5]])})))()}}]),t}(),YE=function(){"use strict";function t(n,r){e(s)(this,t),this.createdAt=n,this.lastLoginAt=r,this._initializeTime()}return e(u)(t,[{key:"_initializeTime",value:function(){this.lastSignInTime=VE(this.lastLoginAt),this.creationTime=VE(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(e){return XE.apply(this,arguments)}function XE(){return(XE=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n){var r,i,a,o,s,u,c,l,h,f,d;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.auth,e.next=4,n.getIdToken();case 4:return a=e.sent,e.next=7,WE(n,BE(i,{idToken:a}));case 7:lE(null==(o=e.sent)?void 0:o.users.length,i,"internal-error"),s=o.users[0],n._notifyReloadListener(s),u=(null===(r=s.providerUserInfo)||void 0===r?void 0:r.length)?eI(s.providerUserInfo):[],c=ZE(n.providerData,u),l=n.isAnonymous,h=!(n.email&&s.passwordHash||(null==c?void 0:c.length)),f=!!l&&h,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new YE(s.createdAt,s.lastLoginAt),isAnonymous:f},Object.assign(n,d);case 18:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function $E(){return($E=e(a)(e(m).mark((function t(n){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=nt(n),e.next=3,JE(r);case 3:return e.next=5,r.auth._persistUserIfCurrent(r);case 5:r.auth._notifyListenersIfCurrent(r);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ZE(t,n){var r=t.filter((function(e){return!n.some((function(t){return t.providerId===e.providerId}))}));return e(h)(r).concat(e(h)(n))}function eI(e){return e.map((function(e){var t=e.providerId,n=Zb(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}function tI(e,t){return nI.apply(this,arguments)}function nI(){return(nI=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){var i;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,TE(n,{},e(a)(e(m).mark((function t(){var i,a,o,s,u,c;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=We({grant_type:"refresh_token",refresh_token:r}).slice(1),a=n.config,o=a.tokenApiHost,s=a.apiKey,u=AE(n,o,"/v1/token","key=".concat(s)),e.next=5,n._getAdditionalHeaders();case 5:return(c=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",kE.fetch()(u,{method:"POST",headers:c,body:i}));case 8:case"end":return e.stop()}}),t)}))));case 2:return i=t.sent,t.abrupt("return",{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token});case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function rI(e,t){return iI.apply(this,arguments)}function iI(){return(iI=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",EE(n,"POST","/v2/accounts:revokeToken",bE(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var aI=function(){"use strict";function t(){e(s)(this,t),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return e(u)(t,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){lE(e.idToken,"internal-error"),lE(void 0!==e.idToken,"internal-error"),lE(void 0!==e.refreshToken,"internal-error");var t,n,r="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):(t=e.idToken,lE(n=HE(t),"internal-error"),lE(void 0!==n.exp,"internal-error"),lE(void 0!==n.iat,"internal-error"),Number(n.exp)-Number(n.iat));this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}},{key:"getToken",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(a)(e(m).mark((function i(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(lE(!r.accessToken||r.refreshToken,t,"user-token-expired"),n||!r.accessToken||r.isExpired){e.next=3;break}return e.abrupt("return",r.accessToken);case 3:if(!r.refreshToken){e.next=7;break}return e.next=6,r.refresh(t,r.refreshToken);case 6:return e.abrupt("return",r.accessToken);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),i)})))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(t,n){var r=this;return e(a)(e(m).mark((function i(){var a,o,s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tI(t,n);case 2:a=e.sent,o=a.accessToken,s=a.refreshToken,u=a.expiresIn,r.updateTokensAndExpiration(o,s,Number(u));case 7:case"end":return e.stop()}}),i)})))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new t,this.toJSON())}},{key:"_performRefresh",value:function(){return hE("not implemented")}}],[{key:"fromJSON",value:function(e,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new t;return r&&(lE("string"==typeof r,"internal-error",{appName:e}),o.refreshToken=r),i&&(lE("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),a&&(lE("number"==typeof a,"internal-error",{appName:e}),o.expirationTime=a),o}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(e,t){lE("string"==typeof e||void 0===e,"internal-error",{appName:t})}var sI=function(){"use strict";function t(n){e(s)(this,t);var r=n.uid,i=n.auth,a=n.stsTokenManager,o=Zb(n,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new QE(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=i,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?e(h)(o.providerData):[],this.metadata=new YE(o.createdAt||void 0,o.lastLoginAt||void 0)}return e(u)(t,[{key:"getIdToken",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,WE(n,n.stsTokenManager.getToken(n.auth,t));case 2:if(lE(i=e.sent,n.auth,"internal-error"),n.accessToken===i){e.next=9;break}return n.accessToken=i,e.next=8,n.auth._persistUserIfCurrent(n);case 8:n.auth._notifyListenersIfCurrent(n);case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),r)})))()}},{key:"getIdTokenResult",value:function(e){return function(e){return qE.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return $E.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(lE(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(e){var n=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}},{key:"_onReload",value:function(e){lE(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(a)(e(m).mark((function i(){var a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!1,t.idToken&&t.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(t),a=!0),!n){e.next=5;break}return e.next=5,JE(r);case 5:return e.next=7,r.auth._persistUserIfCurrent(r);case 7:a&&r.auth._notifyListenersIfCurrent(r);case 8:case"end":return e.stop()}}),i)})))()}},{key:"delete",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getIdToken();case 2:return r=e.sent,e.next=5,WE(t,UE(t.auth,{idToken:r}));case 5:return t.stsTokenManager.clearRefreshToken(),e.abrupt("return",t.auth.signOut());case 7:case"end":return e.stop()}}),n)})))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(e,n){var r,i,a,o,s,u,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,p=null!==(o=n.photoURL)&&void 0!==o?o:void 0,v=null!==(s=n.tenantId)&&void 0!==s?s:void 0,y=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,m=null!==(c=n.createdAt)&&void 0!==c?c:void 0,g=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,_=n.emailVerified,w=n.isAnonymous,b=n.providerData,E=n.stsTokenManager;lE(k&&E,e,"internal-error");var I=aI.fromJSON(this.name,E);lE("string"==typeof k,e,"internal-error"),oI(h,e.name),oI(f,e.name),lE("boolean"==typeof _,e,"internal-error"),lE("boolean"==typeof w,e,"internal-error"),oI(d,e.name),oI(p,e.name),oI(v,e.name),oI(y,e.name),oI(m,e.name),oI(g,e.name);var T=new t({uid:k,auth:e,email:f,emailVerified:_,displayName:h,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:v,stsTokenManager:I,createdAt:m,lastLoginAt:g});return b&&Array.isArray(b)&&(T.providerData=b.map((function(e){return Object.assign({},e)}))),y&&(T._redirectEventId=y),T}},{key:"_fromIdTokenResponse",value:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e(a)(e(m).mark((function a(){var o,s;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new aI).updateFromServerResponse(r),s=new t({uid:r.localId,auth:n,stsTokenManager:o,isAnonymous:i}),e.next=5,JE(s);case 5:return e.abrupt("return",s);case 6:case"end":return e.stop()}}),a)})))()}}]),t}(),uI=new Map;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(e){fE(e instanceof Function,"Expected a class definition");var t=uI.get(e);return t?(fE(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,uI.set(e,t),t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lI=function(){"use strict";function t(){e(s)(this,t),this.type="NONE",this.storage={}}return e(u)(t,[{key:"_isAvailable",value:function(){return e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),t)})))()}},{key:"_set",value:function(t,n){var r=this;return e(a)(e(m).mark((function i(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.storage[t]=n;case 1:case"end":return e.stop()}}),i)})))()}},{key:"_get",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.storage[t],e.abrupt("return",void 0===i?null:i);case 2:case"end":return e.stop()}}),r)})))()}},{key:"_remove",value:function(t){var n=this;return e(a)(e(m).mark((function r(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete n.storage[t];case 1:case"end":return e.stop()}}),r)})))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),t}();lI.type="NONE";var hI=lI;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var dI=function(){"use strict";function t(n,r,i){e(s)(this,t),this.persistence=n,this.auth=r,this.userKey=i;var a=this.auth,o=a.config,u=a.name;this.fullUserKey=fI(this.userKey,o.apiKey,u),this.fullPersistenceKey=fI("persistence",o.apiKey,u),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return e(u)(t,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.persistence._get(t.fullUserKey);case 2:return r=e.sent,e.abrupt("return",r?sI._fromJSON(t.auth,r):null);case 4:case"end":return e.stop()}}),n)})))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.getCurrentUser();case 4:return i=e.sent,e.next=7,n.removeCurrentUser();case 7:if(n.persistence=t,!i){e.next=10;break}return e.abrupt("return",n.setCurrentUser(i));case 10:case"end":return e.stop()}}),r)})))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return e(a)(e(m).mark((function o(){var s,u,c,l,h,f,d,p,v,y,g,k,_;return e(m).wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r.length){o.next=2;break}return o.abrupt("return",new t(cI(hI),n,i));case 2:return o.next=4,Promise.all(r.map(function(){var t=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",n);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 4:s=o.sent.filter((function(e){return e})),u=s[0]||cI(hI),c=fI(i,n.config.apiKey,n.name),l=null,h=!0,f=!1,d=void 0,o.prev=9,p=r[Symbol.iterator]();case 11:if(h=(v=p.next()).done){o.next=29;break}return y=v.value,o.prev=13,o.next=16,y._get(c);case 16:if(!(g=o.sent)){o.next=22;break}return k=sI._fromJSON(n,g),y!==u&&(l=k),u=y,o.abrupt("break",29);case 22:o.next=26;break;case 24:o.prev=24,o.t0=o.catch(13);case 26:h=!0,o.next=11;break;case 29:o.next=35;break;case 31:o.prev=31,o.t1=o.catch(9),f=!0,d=o.t1;case 35:o.prev=35,o.prev=36,h||null==p.return||p.return();case 38:if(o.prev=38,!f){o.next=41;break}throw d;case 41:return o.finish(38);case 42:return o.finish(35);case 43:if(_=s.filter((function(e){return e._shouldAllowMigration})),u._shouldAllowMigration&&_.length){o.next=46;break}return o.abrupt("return",new t(u,n,i));case 46:if(u=_[0],!l){o.next=50;break}return o.next=50,u._set(c,l.toJSON());case 50:return o.next=52,Promise.all(r.map(function(){var t=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n===u){e.next=8;break}return e.prev=1,e.next=4,n._remove(c);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),t,null,[[1,6]])})));return function(e){return t.apply(this,arguments)}}()));case 52:return o.abrupt("return",new t(u,n,i));case 53:case"end":return o.stop()}}),o,null,[[9,31,35,43],[13,24],[36,,38,42]])})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(gI(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(vI(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(_I(t))return"Blackberry";if(wI(t))return"Webos";if(yI(t))return"Safari";if((t.includes("chrome/")||mI(t))&&!t.includes("edge/"))return"Chrome";if(kI(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function vI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee();return/firefox\//i.test(e)}function yI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function mI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee();return/crios\//i.test(e)}function gI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee();return/iemobile/i.test(e)}function kI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee();return/android/i.test(e)}function _I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee();return/blackberry/i.test(e)}function wI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee();return/webos/i.test(e)}function bI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function EI(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee();return bI(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}function II(){return((e=Ee()).indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0)&&10===document.documentMode;var e}function TI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee();return bI(e)||kI(e)||wI(e)||_I(e)||/windows phone/i.test(e)||gI(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function xI(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=pI(Ee());break;case"Worker":t="".concat(pI(Ee()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(Xt,"/").concat(r)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var CI=function(){"use strict";function t(n){e(s)(this,t),this.auth=n,this.queue=[]}return e(u)(t,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(e){r(e)}}))};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i,a,o,s,u,c,l,h,f,d,p,v,y;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:i=[],e.prev=3,a=!0,o=!1,s=void 0,e.prev=5,u=n.queue[Symbol.iterator]();case 7:if(a=(c=u.next()).done){e.next=15;break}return l=c.value,e.next=11,l(t);case 11:l.onAbort&&i.push(l.onAbort);case 12:a=!0,e.next=7;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(5),o=!0,s=e.t0;case 21:e.prev=21,e.prev=22,a||null==u.return||u.return();case 24:if(e.prev=24,!o){e.next=27;break}throw s;case 27:return e.finish(24);case 28:return e.finish(21);case 29:e.next=52;break;case 31:for(e.prev=31,e.t1=e.catch(3),i.reverse(),h=!0,f=!1,d=void 0,e.prev=35,p=i[Symbol.iterator]();!(h=(v=p.next()).done);h=!0){y=v.value;try{y()}catch(e){}}e.next=43;break;case 39:e.prev=39,e.t2=e.catch(35),f=!0,d=e.t2;case 43:e.prev=43,e.prev=44,h||null==p.return||p.return();case 46:if(e.prev=46,!f){e.next=49;break}throw d;case 49:return e.finish(46);case 50:return e.finish(43);case 51:throw n.auth._errorFactory.create("login-blocked",{originalMessage:null===e.t1||void 0===e.t1?void 0:e.t1.message});case 52:case"end":return e.stop()}}),r,null,[[3,31],[5,17,21,29],[22,,24,28],[35,39,43,51],[44,,46,50]])})))()}}]),t}();function SI(e){return AI.apply(this,arguments)}function AI(){return AI=
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n){var r,i=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.abrupt("return",EE(n,"GET","/v2/passwordPolicy",bE(n,r)));case 2:case"end":return e.stop()}}),t)}))),AI.apply(this,arguments)}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var RI=function(){"use strict";function t(n){var r,i,a,o;e(s)(this,t);var u=n.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(r=u.minPasswordLength)&&void 0!==r?r:6,u.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=u.maxPasswordLength),void 0!==u.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=u.containsLowercaseCharacter),void 0!==u.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=u.containsUppercaseCharacter),void 0!==u.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=u.containsNumericCharacter),void 0!==u.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=u.containsNonAlphanumericCharacter),this.enforcementState=n.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(a=null===(i=n.allowedNonAlphanumericCharacters)||void 0===i?void 0:i.join(""))&&void 0!==a?a:"",this.forceUpgradeOnSignin=null!==(o=n.forceUpgradeOnSignin)&&void 0!==o&&o,this.schemaVersion=n.schemaVersion}return e(u)(t,[{key:"validatePassword",value:function(e){var t,n,r,i,a,o,s={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,s),this.validatePasswordCharacterOptions(e,s),s.isValid&&(s.isValid=null===(t=s.meetsMinPasswordLength)||void 0===t||t),s.isValid&&(s.isValid=null===(n=s.meetsMaxPasswordLength)||void 0===n||n),s.isValid&&(s.isValid=null===(r=s.containsLowercaseLetter)||void 0===r||r),s.isValid&&(s.isValid=null===(i=s.containsUppercaseLetter)||void 0===i||i),s.isValid&&(s.isValid=null===(a=s.containsNumericCharacter)||void 0===a||a),s.isValid&&(s.isValid=null===(o=s.containsNonAlphanumericCharacter)||void 0===o||o),s}},{key:"validatePasswordLengthOptions",value:function(e,t){var n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}},{key:"validatePasswordCharacterOptions",value:function(e,t){var n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(var r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}},{key:"updatePasswordCharacterOptionsStatuses",value:function(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}]),t}(),NI=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.app=n,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new PI(this),this.idTokenSubscription=new PI(this),this.beforeStateQueue=new CI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=n.name,this.clientVersion=a.sdkClientVersion}return e(u)(t,[{key:"_initializeWithPersistence",value:function(t,n){n&&(this._popupRedirectResolver=cI(n));var r=this;return this._initializationPromise=this.queue(e(a)(e(m).mark((function i(){var a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r._deleted){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,dI.create(r,t);case 5:if(r.persistenceManager=e.sent,!r._deleted){e.next=8;break}return e.abrupt("return");case 8:if(!(null===(a=r._popupRedirectResolver)||void 0===a?void 0:a._shouldInitProactively)){e.next=16;break}return e.prev=9,e.next=12,r._popupRedirectResolver._initialize(r);case 12:e.next=16;break;case 14:e.prev=14,e.t0=e.catch(9);case 16:return e.next=18,r.initializeCurrentUser(n);case 18:if(r.lastNotifiedUid=(null===(o=r.currentUser)||void 0===o?void 0:o.uid)||null,!r._deleted){e.next=21;break}return e.abrupt("return");case 21:r._isInitialized=!0;case 22:case"end":return e.stop()}}),i,null,[[9,14]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.assertedPersistence.getCurrentUser();case 4:if(r=e.sent,t.currentUser||r){e.next=7;break}return e.abrupt("return");case 7:if(!t.currentUser||!r||t.currentUser.uid!==r.uid){e.next=12;break}return t._currentUser._assign(r),e.next=11,t.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,t._updateCurrentUser(r,!0);case 14:case"end":return e.stop()}}),n)})))()}},{key:"initializeCurrentUser",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i,a,o,s,u,c,l;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,n.assertedPersistence.getCurrentUser();case 3:if(a=e.sent,o=a,s=!1,!t||!n.config.authDomain){e.next=15;break}return e.next=9,n.getOrInitRedirectPersistenceManager();case 9:return u=null===(i=n.redirectUser)||void 0===i?void 0:i._redirectEventId,c=null==o?void 0:o._redirectEventId,e.next=13,n.tryRedirectSignIn(t);case 13:l=e.sent,u&&u!==c||!(null==l?void 0:l.user)||(o=l.user,s=!0);case 15:if(o){e.next=17;break}return e.abrupt("return",n.directlySetCurrentUser(null));case 17:if(o._redirectEventId){e.next=33;break}if(!s){e.next=28;break}return e.prev=19,e.next=22,n.beforeStateQueue.runMiddleware(o);case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(19),o=a,n._popupRedirectResolver._overrideRedirectResult(n,(function(){return Promise.reject(e.t0)}));case 28:if(!o){e.next=32;break}return e.abrupt("return",n.reloadAndSetCurrentUserOrClear(o));case 32:return e.abrupt("return",n.directlySetCurrentUser(null));case 33:return lE(n._popupRedirectResolver,n,"argument-error"),e.next=36,n.getOrInitRedirectPersistenceManager();case 36:if(!n.redirectUser||n.redirectUser._redirectEventId!==o._redirectEventId){e.next=38;break}return e.abrupt("return",n.directlySetCurrentUser(o));case 38:return e.abrupt("return",n.reloadAndSetCurrentUserOrClear(o));case 39:case"end":return e.stop()}}),r,null,[[19,24]])})))()}},{key:"tryRedirectSignIn",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null,e.prev=1,e.next=4,n._popupRedirectResolver._completeRedirectFn(n,t,!0);case 4:i=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,n._setRedirectUser(null);case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),r,null,[[1,7]])})))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(t){var n=this;return e(a)(e(m).mark((function r(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,JE(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),"auth/network-request-failed"===(null===e.t0||void 0===e.t0?void 0:e.t0.code)){e.next=9;break}return e.abrupt("return",n.directlySetCurrentUser(null));case 9:return e.abrupt("return",n.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),r,null,[[0,5]])})))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var t=this;return e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._deleted=!0;case 1:case"end":return e.stop()}}),n)})))()}},{key:"updateCurrentUser",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=t?nt(t):null)&&lE(i.auth.config.apiKey===n.config.apiKey,n,"invalid-user-token"),e.abrupt("return",n._updateCurrentUser(i&&i._clone(n)));case 3:case"end":return e.stop()}}),r)})))()}},{key:"_updateCurrentUser",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(a)(e(m).mark((function i(){return e(m).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!r._deleted){i.next=2;break}return i.abrupt("return");case 2:if(t&&lE(r.tenantId===t.tenantId,r,"tenant-id-mismatch"),n){i.next=6;break}return i.next=6,r.beforeStateQueue.runMiddleware(t);case 6:return i.abrupt("return",r.queue(e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),n)})))));case 7:case"end":return i.stop()}}),i)})))()}},{key:"signOut",value:function(){var t=this;return e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.beforeStateQueue.runMiddleware(null);case 2:if(!t.redirectPersistenceManager&&!t._popupRedirectResolver){e.next=5;break}return e.next=5,t._setRedirectUser(null);case 5:return e.abrupt("return",t._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),n)})))()}},{key:"setPersistence",value:function(t){var n=this;return this.queue(e(a)(e(m).mark((function r(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.assertedPersistence.setPersistence(cI(t));case 2:case"end":return e.stop()}}),r)}))))}},{key:"_getRecaptchaConfig",value:function(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}},{key:"validatePassword",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n._getPasswordPolicyInternal()){e.next=3;break}return e.next=3,n._updatePasswordPolicy();case 3:if((i=n._getPasswordPolicyInternal()).schemaVersion===n.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION){e.next=6;break}return e.abrupt("return",Promise.reject(n._errorFactory.create("unsupported-password-policy-schema-version",{})));case 6:return e.abrupt("return",i.validatePassword(t));case 7:case"end":return e.stop()}}),r)})))()}},{key:"_getPasswordPolicyInternal",value:function(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}},{key:"_updatePasswordPolicy",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r,i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,SI(t);case 2:r=e.sent,i=new RI(r),null===t.tenantId?t._projectPasswordPolicy=i:t._tenantPasswordPolicies[t.tenantId]=i;case 5:case"end":return e.stop()}}),n)})))()}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new Oe("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"authStateReady",value:function(){var e=this;return new Promise((function(t,n){if(e.currentUser)t();else var r=e.onAuthStateChanged((function(){r(),t()}),n)}))}},{key:"revokeAccessToken",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.currentUser){e.next=8;break}return e.next=3,n.currentUser.getIdToken();case 3:return i=e.sent,a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:i},null!=n.tenantId&&(a.tenantId=n.tenantId),e.next=8,rI(n,a);case 8:case"end":return e.stop()}}),r)})))()}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(t,n){var r=this;return e(a)(e(m).mark((function i(){var a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getOrInitRedirectPersistenceManager(n);case 2:return a=e.sent,e.abrupt("return",null===t?a.removeCurrentUser():a.setCurrentUser(t));case 4:case"end":return e.stop()}}),i)})))()}},{key:"getOrInitRedirectPersistenceManager",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.redirectPersistenceManager){e.next=9;break}return lE(i=t&&cI(t)||n._popupRedirectResolver,n,"argument-error"),e.next=5,dI.create(n,[cI(i._redirectPersistence)],"redirectUser");case 5:return n.redirectPersistenceManager=e.sent,e.next=8,n.redirectPersistenceManager.getCurrentUser();case 8:n.redirectUser=e.sent;case 9:return e.abrupt("return",n.redirectPersistenceManager);case 10:case"end":return e.stop()}}),r)})))()}},{key:"_redirectUserForId",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i,o;return e(m).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._isInitialized){r.next=4;break}return r.next=4,n.queue(e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t)}))));case 4:if((null===(i=n._currentUser)||void 0===i?void 0:i._redirectEventId)!==t){r.next=6;break}return r.abrupt("return",n._currentUser);case 6:if((null===(o=n.redirectUser)||void 0===o?void 0:o._redirectEventId)!==t){r.next=8;break}return r.abrupt("return",n.redirectUser);case 8:return r.abrupt("return",null);case 9:case"end":return r.stop()}}),r)})))()}},{key:"_persistUserIfCurrent",value:function(t){var n=this;return e(a)(e(m).mark((function r(){return e(m).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t!==n.currentUser){r.next=2;break}return r.abrupt("return",n.queue(e(a)(e(m).mark((function r(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),r)})))));case 2:case"end":return r.stop()}}),r)})))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=!1,s=this._isInitialized?Promise.resolve():this._initializationPromise;if(lE(s,this,"internal-error"),s.then((function(){o||a(i.currentUser)})),"function"==typeof t){var u=e.addObserver(t,n,r);return function(){o=!0,u()}}var c=e.addObserver(t);return function(){o=!0,c()}}},{key:"directlySetCurrentUser",value:function(t){var n=this;return e(a)(e(m).mark((function r(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.currentUser&&n.currentUser!==t&&n._currentUser._stopProactiveRefresh(),t&&n.isProactiveRefreshEnabled&&t._startProactiveRefresh(),n.currentUser=t,!t){e.next=8;break}return e.next=6,n.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,n.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),r)})))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return lE(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xI(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r,i,a,o;return e(m).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e(l)({},"X-Client-Version",t.clientVersion),t.app.options.appId&&(i["X-Firebase-gmpid"]=t.app.options.appId),n.next=5,null===(r=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===r?void 0:r.getHeartbeatsHeader();case 5:return(a=n.sent)&&(i["X-Firebase-Client"]=a),n.next=9,t._getAppCheckToken();case 9:return(o=n.sent)&&(i["X-Firebase-AppCheck"]=o),n.abrupt("return",i);case 12:case"end":return n.stop()}}),n)})))()}},{key:"_getAppCheckToken",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r,i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,null===(r=t.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===r?void 0:r.getToken();case 3:return(null==(i=e.sent)?void 0:i.error)&&iE("Error while retrieving App Check token: ".concat(i.error)),e.abrupt("return",null==i?void 0:i.token);case 6:case"end":return e.stop()}}),n)})))()}}]),t}();function OI(e){return nt(e)}var PI=function(){"use strict";function t(n){var r,i,a=this;e(s)(this,t),this.auth=n,this.observer=null,this.addObserver=(i=new Ye((function(e){return a.observer=e}),r)).subscribe.bind(i)}return e(u)(t,[{key:"next",get:function(){return lE(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(e){return new Promise((function(t,n){var r,i,a=document.createElement("script");a.setAttribute("src",e),a.onload=t,a.onerror=function(e){var t=sE("internal-error");t.customData=e,n(t)},a.type="text/javascript",a.charset="UTF-8",(null!==(i=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==i?i:document).appendChild(a)}))}function LI(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}var MI="https://www.google.com/recaptcha/enterprise.js?render=",UI="NO_RECAPTCHA",FI=function(){"use strict";function t(n){e(s)(this,t),this.type="recaptcha-enterprise",this.auth=OI(n)}return e(u)(t,[{key:"verify",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(a)(e(m).mark((function i(){var o,s,u;return e(m).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=function(e){return s.apply(this,arguments)},s=function(){return s=e(a)(e(m).mark((function t(r){return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=5;break}if(null!=r.tenantId||null==r._agentRecaptchaConfig){t.next=3;break}return t.abrupt("return",r._agentRecaptchaConfig.siteKey);case 3:if(null==r.tenantId||void 0===r._tenantRecaptchaConfigs[r.tenantId]){t.next=5;break}return t.abrupt("return",r._tenantRecaptchaConfigs[r.tenantId].siteKey);case 5:return t.abrupt("return",new Promise(function(){var t=e(a)(e(m).mark((function t(n,i){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:LE(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((function(e){if(void 0!==e.recaptchaKey){var t=new DE(e);return null==r.tenantId?r._agentRecaptchaConfig=t:r._tenantRecaptchaConfigs[r.tenantId]=t,n(t.siteKey)}i(new Error("recaptcha Enterprise site key undefined"))})).catch((function(e){i(e)}));case 1:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 6:case"end":return t.stop()}}),t)}))),s.apply(this,arguments)},u=function(e,n,r){var i=window.grecaptcha;PE(i)?i.enterprise.ready((function(){i.enterprise.execute(e,{action:t}).then((function(e){n(e)})).catch((function(){n(UI)}))})):r(Error("No reCAPTCHA enterprise script loaded."))},i.abrupt("return",new Promise((function(e,t){o(r.auth).then((function(r){if(!n&&PE(window.grecaptcha))u(r,e,t);else{if("undefined"==typeof window)return void t(new Error("RecaptchaVerifier is only supported in browser"));DI(MI+r).then((function(){u(r,e,t)})).catch((function(e){t(e)}))}})).catch((function(e){t(e)}))})));case 7:case"end":return i.stop()}}),i)})))()}}]),t}();function BI(e,t,n){return jI.apply(this,arguments)}function jI(){return jI=e(a)(e(m).mark((function t(n,r,i){var a,o,s,u,c=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>3&&void 0!==c[3]&&c[3],o=new FI(n),e.prev=3,e.next=6,o.verify(i);case 6:s=e.sent,e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(3),e.next=13,o.verify(i,!0);case 13:s=e.sent;case 14:return u=Object.assign({},r),a?Object.assign(u,{captchaResp:s}):Object.assign(u,{captchaResponse:s}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),e.abrupt("return",u);case 19:case"end":return e.stop()}}),t,null,[[3,9]])}))),jI.apply(this,arguments)}function VI(e,t,n,r){return qI.apply(this,arguments)}function qI(){return qI=e(a)(e(m).mark((function t(n,r,i,o){var s,u;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null===(s=n._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))){t.next=8;break}return t.next=4,BI(n,r,i,"getOobCode"===i);case 4:return u=t.sent,t.abrupt("return",o(n,u));case 8:return t.abrupt("return",o(n,r).catch(function(){var t=e(a)(e(m).mark((function t(a){var s;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("auth/missing-recaptcha-token"!==a.code){e.next=8;break}return console.log("".concat(i," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.")),e.next=4,BI(n,r,i,"getOobCode"===i);case 4:return s=e.sent,e.abrupt("return",o(n,s));case 8:return e.abrupt("return",Promise.reject(a));case 9:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 9:case"end":return t.stop()}}),t)}))),qI.apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function zI(e,t){var n=Gt(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(ze(n.getOptions(),null!=t?t:{}))return r;oE(r,"already-initialized")}return n.initialize({options:t})}function HI(t,n,r){var i=OI(t);lE(i._canInitEmulator,i,"emulator-config-failed"),lE(/^https?:\/\//.test(n),i,"invalid-emulator-scheme");var a=!!(null==r?void 0:r.disableWarnings),o=WI(n),s=function(t){var n=WI(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(n.length));if(!r)return{host:"",port:null};var i=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){var o=a[1];return{host:o,port:KI(i.substr(o.length+1))}}var s=e(k)(i.split(":"),2);return{host:s[0],port:KI(s[1])}}(n),u=s.host,c=s.port,l=null===c?"":":".concat(c);i.config.emulator={url:"".concat(o,"//").concat(u).concat(l,"/")},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:u,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */()}function WI(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function KI(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var GI=function(){"use strict";function t(n,r){e(s)(this,t),this.providerId=n,this.signInMethod=r}return e(u)(t,[{key:"toJSON",value:function(){return hE("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return hE("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return hE("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return hE("not implemented")}}]),t}();function QI(e,t){return YI.apply(this,arguments)}function YI(){return(YI=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",EE(n,"POST","/v1/accounts:signUp",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function JI(e,t){return XI.apply(this,arguments)}function XI(){return(XI=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",CE(n,"POST","/v1/accounts:signInWithPassword",bE(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function $I(e,t){return ZI.apply(this,arguments)}function ZI(){return(ZI=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",CE(n,"POST","/v1/accounts:signInWithEmailLink",bE(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function eT(e,t){return tT.apply(this,arguments)}function tT(){return(tT=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",CE(n,"POST","/v1/accounts:signInWithEmailLink",bE(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nT=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a){var o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return e(s)(this,r),(o=n.call(this,"password",a))._email=t,o._password=i,o._tenantId=u,o}return e(u)(r,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?5:6;break;case 3:return i={returnSecureToken:!0,email:n._email,password:n._password,clientType:"CLIENT_TYPE_WEB"},e.abrupt("return",VI(t,i,"signInWithPassword",JI));case 5:return e.abrupt("return",$I(t,{email:n._email,oobCode:n._password}));case 6:oE(t,"internal-error");case 7:case"end":return e.stop()}}),r)})))()}},{key:"_linkToIdToken",value:function(t,n){var r=this;return e(a)(e(m).mark((function i(){var a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?5:6;break;case 3:return a={idToken:n,returnSecureToken:!0,email:r._email,password:r._password,clientType:"CLIENT_TYPE_WEB"},e.abrupt("return",VI(t,a,"signUpPassword",QI));case 5:return e.abrupt("return",eT(t,{idToken:n,email:r._email,oobCode:r._password}));case 6:oE(t,"internal-error");case 7:case"end":return e.stop()}}),i)})))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new r(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new r(e,t,"emailLink",n)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),r}(GI);function rT(e,t){return iT.apply(this,arguments)}function iT(){return(iT=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",CE(n,"POST","/v1/accounts:signInWithIdp",bE(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var aT=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){var t;return e(s)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).pendingToken=null,t}return e(u)(r,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return rT(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,rT(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,rT(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=We(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new r(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):oE("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,n=t.providerId,i=t.signInMethod,a=Zb(t,["providerId","signInMethod"]);if(!n||!i)return null;var o=new r(n,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),r}(GI);function oT(e,t){return sT.apply(this,arguments)}function sT(){return(sT=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",EE(n,"POST","/v1/accounts:sendVerificationCode",bE(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function uT(){return(uT=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",CE(n,"POST","/v1/accounts:signInWithPhoneNumber",bE(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function cT(){return(cT=e(a)(e(m).mark((function t(n,r){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,CE(n,"POST","/v1/accounts:signInWithPhoneNumber",bE(n,r));case 2:if(!(i=e.sent).temporaryProof){e.next=5;break}throw OE(n,"account-exists-with-different-credential",i);case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var lT=e(l)({},"USER_NOT_FOUND","user-not-found");function hT(){return(hT=e(a)(e(m).mark((function t(n,r){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object.assign(Object.assign({},r),{operation:"REAUTH"}),e.abrupt("return",CE(n,"POST","/v1/accounts:signInWithPhoneNumber",bE(n,i),lT));case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fT=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this,"phone","phone")).params=t,i}return e(u)(r,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return uT.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return cT.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return hT.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,i=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:i}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new r({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new r({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"==typeof e&&(e=JSON.parse(e));var t=e.verificationId,n=e.verificationCode,i=e.phoneNumber,a=e.temporaryProof;return n||t||i||a?new r({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:a}):null}}]),r}(GI);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dT=function(){"use strict";function t(n){var r,i,a,o,u,c;e(s)(this,t);var l=Ke(Ge(n)),h=null!==(r=l.apiKey)&&void 0!==r?r:null,f=null!==(i=l.oobCode)&&void 0!==i?i:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(a=l.mode)&&void 0!==a?a:null);lE(h&&f&&d,"argument-error"),this.apiKey=h,this.operation=d,this.code=f,this.continueUrl=null!==(o=l.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(u=l.languageCode)&&void 0!==u?u:null,this.tenantId=null!==(c=l.tenantId)&&void 0!==c?c:null}return e(u)(t,null,[{key:"parseLink",value:function(e){var n=function(e){var t=Ke(Ge(e)).link,n=t?Ke(Ge(t)).deep_link_id:null,r=Ke(Ge(e)).deep_link_id;return(r?Ke(Ge(r)).link:null)||r||n||t||e}(e);try{return new t(n)}catch(e){return null}}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pT=function(){"use strict";function t(){e(s)(this,t),this.providerId=t.PROVIDER_ID}return e(u)(t,null,[{key:"credential",value:function(e,t){return nT._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=dT.parseLink(t);return lE(n,"argument-error"),nT._fromEmailAndCode(e,n.code,n.tenantId)}}]),t}();pT.PROVIDER_ID="password",pT.EMAIL_PASSWORD_SIGN_IN_METHOD="password",pT.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var vT=function(){"use strict";function t(n){e(s)(this,t),this.providerId=n,this.defaultLanguageCode=null,this.customParameters={}}return e(u)(t,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),t}(),yT=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){var t;return e(s)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).scopes=[],t}return e(u)(r,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return e(h)(this.scopes)}}]),r}(vT),mT=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.call(this,"facebook.com")}return e(u)(r,null,[{key:"credential",value:function(e){return aT._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return r.credential(t.oauthAccessToken)}catch(e){return null}}}]),r}(yT);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mT.FACEBOOK_SIGN_IN_METHOD="facebook.com",mT.PROVIDER_ID="facebook.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var gT=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){var t;return e(s)(this,r),(t=n.call(this,"google.com")).addScope("profile"),t}return e(u)(r,null,[{key:"credential",value:function(e,t){return aT._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.oauthIdToken,i=t.oauthAccessToken;if(!n&&!i)return null;try{return r.credential(n,i)}catch(e){return null}}}]),r}(yT);gT.GOOGLE_SIGN_IN_METHOD="google.com",gT.PROVIDER_ID="google.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var kT=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.call(this,"github.com")}return e(u)(r,null,[{key:"credential",value:function(e){return aT._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return r.credential(t.oauthAccessToken)}catch(e){return null}}}]),r}(yT);kT.GITHUB_SIGN_IN_METHOD="github.com",kT.PROVIDER_ID="github.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var _T=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.call(this,"twitter.com")}return e(u)(r,null,[{key:"credential",value:function(e,t){return aT._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.oauthAccessToken,i=t.oauthTokenSecret;if(!n||!i)return null;try{return r.credential(n,i)}catch(e){return null}}}]),r}(yT);function wT(e,t){return bT.apply(this,arguments)}function bT(){return(bT=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",CE(n,"POST","/v1/accounts:signUp",bE(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_T.TWITTER_SIGN_IN_METHOD="twitter.com",_T.PROVIDER_ID="twitter.com";var ET=function(){"use strict";function t(n){e(s)(this,t),this.user=n.user,this.providerId=n.providerId,this._tokenResponse=n._tokenResponse,this.operationType=n.operationType}return e(u)(t,null,[{key:"_fromIdTokenResponse",value:function(n,r,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e(a)(e(m).mark((function a(){var s,u,c;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sI._fromIdTokenResponse(n,i,o);case 2:return s=e.sent,u=IT(i),c=new t({user:s,providerId:u,_tokenResponse:i,operationType:r}),e.abrupt("return",c);case 6:case"end":return e.stop()}}),a)})))()}},{key:"_forOperation",value:function(n,r,i){return e(a)(e(m).mark((function a(){var o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._updateTokensIfNecessary(i,!0);case 2:return o=IT(i),e.abrupt("return",new t({user:n,providerId:o,_tokenResponse:i,operationType:r}));case 4:case"end":return e.stop()}}),a)})))()}}]),t}();function IT(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var TT=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a,o){var u,c;return e(s)(this,r),(u=n.call(this,i.code,i.message)).operationType=a,u.user=o,Object.setPrototypeOf(e(T)(u),r.prototype),u.customData={appName:t.name,tenantId:null!==(c=t.tenantId)&&void 0!==c?c:void 0,_serverResponse:i.customData._serverResponse,operationType:a},u}return e(u)(r,null,[{key:"_fromErrorAndOperation",value:function(e,t,n,i){return new r(e,t,n,i)}}]),r}(Ne);function xT(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if("auth/multi-factor-auth-required"===n.code)throw TT._fromErrorAndOperation(e,n,t,r);throw n}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CT(e,t){return ST.apply(this,arguments)}function ST(){return ST=e(a)(e(m).mark((function t(n,r){var i,a,o=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>2&&void 0!==o[2]&&o[2],e.t0=WE,e.t1=n,e.t2=r,e.t3=n.auth,e.next=7,n.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=i,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return a=e.sent,e.abrupt("return",ET._forOperation(n,"link",a));case 14:case"end":return e.stop()}}),t)}))),ST.apply(this,arguments)}function AT(e,t){return RT.apply(this,arguments)}function RT(){return RT=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){var i,a,o,s,u,c,l=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l.length>2&&void 0!==l[2]&&l[2],a=n.auth,o="reauthenticate",e.prev=3,e.next=6,WE(n,xT(a,o,r,n),i);case 6:return lE((s=e.sent).idToken,a,"internal-error"),lE(u=HE(s.idToken),a,"internal-error"),c=u.sub,lE(n.uid===c,a,"user-mismatch"),e.abrupt("return",ET._forOperation(n,o,s));case 15:throw e.prev=15,e.t0=e.catch(3),"auth/user-not-found"===(null===e.t0||void 0===e.t0?void 0:e.t0.code)&&oE(a,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),t,null,[[3,15]])}))),RT.apply(this,arguments)}function NT(e,t){return OT.apply(this,arguments)}function OT(){return OT=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n,r){var i,a,o,s,u=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>2&&void 0!==u[2]&&u[2],a="signIn",e.next=4,xT(n,a,r);case 4:return o=e.sent,e.next=7,ET._fromIdTokenResponse(n,a,o);case 7:if(s=e.sent,i){e.next=11;break}return e.next=11,n._updateCurrentUser(s.user);case 11:return e.abrupt("return",s);case 12:case"end":return e.stop()}}),t)}))),OT.apply(this,arguments)}function PT(e,t){return DT.apply(this,arguments)}function DT(){return(DT=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",NT(OI(n),r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function LT(e){return MT.apply(this,arguments)}function MT(){return(MT=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=OI(n))._getPasswordPolicyInternal()){e.next=4;break}return e.next=4,r._updatePasswordPolicy();case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function UT(e,t,n){return FT.apply(this,arguments)}function FT(){return(FT=e(a)(e(m).mark((function t(n,r,i){var a,o,s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=OI(n),o=VI(a,{returnSecureToken:!0,email:r,password:i,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",wT),e.next=5,o.catch((function(e){throw"auth/password-does-not-meet-requirements"===e.code&&LT(n),e}));case 5:return s=e.sent,e.next=8,ET._fromIdTokenResponse(a,"signIn",s);case 8:return u=e.sent,e.next=11,a._updateCurrentUser(u.user);case 11:return e.abrupt("return",u);case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function BT(t,n,r){return PT(nt(t),pT.credential(n,r)).catch((i=e(a)(e(m).mark((function n(r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw"auth/password-does-not-meet-requirements"===r.code&&LT(t),r;case 2:case"end":return e.stop()}}),n)}))),function(e){return i.apply(this,arguments)}));var i}function jT(e,t,n,r){return nt(e).onIdTokenChanged(t,n,r)}function VT(e,t,n){return nt(e).beforeAuthStateChanged(t,n)}function qT(e){return nt(e).signOut()}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function zT(e,t){return EE(e,"POST","/v2/accounts/mfaEnrollment:start",bE(e,t))}function HT(e,t){return EE(e,"POST","/v2/accounts/mfaEnrollment:finalize",bE(e,t))}new WeakMap;var WT="__sak",KT=function(){"use strict";function t(n,r){e(s)(this,t),this.storageRetriever=n,this.type=r}return e(u)(t,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(WT,"1"),this.storage.removeItem(WT),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var GT=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){var t,i;return e(s)(this,r),(t=n.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(e,n){return t.onStorageEvent(e,n)},t.listeners={},t.localCache={},t.pollTimer=null,t.safariLocalStorageNotSynced=(yI(i=Ee())||bI(i))&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),t.fallbackToPolling=TI(),t._shouldAllowMigration=!0,t}return e(u)(r,[{key:"forAllChangedKeys",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=Object.keys(this.listeners)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,s=this.storage.getItem(o),u=this.localCache[o];s!==u&&e(o,u,s)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"onStorageEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;if(e.key){var r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}var a=function(){var e=n.storage.getItem(r);(t||n.localCache[r]!==e)&&n.notifyListeners(r,e)},o=this.storage.getItem(r);II()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else{var s=this;this.forAllChangedKeys((function(e,t,n){s.notifyListeners(e,n)}))}}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e],r=!0,i=!1,a=void 0;if(n)try{for(var o,s=Array.from(n)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){(0,o.value)(t?JSON.parse(t):t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){var t=e;e.forAllChangedKeys((function(e,n,r){t.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(t,n){var i=this,o=this;return e(a)(e(m).mark((function a(){return e(m).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(Mc)(e(jc)(r.prototype),"_set",i).call(o,t,n);case 2:o.localCache[t]=JSON.stringify(n);case 3:case"end":return a.stop()}}),a)})))()}},{key:"_get",value:function(t){var n=this,i=this;return e(a)(e(m).mark((function a(){var o;return e(m).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(Mc)(e(jc)(r.prototype),"_get",n).call(i,t);case 2:return o=a.sent,i.localCache[t]=JSON.stringify(o),a.abrupt("return",o);case 5:case"end":return a.stop()}}),a)})))()}},{key:"_remove",value:function(t){var n=this,i=this;return e(a)(e(m).mark((function a(){return e(m).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(Mc)(e(jc)(r.prototype),"_remove",n).call(i,t);case 2:delete i.localCache[t];case 3:case"end":return a.stop()}}),a)})))()}}]),r}(KT);GT.type="LOCAL";var QT=GT,YT=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(){return e(s)(this,r),n.call(this,(function(){return window.sessionStorage}),"SESSION")}return e(u)(r,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),r}(KT);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */YT.type="SESSION";var JT=YT;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XT(t){return Promise.all(t.map((n=e(a)(e(m).mark((function t(n){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n;case 3:return r=e.sent,e.abrupt("return",{fulfilled:!0,value:r});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),t,null,[[0,7]])}))),function(e){return n.apply(this,arguments)})));var n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $T=function(){"use strict";function t(n){e(s)(this,t),this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return e(u)(t,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i,o,s,u,c,l,h,f;return e(m).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=(i=t).data,s=o.eventId,u=o.eventType,c=o.data,null==(l=n.handlersMap[u])?void 0:l.size){r.next=5;break}return r.abrupt("return");case 5:return i.ports[0].postMessage({status:"ack",eventId:s,eventType:u}),h=Array.from(l).map(function(){var t=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n(i.origin,c));case 1:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.next=9,XT(h);case 9:f=r.sent,i.ports[0].postMessage({status:"done",eventId:s,eventType:u,response:f});case 11:case"end":return r.stop()}}),r)})))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(e){var n=this.receivers.find((function(t){return t.isListeningto(e)}));if(n)return n;var r=new t(e);return this.receivers.push(r),r}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ZT(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$T.receivers=[];var ex=function(){"use strict";function t(n){e(s)(this,t),this.target=n,this.handlers=new Set}return e(u)(t,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=this;return e(a)(e(m).mark((function a(){var o,s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o="undefined"!=typeof MessageChannel?new MessageChannel:null){e.next=3;break}throw new Error("connection_unavailable");case 3:return e.abrupt("return",new Promise((function(e,a){var c=ZT("",20);o.port1.start();var l=setTimeout((function(){a(new Error("unsupported_event"))}),r);u={messageChannel:o,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),s=setTimeout((function(){a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),e(n.data.response);break;default:clearTimeout(l),clearTimeout(s),a(new Error("invalid_response"))}}},i.handlers.add(u),o.port1.addEventListener("message",u.onMessage),i.target.postMessage({eventType:t,eventId:c,data:n},[o.port2])})).finally((function(){u&&i.removeMessageHandler(u)})));case 6:case"end":return e.stop()}}),a)})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tx(){return window}function nx(e){tx().location.href=e}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(){return void 0!==tx().WorkerGlobalScope&&"function"==typeof tx().importScripts}function ix(){return ax.apply(this,arguments)}function ax(){return(ax=e(a)(e(m).mark((function t(){var n;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return n=e.sent,e.abrupt("return",n.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),t,null,[[2,9]])})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ox="firebaseLocalStorageDb",sx="firebaseLocalStorage",ux="fbase_key",cx=function(){"use strict";function t(n){e(s)(this,t),this.request=n}return e(u)(t,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){var r=e;e.request.addEventListener("success",(function(){t(r.request.result)})),e.request.addEventListener("error",(function(){n(r.request.error)}))}))}}]),t}();function lx(e,t){return e.transaction([sx],t?"readwrite":"readonly").objectStore(sx)}function hx(){var e=indexedDB.deleteDatabase(ox);return new cx(e).toPromise()}function fx(){var t=indexedDB.open(ox,1);return new Promise((function(n,r){t.addEventListener("error",(function(){r(t.error)})),t.addEventListener("upgradeneeded",(function(){var e=t.result;try{e.createObjectStore(sx,{keyPath:ux})}catch(e){r(e)}})),t.addEventListener("success",e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=t.result).objectStoreNames.contains(sx)){e.next=12;break}return i.close(),e.next=5,hx();case 5:return e.t0=n,e.next=8,fx();case 8:e.t1=e.sent,(0,e.t0)(e.t1),e.next=13;break;case 12:n(i);case 13:case"end":return e.stop()}}),r)}))))}))}function dx(e,t,n){return px.apply(this,arguments)}function px(){return(px=e(a)(e(m).mark((function t(n,r,i){var a,o;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=lx(n,!0).put((a={},e(l)(a,ux,r),e(l)(a,"value",i),a)),t.abrupt("return",new cx(o).toPromise());case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function vx(e,t){return yx.apply(this,arguments)}function yx(){return(yx=e(a)(e(m).mark((function t(n,r){var i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=lx(n,!1).get(r),e.next=3,new cx(i).toPromise();case 3:return a=e.sent,e.abrupt("return",void 0===a?null:a.value);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function mx(e,t){var n=lx(e,!0).delete(t);return new cx(n).toPromise()}var gx=function(){"use strict";function t(){e(s)(this,t),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return e(u)(t,[{key:"_openDb",value:function(){var t=this;return e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.db){e.next=2;break}return e.abrupt("return",t.db);case 2:return e.next=4,fx();case 4:return t.db=e.sent,e.abrupt("return",t.db);case 6:case"end":return e.stop()}}),n)})))()}},{key:"_withRetries",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:return e.prev=2,e.next=5,n._openDb();case 5:return a=e.sent,e.next=8,t(a);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(i++>3)){e.next=15;break}throw e.t0;case 15:n.db&&(n.db.close(),n.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),r,null,[[2,11]])})))()}},{key:"initializeServiceWorkerMessaging",value:function(){var t=this;return e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rx()?t.initializeReceiver():t.initializeSender());case 1:case"end":return e.stop()}}),n)})))()}},{key:"initializeReceiver",value:function(){var t=this;return e(a)(e(m).mark((function n(){return e(m).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.receiver=$T._getInstance(rx()?self:null),t.receiver._subscribe("keyChanged",function(){var n=e(a)(e(m).mark((function n(r,i){var a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return a=e.sent,e.abrupt("return",{keyProcessed:a.includes(i.key)});case 4:case"end":return e.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var t=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return n.stop()}}),n)})))()}},{key:"initializeSender",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r,i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,ix();case 3:if(t.activeServiceWorker=e.sent,t.activeServiceWorker){e.next=6;break}return e.abrupt("return");case 6:return t.sender=new ex(t.activeServiceWorker),e.next=9,t.sender._send("ping",{},800);case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return");case 12:(null===(r=a[0])||void 0===r?void 0:r.fulfilled)&&(null===(i=a[0])||void 0===i?void 0:i.value.includes("keyChanged"))&&(t.serviceWorkerReceiverAvailable=!0);case 13:case"end":return e.stop()}}),n)})))()}},{key:"notifyServiceWorker",value:function(t){var n=this;return e(a)(e(m).mark((function r(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.sender&&n.activeServiceWorker&&(r=void 0,((null===(r=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===r?void 0:r.controller)||null)===n.activeServiceWorker)){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}var r}),r,null,[[2,7]])})))()}},{key:"_isAvailable",value:function(){return e(a)(e(m).mark((function t(){var n;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,fx();case 5:return n=e.sent,e.next=8,dx(n,WT,"1");case 8:return e.next=10,mx(n,WT);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),t,null,[[0,13]])})))()}},{key:"_withPendingWrite",value:function(t){var n=this;return e(a)(e(m).mark((function r(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,n.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),r,null,[[1,,4,7]])})))()}},{key:"_set",value:function(t,n){var r=this;return e(a)(e(m).mark((function i(){return e(m).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",r._withPendingWrite(e(a)(e(m).mark((function i(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return dx(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),i)})))));case 1:case"end":return i.stop()}}),i)})))()}},{key:"_get",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return vx(e,t)}));case 2:return i=e.sent,n.localCache[t]=i,e.abrupt("return",i);case 5:case"end":return e.stop()}}),r)})))()}},{key:"_remove",value:function(t){var n=this;return e(a)(e(m).mark((function r(){return e(m).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(e(a)(e(m).mark((function r(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return mx(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),r)})))));case 1:case"end":return r.stop()}}),r)})))()}},{key:"_poll",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r,i,a,o,s,u,c,l,h,f,d,p,v,y,g,k,_;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._withRetries((function(e){var t=lx(e,!1).getAll();return new cx(t).toPromise()}));case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===t.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:for(i=[],a=new Set,o=!0,s=!1,u=void 0,e.prev=10,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0)h=l.value,f=h.fbase_key,d=h.value,a.add(f),JSON.stringify(t.localCache[f])!==JSON.stringify(d)&&(t.notifyListeners(f,d),i.push(f));e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),s=!0,u=e.t0;case 18:e.prev=18,e.prev=19,o||null==c.return||c.return();case 21:if(e.prev=21,!s){e.next=24;break}throw u;case 24:return e.finish(21);case 25:return e.finish(18);case 26:for(p=!0,v=!1,y=void 0,e.prev=27,g=Object.keys(t.localCache)[Symbol.iterator]();!(p=(k=g.next()).done);p=!0)_=k.value,t.localCache[_]&&!a.has(_)&&(t.notifyListeners(_,null),i.push(_));e.next=35;break;case 31:e.prev=31,e.t1=e.catch(27),v=!0,y=e.t1;case 35:e.prev=35,e.prev=36,p||null==g.return||g.return();case 38:if(e.prev=38,!v){e.next=41;break}throw y;case 41:return e.finish(38);case 42:return e.finish(35);case 43:return e.abrupt("return",i);case 44:case"end":return e.stop()}}),n,null,[[10,14,18,26],[19,,21,25],[27,31,35,43],[36,,38,42]])})))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e],r=!0,i=!1,a=void 0;if(n)try{for(var o,s=Array.from(n)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){(0,o.value)(t)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}},{key:"startPolling",value:function(){this.stopPolling();var t=this;this.pollTimer=setInterval(e(a)(e(m).mark((function n(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t._poll());case 1:case"end":return e.stop()}}),n)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),t}();gx.type="LOCAL";var kx=gx;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _x(e,t){return EE(e,"POST","/v2/accounts/mfaSignIn:start",bE(e,t))}function wx(e,t){return EE(e,"POST","/v2/accounts/mfaSignIn:finalize",bE(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
LI("rcb"),new yE(3e4,6e4);var bx="recaptcha";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ex(e,t,n){return Ix.apply(this,arguments)}function Ix(){return(Ix=e(a)(e(m).mark((function t(n,r,i){var a,o,s,u,c,l,h,f;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,i.verify();case 3:if(o=e.sent,e.prev=4,lE("string"==typeof o,n,"argument-error"),lE(i.type===bx,n,"argument-error"),!("session"in(s="string"==typeof r?{phoneNumber:r}:r))){e.next=28;break}if(u=s.session,!("phoneNumber"in s)){e.next=19;break}return lE("enroll"===u.type,n,"internal-error"),e.next=15,zT(n,{idToken:u.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:o}});case 15:return c=e.sent,e.abrupt("return",c.phoneSessionInfo.sessionInfo);case 19:return lE("signin"===u.type,n,"internal-error"),lE(l=(null===(a=s.multiFactorHint)||void 0===a?void 0:a.uid)||s.multiFactorUid,n,"missing-multi-factor-info"),e.next=24,_x(n,{mfaPendingCredential:u.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:o}});case 24:return h=e.sent,e.abrupt("return",h.phoneResponseInfo.sessionInfo);case 26:e.next=32;break;case 28:return e.next=30,oT(n,{phoneNumber:s.phoneNumber,recaptchaToken:o});case 30:return f=e.sent.sessionInfo,e.abrupt("return",f);case 32:return e.prev=32,i._reset(),e.finish(32);case 35:case"end":return e.stop()}}),t,null,[[4,,32,35]])})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Tx=function(){"use strict";function t(n){e(s)(this,t),this.providerId=t.PROVIDER_ID,this.auth=OI(n)}return e(u)(t,[{key:"verifyPhoneNumber",value:function(e,t){return Ex(this.auth,e,nt(t))}}],[{key:"credential",value:function(e,t){return fT._fromVerification(e,t)}},{key:"credentialFromResult",value:function(e){var n=e;return t.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(e){return t.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?fT._fromTokenResponse(n,r):null}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function xx(e,t){return t?cI(t):(lE(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tx.PROVIDER_ID="phone",Tx.PHONE_SIGN_IN_METHOD="phone";var Cx=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this,"custom","custom")).params=t,i}return e(u)(r,[{key:"_getIdTokenResponse",value:function(e){return rT(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return rT(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return rT(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),r}(GI);function Sx(e){return NT(e.auth,new Cx(e),e.bypassAuthState)}function Ax(e){var t=e.auth,n=e.user;return lE(n,t,"internal-error"),AT(n,new Cx(e),e.bypassAuthState)}function Rx(e){return Nx.apply(this,arguments)}function Nx(){return(Nx=e(a)(e(m).mark((function t(n){var r,i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.auth,lE(i=n.user,r,"internal-error"),e.abrupt("return",CT(i,new Cx(n),n.bypassAuthState));case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ox=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];e(s)(this,t),this.auth=n,this.resolver=i,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}return e(u)(t,[{key:"execute",value:function(){var t,n=this;return new Promise((t=e(a)(e(m).mark((function t(r,i){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.pendingPromise={resolve:r,reject:i},e.prev=1,e.next=4,n.resolver._initialize(n.auth);case 4:return n.eventManager=e.sent,e.next=7,n.onExecution();case 7:n.eventManager.registerConsumer(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),n.reject(e.t0);case 13:case"end":return e.stop()}}),t,null,[[1,10]])}))),function(e,n){return t.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i,a,o,s,u,c,l;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.urlResponse,a=t.sessionId,o=t.postBody,s=t.tenantId,u=t.error,c=t.type,!u){e.next=4;break}return n.reject(u),e.abrupt("return");case 4:return l={auth:n.auth,requestUri:i,sessionId:a,tenantId:s||void 0,postBody:o||void 0,user:n.user,bypassAuthState:n.bypassAuthState},e.prev=5,e.t0=n,e.next=9,n.getIdpTask(c)(l);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),n.reject(e.t2);case 16:case"end":return e.stop()}}),r,null,[[5,13]])})))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Sx;case"linkViaPopup":case"linkViaRedirect":return Rx;case"reauthViaPopup":case"reauthViaRedirect":return Ax;default:oE(this.auth,"internal-error")}}},{key:"resolve",value:function(e){fE(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){fE(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),t}(),Px=new yE(2e3,1e4);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dx=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a,o,u){var c;return e(s)(this,r),(c=n.call(this,t,i,o,u)).provider=a,c.authWindow=null,c.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=e(T)(c),c}return e(u)(r,[{key:"executeNotNull",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.execute();case 2:return lE(r=e.sent,t.auth,"internal-error"),e.abrupt("return",r);case 5:case"end":return e.stop()}}),n)})))()}},{key:"onExecution",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return fE(1===t.filter.length,"Popup operations only handle one event"),r=ZT(),e.next=4,t.resolver._openPopup(t.auth,t.provider,t.filter[0],r);case 4:t.authWindow=e.sent,t.authWindow.associatedEvent=r,t.resolver._originValidation(t.auth).catch((function(e){t.reject(e)})),t.resolver._isIframeWebStorageSupported(t.auth,(function(e){e||t.reject(sE(t.auth,"web-storage-unsupported"))})),t.pollUserCancellation();case 9:case"end":return e.stop()}}),n)})))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(sE(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this,t=function(){var n,r;if(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed){var i=e;e.pollId=window.setTimeout((function(){i.pollId=null,i.reject(sE(i.auth,"popup-closed-by-user"))}),8e3)}else e.pollId=window.setTimeout(t,Px.get())};t()}}]),r}(Ox);Dx.currentPopupAction=null;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Lx=new Map,Mx=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e(s)(this,r),(a=n.call(this,t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],i,void 0,o)).eventId=null,a}return e(u)(r,[{key:"execute",value:function(){var t=this,n=this;return e(a)(e(m).mark((function i(){var a,o;return e(m).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=Lx.get(n.auth._key())){i.next=21;break}return i.prev=2,i.next=5,Ux(n.resolver,n.auth);case 5:if(!i.sent){i.next=12;break}return i.next=9,e(Mc)(e(jc)(r.prototype),"execute",t).call(n);case 9:i.t0=i.sent,i.next=13;break;case 12:i.t0=null;case 13:o=i.t0,a=function(){return Promise.resolve(o)},i.next=20;break;case 17:i.prev=17,i.t1=i.catch(2),a=function(){return Promise.reject(i.t1)};case 20:Lx.set(n.auth._key(),a);case 21:return n.bypassAuthState||Lx.set(n.auth._key(),(function(){return Promise.resolve(null)})),i.abrupt("return",a());case 23:case"end":return i.stop()}}),i,null,[[2,17]])})))()}},{key:"onAuthEvent",value:function(t){var n=this,i=this,o=function(){return e(Mc)(e(jc)(r.prototype),"onAuthEvent",n)};return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",o().call(i,t));case 4:if("unknown"!==t.type){e.next=7;break}return i.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,i.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return i.user=r,e.abrupt("return",o().call(i,t));case 16:i.resolve(null);case 17:case"end":return e.stop()}}),n)})))()}},{key:"onExecution",value:function(){return e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t)})))()}},{key:"cleanUp",value:function(){}}]),r}(Ox);function Ux(e,t){return Fx.apply(this,arguments)}function Fx(){return(Fx=e(a)(e(m).mark((function t(n,r){var i,a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Vx(r),a=jx(n),e.next=4,a._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,a._get(i);case 8:return e.t0=e.sent,o="true"===e.t0,e.next=12,a._remove(i);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Bx(e,t){Lx.set(e._key(),t)}function jx(e){return cI(e._redirectPersistence)}function Vx(e){return fI("pendingRedirect",e.config.apiKey,e.name)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(e,t){return zx.apply(this,arguments)}function zx(){return zx=e(a)(e(m).mark((function t(n,r){var i,a,o,s,u,c=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>2&&void 0!==c[2]&&c[2],a=OI(n),o=xx(a,r),s=new Mx(a,o,i),e.next=6,s.execute();case 6:if(!(u=e.sent)||i){e.next=13;break}return delete u.user._redirectEventId,e.next=11,a._persistUserIfCurrent(u.user);case 11:return e.next=13,a._setRedirectUser(null,r);case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),t)}))),zx.apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Hx=function(){"use strict";function t(n){e(s)(this,t),this.auth=n,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return e(u)(t,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Kx(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!Kx(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(sE(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Wx(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(Wx(e)),this.lastProcessedEventTime=Date.now()}}]),t}();function Wx(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function Kx(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function Gx(e){return Qx.apply(this,arguments)}function Qx(){return Qx=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(a)(e(m).mark((function t(n){var r,i=arguments;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.abrupt("return",EE(n,"GET","/v1/projects",r));case 2:case"end":return e.stop()}}),t)}))),Qx.apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yx=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Jx=/^https?/;function Xx(){return(Xx=e(a)(e(m).mark((function t(n){var r,i,a,o,s,u,c;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Gx(n);case 4:r=e.sent.authorizedDomains,i=!0,a=!1,o=void 0,e.prev=6,s=r[Symbol.iterator]();case 8:if(i=(u=s.next()).done){e.next=20;break}if(c=u.value,e.prev=10,!$x(c)){e.next=13;break}return e.abrupt("return");case 13:e.next=17;break;case 15:e.prev=15,e.t0=e.catch(10);case 17:i=!0,e.next=8;break;case 20:e.next=26;break;case 22:e.prev=22,e.t1=e.catch(6),a=!0,o=e.t1;case 26:e.prev=26,e.prev=27,i||null==s.return||s.return();case 29:if(e.prev=29,!a){e.next=32;break}throw o;case 32:return e.finish(29);case 33:return e.finish(26);case 34:oE(n,"unauthorized-domain");case 35:case"end":return e.stop()}}),t,null,[[6,22,26,34],[10,15],[27,,29,33]])})))).apply(this,arguments)}function $x(e){var t=dE(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!Jx.test(r))return!1;if(Yx.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zx=new yE(3e4,6e4);function eC(){var t=tx().___jsl,n=!0,r=!1,i=void 0;if(null==t?void 0:t.H)try{for(var a,o=Object.keys(t.H)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;if(t.H[s].r=t.H[s].r||[],t.H[s].L=t.H[s].L||[],t.H[s].r=e(h)(t.H[s].L),t.CP)for(var u=0;u<t.CP.length;u++)t.CP[u]=null}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}var tC=null;function nC(e){return tC=tC||function(e){return new Promise((function(t,n){var r,i,a;function o(){eC(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){eC(),n(sE(e,"network-request-failed"))},timeout:Zx.get()})}if(null===(i=null===(r=tx().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=tx().gapi)||void 0===a?void 0:a.load)){var s=LI("iframefcb");return tx()[s]=function(){gapi.load?o():n(sE(e,"network-request-failed"))},DI("https://apis.google.com/js/api.js?onload=".concat(s)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw tC=null,e}))}(e),tC}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rC=new yE(5e3,15e3),iC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},aC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function oC(e){var t=e.config;lE(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?mE(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:Xt},i=aC.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(We(r).slice(1))}function sC(e){return uC.apply(this,arguments)}function uC(){return uC=e(a)(e(m).mark((function t(n){var r,i;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,nC(n);case 2:return r=t.sent,lE(i=tx().gapi,n,"internal-error"),t.abrupt("return",r.open({where:document.body,url:oC(n),messageHandlersFilter:i.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:iC,dontclear:!0},(function(t){return new Promise((r=e(a)(e(m).mark((function r(i,a){var o,s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=function(){tx().clearTimeout(s),i(t)},e.next=3,t.restyle({setHideOnLeave:!1});case 3:o=sE(n,"network-request-failed"),s=tx().setTimeout((function(){a(o)}),rC.get()),t.ping(u).then(u,(function(){a(o)}));case 7:case"end":return e.stop()}}),r)}))),function(e,t){return r.apply(this,arguments)}));var r})));case 6:case"end":return t.stop()}}),t)}))),uC.apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},lC="_blank",hC="http://localhost",fC=function(){"use strict";function t(n){e(s)(this,t),this.window=n,this.associatedEvent=null}return e(u)(t,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),t}();function dC(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,o=Math.max((window.screen.availHeight-a)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString(),u="",c=Object.assign(Object.assign({},cC),{width:i.toString(),height:a.toString(),top:o,left:s}),l=Ee().toLowerCase();r&&(u=mI(l)?lC:r),vI(l)&&(n=n||hC,c.scrollbars="yes");var h=Object.entries(c).reduce((function(t,n){var r=e(k)(n,2),i=r[0],a=r[1];return"".concat(t).concat(i,"=").concat(a,",")}),"");if(EI(l)&&"_self"!==u)return pC(n||"",u),new fC(null);var f=window.open(n||"",u,h);lE(f,t,"popup-blocked");try{f.focus()}catch(e){}return new fC(f)}function pC(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vC=encodeURIComponent("fac");function yC(e,t,n,r,i,a){return mC.apply(this,arguments)}function mC(){return(mC=e(a)(e(m).mark((function t(n,r,i,a,o,s){var u,c,l,h,f,d,p,v,y,g,_,w,b,E,I,T,x,C,S;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(lE(n.config.authDomain,n,"auth-domain-config-required"),lE(n.config.apiKey,n,"invalid-api-key"),u={apiKey:n.config.apiKey,appName:n.name,authType:i,redirectUrl:a,v:Xt,eventId:o},!(r instanceof vT)){t.next=24;break}for(r.setDefaultLanguage(n.languageCode),u.providerId=r.providerId||"",Ve(r.getCustomParameters())||(u.customParameters=JSON.stringify(r.getCustomParameters())),c=!0,l=!1,h=void 0,t.prev=8,f=Object.entries(s||{})[Symbol.iterator]();!(c=(d=f.next()).done);c=!0)p=e(k)(d.value,2),v=p[0],y=p[1],u[v]=y;t.next=16;break;case 12:t.prev=12,t.t0=t.catch(8),l=!0,h=t.t0;case 16:t.prev=16,t.prev=17,c||null==f.return||f.return();case 19:if(t.prev=19,!l){t.next=22;break}throw h;case 22:return t.finish(19);case 23:return t.finish(16);case 24:for(r instanceof yT&&(g=r.getScopes().filter((function(e){return""!==e}))).length>0&&(u.scopes=g.join(",")),n.tenantId&&(u.tid=n.tenantId),_=u,w=!0,b=!1,E=void 0,t.prev=28,I=Object.keys(_)[Symbol.iterator]();!(w=(T=I.next()).done);w=!0)x=T.value,void 0===_[x]&&delete _[x];t.next=36;break;case 32:t.prev=32,t.t1=t.catch(28),b=!0,E=t.t1;case 36:t.prev=36,t.prev=37,w||null==I.return||I.return();case 39:if(t.prev=39,!b){t.next=42;break}throw E;case 42:return t.finish(39);case 43:return t.finish(36);case 44:return t.next=46,n._getAppCheckToken();case 46:return C=t.sent,S=C?"#".concat(vC,"=").concat(encodeURIComponent(C)):"",t.abrupt("return","".concat(gC(n),"?").concat(We(_).slice(1)).concat(S));case 49:case"end":return t.stop()}}),t,null,[[8,12,16,24],[17,,19,23],[28,32,36,44],[37,,39,43]])})))).apply(this,arguments)}function gC(e){var t=e.config;return t.emulator?mE(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/").concat("__/auth/handler")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kC="webStorageSupport",_C=function(){"use strict";function t(){e(s)(this,t),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=JT,this._completeRedirectFn=qx,this._overrideRedirectResult=Bx}return e(u)(t,[{key:"_openPopup",value:function(t,n,r,i){var o=this;return e(a)(e(m).mark((function a(){var s,u;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return fE(null===(s=o.eventManagers[t._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),e.next=4,yC(t,n,r,dE(),i);case 4:return u=e.sent,e.abrupt("return",dC(t,u,ZT()));case 6:case"end":return e.stop()}}),a)})))()}},{key:"_openRedirect",value:function(t,n,r,i){var o=this;return e(a)(e(m).mark((function a(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o._originValidation(t);case 2:return e.next=4,yC(t,n,r,dE(),i);case 4:return nx(e.sent),e.abrupt("return",new Promise((function(){})));case 7:case"end":return e.stop()}}),a)})))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(fE(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sC(t);case 2:return i=e.sent,a=new Hx(t),i.register("authEvent",(function(e){return lE(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:a.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),n.eventManagers[t._key()]={manager:a},n.iframes[t._key()]=i,e.abrupt("return",a);case 8:case"end":return e.stop()}}),r)})))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(kC,{type:kC},(function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),oE(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return Xx.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return TI()||yI()||bI()}}]),t}(),wC=_C,bC=function(){"use strict";function t(n){e(s)(this,t),this.factorId=n}return e(u)(t,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return hE("unexpected MultiFactorSessionType")}}}]),t}(),EC=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this,"phone")).credential=t,i}return e(u)(r,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return EE(e,"POST","/v2/accounts/mfaEnrollment:finalize",bE(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return EE(e,"POST","/v2/accounts/mfaSignIn:finalize",bE(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new r(e)}}]),r}(bC);(function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,null,[{key:"assertion",value:function(e){return EC._fromCredential(e)}}]),t}()).FACTOR_ID="phone",(function(){"use strict";function t(){e(s)(this,t)}return e(u)(t,null,[{key:"assertionForEnrollment",value:function(e,t){return IC._fromSecret(e,t)}},{key:"assertionForSignIn",value:function(e,t){return IC._fromEnrollmentId(e,t)}},{key:"generateSecret",value:function(t){return e(a)(e(m).mark((function n(){var r,i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lE(void 0!==(null===(r=(i=t).user)||void 0===r?void 0:r.auth),"internal-error"),e.next=5,n=i.user.auth,o={idToken:i.credential,totpEnrollmentInfo:{}},EE(n,"POST","/v2/accounts/mfaEnrollment:start",bE(n,o));case 5:return a=e.sent,e.abrupt("return",TC._fromStartTotpMfaEnrollmentResponse(a,i.user.auth));case 7:case"end":return e.stop()}var n,o}),n)})))()}}]),t}()).FACTOR_ID="totp";var IC=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this,"totp")).otp=t,o.enrollmentId=i,o.secret=a,o}return e(u)(r,[{key:"_finalizeEnroll",value:function(t,n,r){var i=this;return e(a)(e(m).mark((function a(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lE(void 0!==i.secret,t,"argument-error"),e.abrupt("return",HT(t,{idToken:n,displayName:r,totpVerificationInfo:i.secret._makeTotpVerificationInfo(i.otp)}));case 2:case"end":return e.stop()}}),a)})))()}},{key:"_finalizeSignIn",value:function(t,n){var r=this;return e(a)(e(m).mark((function i(){var a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lE(void 0!==r.enrollmentId&&void 0!==r.otp,t,"argument-error"),a={verificationCode:r.otp},e.abrupt("return",wx(t,{mfaPendingCredential:n,mfaEnrollmentId:r.enrollmentId,totpVerificationInfo:a}));case 3:case"end":return e.stop()}}),i)})))()}}],[{key:"_fromSecret",value:function(e,t){return new r(t,void 0,e)}},{key:"_fromEnrollmentId",value:function(e,t){return new r(t,e)}}]),r}(bC),TC=function(){"use strict";function t(n,r,i,a,o,u,c){e(s)(this,t),this.sessionInfo=u,this.auth=c,this.secretKey=n,this.hashingAlgorithm=r,this.codeLength=i,this.codeIntervalSeconds=a,this.enrollmentCompletionDeadline=o}return e(u)(t,[{key:"_makeTotpVerificationInfo",value:function(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}},{key:"generateQrCodeUrl",value:function(e,t){var n,r=!1;return(xC(e)||xC(t))&&(r=!0),r&&(xC(e)&&(e=(null===(n=this.auth.currentUser)||void 0===n?void 0:n.email)||"unknownuser"),xC(t)&&(t=this.auth.name)),"otpauth://totp/".concat(t,":").concat(e,"?secret=").concat(this.secretKey,"&issuer=").concat(t,"&algorithm=").concat(this.hashingAlgorithm,"&digits=").concat(this.codeLength)}}],[{key:"_fromStartTotpMfaEnrollmentResponse",value:function(e,n){return new t(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,n)}}]),t}();function xC(e){return void 0===e||0===(null==e?void 0:e.length)}var CC="@firebase/auth",SC="1.4.0",AC=function(){"use strict";function t(n){e(s)(this,t),this.auth=n,this.internalListeners=new Map}return e(u)(t,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(t){var n=this;return e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.assertAuthConfigured(),e.next=3,n.auth._initializationPromise;case 3:if(n.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,n.auth.currentUser.getIdToken(t);case 7:return i=e.sent,e.abrupt("return",{accessToken:i});case 9:case"end":return e.stop()}}),r)})))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){lE(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var RC,NC=_e("authIdTokenMaxAge")||300,OC=null,PC=function(t){return n=e(a)(e(m).mark((function n(r){var i,a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r,!e.t0){e.next=5;break}return e.next=4,r.getIdTokenResult();case 4:e.t0=e.sent;case 5:if(i=e.t0,!((a=i&&((new Date).getTime()-Date.parse(i.issuedAtTime))/1e3)&&a>NC)){e.next=9;break}return e.abrupt("return");case 9:if(o=null==i?void 0:i.token,OC!==o){e.next=12;break}return e.abrupt("return");case 12:return OC=o,e.next=15,fetch(t,{method:o?"POST":"DELETE",headers:o?{Authorization:"Bearer ".concat(o)}:{}});case 15:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)};var n};RC="Browser",Kt(new rt("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),o=r.options,s=o.apiKey,u=o.authDomain;lE(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});var c={apiKey:s,authDomain:u,clientPlatform:RC,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xI(RC)},l=new NI(r,i,a,c);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(cI);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(l,n),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),Kt(new rt("auth-internal",(function(e){var t=OI(e.getProvider("auth").getImmediate());return new AC(t)}),"PRIVATE").setInstantiationMode("EXPLICIT")),en(CC,SC,
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(RC)),en(CC,SC,"esm2017");T=i("ds8z5");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var DC,LC,MC="firebasestorage.googleapis.com",UC=function(t){"use strict";e(x)(r,t);var n=e(M)(r);function r(t,i){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e(s)(this,r),(a=n.call(this,FC(t),"Firebase Storage: ".concat(i," (").concat(FC(t),")"))).status_=o,a.customData={serverResponse:null},a._baseMessage=a.message,Object.setPrototypeOf(e(T)(a),r.prototype),a}return e(u)(r,[{key:"status",get:function(){return this.status_},set:function(e){this.status_=e}},{key:"_codeEquals",value:function(e){return FC(e)===this.code}},{key:"serverResponse",get:function(){return this.customData.serverResponse},set:function(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}]),r}(Ne);function FC(e){return"storage/"+e}function BC(){return new UC(DC.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function jC(){return new UC(DC.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function VC(){return new UC(DC.CANCELED,"User canceled the upload/download.")}function qC(e){return new UC(DC.INVALID_ARGUMENT,e)}function zC(){return new UC(DC.APP_DELETED,"The Firebase app was deleted.")}(LC=DC||(DC={})).UNKNOWN="unknown",LC.OBJECT_NOT_FOUND="object-not-found",LC.BUCKET_NOT_FOUND="bucket-not-found",LC.PROJECT_NOT_FOUND="project-not-found",LC.QUOTA_EXCEEDED="quota-exceeded",LC.UNAUTHENTICATED="unauthenticated",LC.UNAUTHORIZED="unauthorized",LC.UNAUTHORIZED_APP="unauthorized-app",LC.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",LC.INVALID_CHECKSUM="invalid-checksum",LC.CANCELED="canceled",LC.INVALID_EVENT_NAME="invalid-event-name",LC.INVALID_URL="invalid-url",LC.INVALID_DEFAULT_BUCKET="invalid-default-bucket",LC.NO_DEFAULT_BUCKET="no-default-bucket",LC.CANNOT_SLICE_BLOB="cannot-slice-blob",LC.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",LC.NO_DOWNLOAD_URL="no-download-url",LC.INVALID_ARGUMENT="invalid-argument",LC.INVALID_ARGUMENT_COUNT="invalid-argument-count",LC.APP_DELETED="app-deleted",LC.INVALID_ROOT_OPERATION="invalid-root-operation",LC.INVALID_FORMAT="invalid-format",LC.INTERNAL_ERROR="internal-error",LC.UNSUPPORTED_ENVIRONMENT="unsupported-environment";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var HC,WC,KC=function(){"use strict";function t(n,r){e(s)(this,t),this.bucket=n,this.path_=r}return e(u)(t,[{key:"path",get:function(){return this.path_}},{key:"isRoot",get:function(){return 0===this.path.length}},{key:"fullServerUrl",value:function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}},{key:"bucketOnlyServerUrl",value:function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}}],[{key:"makeFromBucketSpec",value:function(e,n){var r,i;try{r=t.makeFromUrl(e,n)}catch(n){return new t(e,"")}if(""===r.path)return r;throw i=e,new UC(DC.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}},{key:"makeFromUrl",value:function(e,n){var r=null,i="([A-Za-z0-9.\\-_]+)";var a=new RegExp("^gs://"+i+"(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:a,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(s,"/").concat("v[A-Za-z0-9_]+","/b/").concat(i,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://".concat(n===MC?"(?:storage.googleapis.com|storage.cloud.google.com)":n,"/").concat(i,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:o}],c=0;c<u.length;c++){var l=u[c],h=l.regex.exec(e);if(h){var f=h[l.indices.bucket],d=h[l.indices.path];d||(d=""),r=new t(f,d),l.postModify(r);break}}if(null==r)throw function(e){return new UC(DC.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return r}}]),t}(),GC=function(){"use strict";function t(n){e(s)(this,t),this.promise_=Promise.reject(n)}return e(u)(t,[{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(){}}]),t}();function QC(e,t,n,r){if(r<t)throw qC("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw qC("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YC(e){var t=encodeURIComponent,n="?";for(var r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function JC(e,t){var n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(WC=HC||(HC={}))[WC.NO_ERROR=0]="NO_ERROR",WC[WC.NETWORK_ERROR=1]="NETWORK_ERROR",WC[WC.ABORT=2]="ABORT";var XC=function(){"use strict";function t(n,r,i,a,o,u,c,l,h,f,d){var p=!(arguments.length>11&&void 0!==arguments[11])||arguments[11],v=this;e(s)(this,t),this.url_=n,this.method_=r,this.headers_=i,this.body_=a,this.successCodes_=o,this.additionalRetryCodes_=u,this.callback_=c,this.errorCallback_=l,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=d,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((function(e,t){v.resolve_=e,v.reject_=t,v.start_()}))}return e(u)(t,[{key:"start_",value:function(){var t=this,n=function(e,n){var r=t.resolve_,i=t.reject_,a=n.connection;if(n.wasSuccessCode)try{var o=t.callback_(a,a.getResponse());void 0!==o?r(o):r()}catch(e){i(e)}else if(null!==a){var s=BC();s.serverResponse=a.getErrorText(),t.errorCallback_?i(t.errorCallback_(a,s)):i(s)}else if(n.canceled){i(t.appDelete_?zC():VC())}else{i(jC())}};this.canceled_?n(0,new $C(!1,null,!0)):this.backoffId_=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(t,n,r){var i=1,a=null,o=null,s=!1,u=0;function c(){return 2===u}var l=!1;function f(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];l||(l=!0,n.apply(null,t))}function d(e){a=setTimeout((function(){a=null,t(v,c())}),e)}function p(){o&&clearTimeout(o)}function v(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];if(l)p();else{var o,v,y;if(t)return p(),void(o=f).call.apply(o,[null,t].concat(e(h)(r)));if(c()||s)return p(),void(v=f).call.apply(v,[null,t].concat(e(h)(r)));i<64&&(i*=2),1===u?(u=2,y=0):y=1e3*(i+Math.random()),d(y)}}var y=!1;function m(e){y||(y=!0,p(),l||(null!==a?(e||(u=2),clearTimeout(a),d(0)):e||(u=1)))}return d(0),o=setTimeout((function(){s=!0,m(!0)}),r),m}((function(e,n){var r=t;if(n)e(!1,new $C(!1,null,!0));else{var i=t.connectionFactory_();t.pendingConnection_=i;var a=function(e){var t=e.loaded,n=e.lengthComputable?e.total:-1;null!==r.progressCallback_&&r.progressCallback_(t,n)};null!==t.progressCallback_&&i.addUploadProgressListener(a),i.send(t.url_,t.method_,t.body_,t.headers_).then((function(){null!==r.progressCallback_&&i.removeUploadProgressListener(a),r.pendingConnection_=null;var t=i.getErrorCode()===HC.NO_ERROR,n=i.getStatus();if(!t||JC(n,r.additionalRetryCodes_)&&r.retry){var o=i.getErrorCode()===HC.ABORT;e(!1,new $C(!1,null,o))}else{var s=-1!==r.successCodes_.indexOf(n);e(!0,new $C(s,i))}}))}}),n,this.timeout_)}},{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}]),t}(),$C=function t(n,r,i){"use strict";e(s)(this,t),this.wasSuccessCode=n,this.connection=r,this.canceled=!!i};function ZC(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}function eS(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}function tS(e,t){t&&(e["X-Firebase-GMPID"]=t)}function nS(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}function rS(e,t,n,r,i,a){var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=YC(e.urlParams),u=e.url+s,c=Object.assign({},e.headers);return tS(c,t),ZC(c,n),eS(c,a),nS(c,r),new XC(u,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var aS=function(){"use strict";function t(n,r){e(s)(this,t),this._service=n,this._location=r instanceof KC?r:KC.makeFromUrl(r,n.host)}return e(u)(t,[{key:"toString",value:function(){return"gs://"+this._location.bucket+"/"+this._location.path}},{key:"_newRef",value:function(e,n){return new t(e,n)}},{key:"root",get:function(){var e=new KC(this._location.bucket,"");return this._newRef(this._service,e)}},{key:"bucket",get:function(){return this._location.bucket}},{key:"fullPath",get:function(){return this._location.path}},{key:"name",get:function(){return iS(this._location.path)}},{key:"storage",get:function(){return this._service}},{key:"parent",get:function(){var e=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;var n=new KC(this._location.bucket,e);return new t(this._service,n)}},{key:"_throwIfRoot",value:function(e){if(""===this._location.path)throw t=e,new UC(DC.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').");var t}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(e,t){var n=null==t?void 0:t.storageBucket;return null==n?null:KC.makeFromBucketSpec(n,e)}function sS(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";var i=r.mockUserToken;i&&(e._overrideAuthToken="string"==typeof i?i:be(i,e.app.options.projectId))}var uS=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.app=n,this._authProvider=r,this._appCheckProvider=i,this._url=a,this._firebaseVersion=o,this._bucket=null,this._host=MC,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=a?KC.makeFromBucketSpec(a,this._host):oS(this._host,this.app.options)}return e(u)(t,[{key:"host",get:function(){return this._host},set:function(e){this._host=e,null!=this._url?this._bucket=KC.makeFromBucketSpec(this._url,e):this._bucket=oS(e,this.app.options)}},{key:"maxUploadRetryTime",get:function(){return this._maxUploadRetryTime},set:function(e){QC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}},{key:"maxOperationRetryTime",get:function(){return this._maxOperationRetryTime},set:function(e){QC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}},{key:"_getAuthToken",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r,i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._overrideAuthToken){e.next=2;break}return e.abrupt("return",t._overrideAuthToken);case 2:if(!(r=t._authProvider.getImmediate({optional:!0}))){e.next=9;break}return e.next=6,r.getToken();case 6:if(null===(i=e.sent)){e.next=9;break}return e.abrupt("return",i.accessToken);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),n)})))()}},{key:"_getAppCheckToken",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r,i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t._appCheckProvider.getImmediate({optional:!0}))){e.next=6;break}return e.next=4,r.getToken();case 4:return i=e.sent,e.abrupt("return",i.token);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),n)})))()}},{key:"_delete",value:function(){return this._deleted||(this._deleted=!0,this._requests.forEach((function(e){return e.cancel()})),this._requests.clear()),Promise.resolve()}},{key:"_makeStorageReference",value:function(e){return new aS(this,e)}},{key:"_makeRequest",value:function(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new GC(zC());var a=this,o=rS(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then((function(){return a._requests.delete(o)}),(function(){return a._requests.delete(o)})),o}},{key:"makeRequestWithTokens",value:function(t,n){var r=this;return e(a)(e(m).mark((function i(){var a,o,s;return e(m).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=e(k),i.next=3,Promise.all([r._getAuthToken(),r._getAppCheckToken()]);case 3:return i.t1=i.sent,a=(0,i.t0)(i.t1,2),o=a[0],s=a[1],i.abrupt("return",r._makeRequest(t,n,o,s).getPromise());case 8:case"end":return i.stop()}}),i)})))()}}]),t}(),cS="@firebase/storage",lS="0.11.2",hS="storage";function fS(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};sS(e,t,n,r)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return new uS(r,i,a,n,Xt)}Kt(new rt(hS,dS,"PUBLIC").setMultipleInstances(!0)),en(cS,lS,""),en(cS,lS,"esm2017");var pS=$t({apiKey:"AIzaSyCfjG-RLGh4VqAL5XSxS9EG4IVK4R8XF-E",authDomain:"filmoteka-23.firebaseapp.com",projectId:"filmoteka-23",storageBucket:"filmoteka-23.appspot.com",messagingSenderId:"1050534310211",appId:"1:1050534310211:web:687145a2426964cba8fff6",measurementId:"G-0W38ZQRK92"}),vS=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zt(),t=Gt(e,"auth");if(t.isInitialized())return t.getImmediate();var n=zI(e,{popupRedirectResolver:wC,persistence:[kx,QT,JT]}),r=_e("authTokenSyncURL");if(r){var i=PC(r);VT(n,i,(function(){return i(n.currentUser)})),jT(n,(function(e){return i(e)}))}var a=me("auth");return a&&HI(n,"http://".concat(a)),n}(pS),yS=function(t,n){var r="string"==typeof t?t:n||"(default)",i=Gt("object"==typeof t?t:Zt(),"firestore").getImmediate({identifier:r});if(!i._initialized){var a=ge("firestore");a&&Hw.apply(void 0,[i].concat(e(h)(a)))}return i}(pS),mS=(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zt(),n=arguments.length>1?arguments[1]:void 0,r=Gt(t=nt(t),hS),i=r.getImmediate({identifier:n}),a=ge("storage");a&&fS.apply(void 0,[i].concat(e(h)(a)))}(pS),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zt(),t=Gt(e=nt(e),Qr);t.isInitialized()?t.getImmediate():ji(e)}(pS),{form:document.querySelector(".form"),input:document.getElementById("search-input"),button:document.querySelector(".search-button"),gallery:document.querySelector(".gallery"),buttonLoadMore:document.querySelector(".load-more"),modal:document.querySelector(".modal"),modalContent:document.querySelector(".modal_data"),movieImage:document.querySelector(".movie_image"),movieDescr:document.querySelector(".movie_descr"),buttonClose:document.querySelectorAll(".modal_close"),modalBackdrop:document.querySelectorAll(".modal_body"),body:document.querySelector("body"),content:document.getElementById("content"),headerNavLinks:document.querySelectorAll(".nav_item"),headerNavButtons:document.querySelector(".nav_list_button"),buttonWatched:document.getElementById("watched"),buttonQueue:document.getElementById("queue"),butttonsLibrary:document.querySelector(".modal_nav"),buttonHeaderNav:document.querySelector(".nav_list_button"),logo:document.querySelector(".logo"),homeBtn:document.getElementById("home_btn"),libraryBtn:document.getElementById("library_btn"),signOut:document.getElementById("auth_btn"),modalLogin:document.getElementById("login"),modalRegister:document.getElementById("register"),formsAuth:document.querySelectorAll(".form_auth"),registerLink:document.getElementById("register_link"),loginLink:document.getElementById("login_link"),loginButton:document.getElementById("login_btn"),registerButton:document.getElementById("register_btn"),txtEmail:document.getElementById("txtEmail"),txtPassword:document.getElementById("txtPassword"),regEmail:document.getElementById("regEmail"),regPassword:document.getElementById("regPassword"),regPassword_:document.getElementById("regPassword_")});mS.loginButton.addEventListener("click",(function(){return kS.apply(this,arguments)})),mS.registerButton.addEventListener("click",(function(){return _S.apply(this,arguments)})),mS.signOut.addEventListener("click",(function(e){return wS.apply(this,arguments)}));var gS=mS.formsAuth||[];function kS(){return(kS=e(a)(e(m).mark((function t(){var n,r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=mS.txtEmail.value,r=mS.txtPassword.value,e.next=5,BT(vS,n,r);case 5:e.sent,mS.signOut.classList.remove("not-visible"),bS(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.message);case 13:case"end":return e.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function _S(){return(_S=e(a)(e(m).mark((function t(){var n,r,i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=mS.regEmail.value,r=mS.regPassword.value,e.next=5,UT(vS,n,r);case 5:i=e.sent,console.log(i.user),mS.signOut.classList.remove("not-visible"),bS(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.message);case 14:case"end":return e.stop()}}),t,null,[[0,11]])})))).apply(this,arguments)}function wS(){return(wS=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.preventDefault(),window.location.assign("#/"),e.next=5,qT(vS);case 5:mS.signOut.classList.add("not-visible"),console.log("user is successfully logout"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0.message);case 12:case"end":return e.stop()}}),t,null,[[0,9]])})))).apply(this,arguments)}function bS(){for(var e=0;e<gS.length;e++)for(var t=gS[e],n=0;n<t.elements.length;n++)"text"===t.elements[n].type&&(t.elements[n].value="")}l=i("hKHmD"),Hi=i("l5bVx");function ES(e,t){return function(){return e.apply(t,arguments)}}var IS,TS=Object.prototype.toString,xS=Object.getPrototypeOf,CS=(IS=Object.create(null),function(e){var t=TS.call(e);return IS[t]||(IS[t]=t.slice(8,-1).toLowerCase())}),SS=function(e){return e=e.toLowerCase(),function(t){return CS(t)===e}},AS=function(t){return function(n){return(void 0===n?"undefined":e(Hi)(n))===t}},RS=Array.isArray,NS=AS("undefined");var OS=SS("ArrayBuffer");var PS=AS("string"),DS=AS("function"),LS=AS("number"),MS=function(e){return null!==e&&"object"==typeof e},US=function(e){if("object"!==CS(e))return!1;var t=xS(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},FS=SS("Date"),BS=SS("File"),jS=SS("Blob"),VS=SS("FileList"),qS=SS("URLSearchParams");function zS(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.allOwnKeys,o=void 0!==a&&a;if(null!=e)if("object"!=typeof e&&(e=[e]),RS(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{var s,u=o?Object.getOwnPropertyNames(e):Object.keys(e),c=u.length;for(n=0;n<c;n++)s=u[n],t.call(null,e[s],s,e)}}function HS(e,t){t=t.toLowerCase();for(var n,r=Object.keys(e),i=r.length;i-- >0;)if(t===(n=r[i]).toLowerCase())return n;return null}var WS="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:t,KS=function(e){return!NS(e)&&e!==WS};var GS,QS,YS=(GS="undefined"!=typeof Uint8Array&&xS(Uint8Array),function(e){return GS&&e instanceof GS}),JS=SS("HTMLFormElement"),XS=(QS=Object.prototype.hasOwnProperty,function(e,t){return QS.call(e,t)}),$S=SS("RegExp"),ZS=function(e,t){var n=Object.getOwnPropertyDescriptors(e),r={};zS(n,(function(n,i){var a;!1!==(a=t(n,i,e))&&(r[i]=a||n)})),Object.defineProperties(e,r)},eA="abcdefghijklmnopqrstuvwxyz",tA="0123456789",nA={DIGIT:tA,ALPHA:eA,ALPHA_DIGIT:eA+eA.toUpperCase()+tA};var rA=SS("AsyncFunction"),iA={isArray:RS,isArrayBuffer:OS,isBuffer:function(e){return null!==e&&!NS(e)&&null!==e.constructor&&!NS(e.constructor)&&DS(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:function(e){var t;return e&&("function"==typeof FormData&&e instanceof FormData||DS(e.append)&&("formdata"===(t=CS(e))||"object"===t&&DS(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&OS(e.buffer)},isString:PS,isNumber:LS,isBoolean:function(e){return!0===e||!1===e},isObject:MS,isPlainObject:US,isUndefined:NS,isDate:FS,isFile:BS,isBlob:jS,isRegExp:$S,isFunction:DS,isStream:function(e){return MS(e)&&DS(e.pipe)},isURLSearchParams:qS,isTypedArray:YS,isFileList:VS,forEach:zS,merge:function e(){for(var t=(KS(this)&&this||{}).caseless,n={},r=function(r,i){var a=t&&HS(n,i)||i;US(n[a])&&US(r)?n[a]=e(n[a],r):US(r)?n[a]=e({},r):RS(r)?n[a]=r.slice():n[a]=r},i=0,a=arguments.length;i<a;i++)arguments[i]&&zS(arguments[i],r);return n},extend:function(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).allOwnKeys;return zS(t,(function(t,r){n&&DS(t)?e[r]=ES(t,n):e[r]=t}),{allOwnKeys:r}),e},trim:function(e){return e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e},inherits:function(e,t,n,r){e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:function(e,t,n,r){var i,a,o,s={};if(t=t||{},null==e)return t;do{for(a=(i=Object.getOwnPropertyNames(e)).length;a-- >0;)o=i[a],r&&!r(o,e,t)||s[o]||(t[o]=e[o],s[o]=!0);e=!1!==n&&xS(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:CS,kindOfTest:SS,endsWith:function(e,t,n){e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;var r=e.indexOf(t,n);return-1!==r&&r===n},toArray:function(e){if(!e)return null;if(RS(e))return e;var t=e.length;if(!LS(t))return null;for(var n=new Array(t);t-- >0;)n[t]=e[t];return n},forEachEntry:function(e,t){for(var n,r=(e&&e[Symbol.iterator]).call(e);(n=r.next())&&!n.done;){var i=n.value;t.call(e,i[0],i[1])}},matchAll:function(e,t){for(var n,r=[];null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:JS,hasOwnProperty:XS,hasOwnProp:XS,reduceDescriptors:ZS,freezeMethods:function(e){ZS(e,(function(t,n){if(DS(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;var r=e[n];DS(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=function(){throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:function(e,t){var n={},r=function(e){e.forEach((function(e){n[e]=!0}))};return RS(e)?r(e):r(String(e).split(t)),n},toCamelCase:function(e){return e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n}))},noop:function(){},toFiniteNumber:function(e,t){return e=+e,Number.isFinite(e)?e:t},findKey:HS,global:WS,isContextDefined:KS,ALPHABET:nA,generateString:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nA.ALPHA_DIGIT,n="",r=t.length;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&DS(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:function(e){var t=new Array(10),n=function(e,r){if(MS(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;var i=RS(e)?[]:{};return zS(e,(function(e,t){var a=n(e,r+1);!NS(a)&&(i[t]=a)})),t[r]=void 0,i}}return e};return n(e,0)},isAsyncFn:rA,isThenable:function(e){return e&&(MS(e)||DS(e))&&DS(e.then)&&DS(e.catch)}};function aA(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}iA.inherits(aA,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:iA.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var oA=aA.prototype,sA={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((function(e){sA[e]={value:e}})),Object.defineProperties(aA,sA),Object.defineProperty(oA,"isAxiosError",{value:!0}),aA.from=function(e,t,n,r,i,a){var o=Object.create(oA);return iA.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(function(e){return"isAxiosError"!==e})),aA.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};var uA,cA,lA,hA=aA;T=i("ds8z5"),Hi=i("l5bVx");cA=function(e){var t,n,r=_A(e),i=r[0],a=r[1],o=new yA(function(e,t,n){return 3*(t+n)/4-n}(0,i,a)),s=0,u=a>0?i-4:i;for(n=0;n<u;n+=4)t=vA[e.charCodeAt(n)]<<18|vA[e.charCodeAt(n+1)]<<12|vA[e.charCodeAt(n+2)]<<6|vA[e.charCodeAt(n+3)],o[s++]=t>>16&255,o[s++]=t>>8&255,o[s++]=255&t;2===a&&(t=vA[e.charCodeAt(n)]<<2|vA[e.charCodeAt(n+1)]>>4,o[s++]=255&t);1===a&&(t=vA[e.charCodeAt(n)]<<10|vA[e.charCodeAt(n+1)]<<4|vA[e.charCodeAt(n+2)]>>2,o[s++]=t>>8&255,o[s++]=255&t);return o},lA=function(e){for(var t,n=e.length,r=n%3,i=[],a=16383,o=0,s=n-r;o<s;o+=a)i.push(wA(e,o,o+a>s?s:o+a));1===r?(t=e[n-1],i.push(pA[t>>2]+pA[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(pA[t>>10]+pA[t>>4&63]+pA[t<<2&63]+"="));return i.join("")}
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */;for(var fA,dA,pA=[],vA=[],yA="undefined"!=typeof Uint8Array?Uint8Array:Array,mA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gA=0,kA=mA.length;gA<kA;++gA)pA[gA]=mA[gA],vA[mA.charCodeAt(gA)]=gA;function _A(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function wA(e,t,n){for(var r,i,a=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(pA[(i=r)>>18&63]+pA[i>>12&63]+pA[i>>6&63]+pA[63&i]);return a.join("")}vA["-".charCodeAt(0)]=62,vA["_".charCodeAt(0)]=63,fA=function(e,t,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,d=e[t+h];for(h+=f,a=d&(1<<-l)-1,d>>=-l,l+=s;l>0;a=256*a+e[t+h],h+=f,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=r;l>0;o=256*o+e[t+h],h+=f,l-=8);if(0===a)a=1-c;else{if(a===u)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),a-=c}return(d?-1:1)*o*Math.pow(2,a-r)},dA=function(e,t,n,r,i,a){var o,s,u,c=8*a-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:a-1,p=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=l?(s=0,o=l):o+h>=1?(s=(t*u-1)*Math.pow(2,i),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[n+d]=255&s,d+=p,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;e[n+d]=255&o,d+=p,o/=256,c-=8);e[n+d-p]|=128*v};var bA="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;uA=TA;var EA=2147483647;function IA(e){if(e>EA)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,TA.prototype),t}function TA(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return SA(e)}return xA(e,t,n)}function xA(t,n,r){if("string"==typeof t)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!TA.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|OA(e,t),r=IA(n),i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(t,n);if(ArrayBuffer.isView(t))return function(e){if(fR(e,Uint8Array)){var t=new Uint8Array(e);return RA(t.buffer,t.byteOffset,t.byteLength)}return AA(e)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+(void 0===t?"undefined":e(Hi)(t)));if(fR(t,ArrayBuffer)||t&&fR(t.buffer,ArrayBuffer))return RA(t,n,r);if("undefined"!=typeof SharedArrayBuffer&&(fR(t,SharedArrayBuffer)||t&&fR(t.buffer,SharedArrayBuffer)))return RA(t,n,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return TA.from(i,n,r);var a=function(e){if(TA.isBuffer(e)){var t=0|NA(e.length),n=IA(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||dR(e.length)?IA(0):AA(e);if("Buffer"===e.type&&Array.isArray(e.data))return AA(e.data)}(t);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return TA.from(t[Symbol.toPrimitive]("string"),n,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+(void 0===t?"undefined":e(Hi)(t)))}function CA(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function SA(e){return CA(e),IA(e<0?0:0|NA(e))}function AA(e){for(var t=e.length<0?0:0|NA(e.length),n=IA(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function RA(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,TA.prototype),r}function NA(e){if(e>=EA)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+EA.toString(16)+" bytes");return 0|e}function OA(t,n){if(TA.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||fR(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+(void 0===t?"undefined":e(Hi)(t)));var r=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var a=!1;;)switch(n){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return cR(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return lR(t).length;default:if(a)return i?-1:cR(t).length;n=(""+n).toLowerCase(),a=!0}}function PA(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return GA(this,t,n);case"utf8":case"utf-8":return zA(this,t,n);case"ascii":return WA(this,t,n);case"latin1":case"binary":return KA(this,t,n);case"base64":return qA(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return QA(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function DA(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function LA(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),dR(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=TA.from(t,r)),TA.isBuffer(t))return 0===t.length?-1:MA(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):MA(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function MA(e,t,n,r,i){var a,o=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var l=-1;for(a=n;a<s;a++)if(c(e,a)===c(t,-1===l?0:a-l)){if(-1===l&&(l=a),a-l+1===u)return l*o}else-1!==l&&(a-=a-l),l=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var h=!0,f=0;f<u;f++)if(c(e,a+f)!==c(t,f)){h=!1;break}if(h)return a}return-1}function UA(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a,o=t.length;for(r>o/2&&(r=o/2),a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(dR(s))return a;e[n+a]=s}return a}function FA(e,t,n,r){return hR(cR(t,e.length-n),e,n,r)}function BA(e,t,n,r){return hR(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function jA(e,t,n,r){return hR(lR(t),e,n,r)}function VA(e,t,n,r){return hR(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function qA(e,t,n){return 0===t&&n===e.length?lA(e):lA(e.slice(t,n))}function zA(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a=e[i],o=null,s=a>239?4:a>223?3:a>191?2:1;if(i+s<=n){var u=void 0,c=void 0,l=void 0,h=void 0;switch(s){case 1:a<128&&(o=a);break;case 2:128==(192&(u=e[i+1]))&&(h=(31&a)<<6|63&u)>127&&(o=h);break;case 3:u=e[i+1],c=e[i+2],128==(192&u)&&128==(192&c)&&(h=(15&a)<<12|(63&u)<<6|63&c)>2047&&(h<55296||h>57343)&&(o=h);break;case 4:u=e[i+1],c=e[i+2],l=e[i+3],128==(192&u)&&128==(192&c)&&128==(192&l)&&(h=(15&a)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&h<1114112&&(o=h)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(e){var t=e.length;if(t<=HA)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=HA));return n}(r)}TA.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),TA.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(TA.prototype,"parent",{enumerable:!0,get:function(){if(TA.isBuffer(this))return this.buffer}}),Object.defineProperty(TA.prototype,"offset",{enumerable:!0,get:function(){if(TA.isBuffer(this))return this.byteOffset}}),TA.poolSize=8192,TA.from=function(e,t,n){return xA(e,t,n)},Object.setPrototypeOf(TA.prototype,Uint8Array.prototype),Object.setPrototypeOf(TA,Uint8Array),TA.alloc=function(e,t,n){return function(e,t,n){return CA(e),e<=0?IA(e):void 0!==t?"string"==typeof n?IA(e).fill(t,n):IA(e).fill(t):IA(e)}(e,t,n)},TA.allocUnsafe=function(e){return SA(e)},TA.allocUnsafeSlow=function(e){return SA(e)},TA.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==TA.prototype},TA.compare=function(e,t){if(fR(e,Uint8Array)&&(e=TA.from(e,e.offset,e.byteLength)),fR(t,Uint8Array)&&(t=TA.from(t,t.offset,t.byteLength)),!TA.isBuffer(e)||!TA.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},TA.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},TA.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return TA.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=TA.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(fR(a,Uint8Array))i+a.length>r.length?(TA.isBuffer(a)||(a=TA.from(a)),a.copy(r,i)):Uint8Array.prototype.set.call(r,a,i);else{if(!TA.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i)}i+=a.length}return r},TA.byteLength=OA,TA.prototype._isBuffer=!0,TA.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)DA(this,t,t+1);return this},TA.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)DA(this,t,t+3),DA(this,t+1,t+2);return this},TA.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)DA(this,t,t+7),DA(this,t+1,t+6),DA(this,t+2,t+5),DA(this,t+3,t+4);return this},TA.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?zA(this,0,e):PA.apply(this,arguments)},TA.prototype.toLocaleString=TA.prototype.toString,TA.prototype.equals=function(e){if(!TA.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===TA.compare(this,e)},TA.prototype.inspect=function(){var e="";return e=this.toString("hex",0,50).replace(/(.{2})/g,"$1 ").trim(),this.length>50&&(e+=" ... "),"<Buffer "+e+">"},bA&&(TA.prototype[bA]=TA.prototype.inspect),TA.prototype.compare=function(t,n,r,i,a){if(fR(t,Uint8Array)&&(t=TA.from(t,t.offset,t.byteLength)),!TA.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+(void 0===t?"undefined":e(Hi)(t)));if(void 0===n&&(n=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===a&&(a=this.length),n<0||r>t.length||i<0||a>this.length)throw new RangeError("out of range index");if(i>=a&&n>=r)return 0;if(i>=a)return-1;if(n>=r)return 1;if(this===t)return 0;for(var o=(a>>>=0)-(i>>>=0),s=(r>>>=0)-(n>>>=0),u=Math.min(o,s),c=this.slice(i,a),l=t.slice(n,r),h=0;h<u;++h)if(c[h]!==l[h]){o=c[h],s=l[h];break}return o<s?-1:s<o?1:0},TA.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},TA.prototype.indexOf=function(e,t,n){return LA(this,e,t,n,!0)},TA.prototype.lastIndexOf=function(e,t,n){return LA(this,e,t,n,!1)},TA.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return UA(this,e,t,n);case"utf8":case"utf-8":return FA(this,e,t,n);case"ascii":case"latin1":case"binary":return BA(this,e,t,n);case"base64":return jA(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return VA(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},TA.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var HA=4096;function WA(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function KA(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function GA(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=pR[e[a]];return i}function QA(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length-1;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function YA(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function JA(e,t,n,r,i,a){if(!TA.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function XA(e,t,n,r,i){aR(t,r,i,e,n,7);var a=Number(t&BigInt(4294967295));e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a;var o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function $A(e,t,n,r,i){aR(t,r,i,e,n,7);var a=Number(t&BigInt(4294967295));e[n+7]=a,a>>=8,e[n+6]=a,a>>=8,e[n+5]=a,a>>=8,e[n+4]=a;var o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function ZA(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function eR(e,t,n,r,i){return t=+t,n>>>=0,i||ZA(e,0,n,4),dA(e,t,n,r,23,4),n+4}function tR(e,t,n,r,i){return t=+t,n>>>=0,i||ZA(e,0,n,8),dA(e,t,n,r,52,8),n+8}TA.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,TA.prototype),r},TA.prototype.readUintLE=TA.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||YA(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},TA.prototype.readUintBE=TA.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||YA(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},TA.prototype.readUint8=TA.prototype.readUInt8=function(e,t){return e>>>=0,t||YA(e,1,this.length),this[e]},TA.prototype.readUint16LE=TA.prototype.readUInt16LE=function(e,t){return e>>>=0,t||YA(e,2,this.length),this[e]|this[e+1]<<8},TA.prototype.readUint16BE=TA.prototype.readUInt16BE=function(e,t){return e>>>=0,t||YA(e,2,this.length),this[e]<<8|this[e+1]},TA.prototype.readUint32LE=TA.prototype.readUInt32LE=function(e,t){return e>>>=0,t||YA(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},TA.prototype.readUint32BE=TA.prototype.readUInt32BE=function(e,t){return e>>>=0,t||YA(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},TA.prototype.readBigUInt64LE=vR((function(e){oR(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||sR(e,this.length-8);var r=t+256*this[++e]+65536*this[++e]+this[++e]*Math.pow(2,24),i=this[++e]+256*this[++e]+65536*this[++e]+n*Math.pow(2,24);return BigInt(r)+(BigInt(i)<<BigInt(32))})),TA.prototype.readBigUInt64BE=vR((function(e){oR(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||sR(e,this.length-8);var r=t*Math.pow(2,24)+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*Math.pow(2,24)+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),TA.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||YA(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},TA.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||YA(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},TA.prototype.readInt8=function(e,t){return e>>>=0,t||YA(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},TA.prototype.readInt16LE=function(e,t){e>>>=0,t||YA(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},TA.prototype.readInt16BE=function(e,t){e>>>=0,t||YA(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},TA.prototype.readInt32LE=function(e,t){return e>>>=0,t||YA(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},TA.prototype.readInt32BE=function(e,t){return e>>>=0,t||YA(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},TA.prototype.readBigInt64LE=vR((function(e){oR(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||sR(e,this.length-8);var r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*Math.pow(2,24))})),TA.prototype.readBigInt64BE=vR((function(e){oR(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||sR(e,this.length-8);var r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*Math.pow(2,24)+65536*this[++e]+256*this[++e]+n)})),TA.prototype.readFloatLE=function(e,t){return e>>>=0,t||YA(e,4,this.length),fA(this,e,!0,23,4)},TA.prototype.readFloatBE=function(e,t){return e>>>=0,t||YA(e,4,this.length),fA(this,e,!1,23,4)},TA.prototype.readDoubleLE=function(e,t){return e>>>=0,t||YA(e,8,this.length),fA(this,e,!0,52,8)},TA.prototype.readDoubleBE=function(e,t){return e>>>=0,t||YA(e,8,this.length),fA(this,e,!1,52,8)},TA.prototype.writeUintLE=TA.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||JA(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},TA.prototype.writeUintBE=TA.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||JA(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},TA.prototype.writeUint8=TA.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||JA(this,e,t,1,255,0),this[t]=255&e,t+1},TA.prototype.writeUint16LE=TA.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||JA(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},TA.prototype.writeUint16BE=TA.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||JA(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},TA.prototype.writeUint32LE=TA.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||JA(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},TA.prototype.writeUint32BE=TA.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||JA(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},TA.prototype.writeBigUInt64LE=vR((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return XA(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),TA.prototype.writeBigUInt64BE=vR((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $A(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),TA.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);JA(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},TA.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);JA(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},TA.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||JA(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},TA.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||JA(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},TA.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||JA(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},TA.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||JA(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},TA.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||JA(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},TA.prototype.writeBigInt64LE=vR((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return XA(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),TA.prototype.writeBigInt64BE=vR((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $A(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),TA.prototype.writeFloatLE=function(e,t,n){return eR(this,e,t,!0,n)},TA.prototype.writeFloatBE=function(e,t,n){return eR(this,e,t,!1,n)},TA.prototype.writeDoubleLE=function(e,t,n){return tR(this,e,t,!0,n)},TA.prototype.writeDoubleBE=function(e,t,n){return tR(this,e,t,!1,n)},TA.prototype.copy=function(e,t,n,r){if(!TA.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},TA.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!TA.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=TA.isBuffer(e)?e:TA.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var nR={};function rR(t,n,r){nR[t]=function(r){e(x)(a,r);var i=e(M)(a);function a(){var r;return e(s)(this,a),r=i.call(this),Object.defineProperty(e(T)(r),"message",{value:n.apply(e(T)(r),arguments),writable:!0,configurable:!0}),r.name="".concat(r.name," [").concat(t,"]"),r.stack,delete r.name,r}return e(u)(a,[{key:"code",get:function(){return t},set:function(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(t,"]: ").concat(this.message)}}]),a}(r)}function iR(e){for(var t="",n=e.length,r="-"===e[0]?1:0;n>=r+4;n-=3)t="_".concat(e.slice(n-3,n)).concat(t);return"".concat(e.slice(0,n)).concat(t)}function aR(t,n,r,i,a,o){if(t>r||t<n){var s,u="bigint"===(void 0===n?"undefined":e(Hi)(n))?"n":"";throw s=o>3?0===n||n===BigInt(0)?">= 0".concat(u," and < 2").concat(u," ** ").concat(8*(o+1)).concat(u):">= -(2".concat(u," ** ").concat(8*(o+1)-1).concat(u,") and < 2 ** ")+"".concat(8*(o+1)-1).concat(u):">= ".concat(n).concat(u," and <= ").concat(r).concat(u),new nR.ERR_OUT_OF_RANGE("value",s,t)}!function(e,t,n){oR(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||sR(t,e.length-(n+1))}(i,a,o)}function oR(e,t){if("number"!=typeof e)throw new nR.ERR_INVALID_ARG_TYPE(t,"number",e)}function sR(e,t,n){if(Math.floor(e)!==e)throw oR(e,n),new nR.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new nR.ERR_BUFFER_OUT_OF_BOUNDS;throw new nR.ERR_OUT_OF_RANGE(n||"offset",">= ".concat(n?1:0," and <= ").concat(t),e)}rR("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),rR("ERR_INVALID_ARG_TYPE",(function(t,n){return'The "'.concat(t,'" argument must be of type number. Received type ').concat(void 0===n?"undefined":e(Hi)(n))}),TypeError),rR("ERR_OUT_OF_RANGE",(function(t,n,r){var i='The value of "'.concat(t,'" is out of range.'),a=r;return Number.isInteger(r)&&Math.abs(r)>Math.pow(2,32)?a=iR(String(r)):"bigint"===(void 0===r?"undefined":e(Hi)(r))&&(a=String(r),(r>Math.pow(BigInt(2),BigInt(32))||r<-Math.pow(BigInt(2),BigInt(32)))&&(a=iR(a)),a+="n"),i+=" It must be ".concat(n,". Received ").concat(a)}),RangeError);var uR=/[^+/0-9A-Za-z-_]/g;function cR(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function lR(e){return cA(function(e){if((e=(e=e.split("=")[0]).trim().replace(uR,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function hR(e,t,n,r){var i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function fR(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function dR(e){return e!=e}var pR=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)t[r+i]=e[n]+e[i];return t}();function vR(e){return"undefined"==typeof BigInt?yR:e}function yR(){throw new Error("BigInt not supported")}var mR=uA;function gR(e){return iA.isPlainObject(e)||iA.isArray(e)}function kR(e){return iA.endsWith(e,"[]")?e.slice(0,-2):e}function _R(e,t,n){return e?e.concat(t).map((function(e,t){return e=kR(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}var wR=iA.toFlatObject(iA,{},null,(function(e){return/^is[A-Z]/.test(e)}));var bR=function(e,t,n){if(!iA.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;var r=(n=iA.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!iA.isUndefined(t[e])}))).metaTokens,i=n.visitor||c,a=n.dots,o=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&iA.isSpecCompliantForm(t);if(!iA.isFunction(i))throw new TypeError("visitor must be a function");function u(e){if(null===e)return"";if(iA.isDate(e))return e.toISOString();if(!s&&iA.isBlob(e))throw new hA("Blob is not supported. Use a Buffer instead.");return iA.isArrayBuffer(e)||iA.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):mR.from(e):e}function c(e,n,i){var s=e;if(e&&!i&&"object"==typeof e)if(iA.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(iA.isArray(e)&&function(e){return iA.isArray(e)&&!e.some(gR)}(e)||(iA.isFileList(e)||iA.endsWith(n,"[]"))&&(s=iA.toArray(e)))return n=kR(n),s.forEach((function(e,r){!iA.isUndefined(e)&&null!==e&&t.append(!0===o?_R([n],r,a):null===o?n:n+"[]",u(e))})),!1;return!!gR(e)||(t.append(_R(i,n,a),u(e)),!1)}var l=[],h=Object.assign(wR,{defaultVisitor:c,convertValue:u,isVisitable:gR});if(!iA.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!iA.isUndefined(n)){if(-1!==l.indexOf(n))throw Error("Circular reference detected in "+r.join("."));l.push(n),iA.forEach(n,(function(n,a){!0===(!(iA.isUndefined(n)||null===n)&&i.call(t,n,iA.isString(a)?a.trim():a,r,h))&&e(n,r?r.concat(a):[a])})),l.pop()}}(e),t};function ER(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function IR(e,t){this._pairs=[],e&&bR(e,this,t)}var TR=IR.prototype;TR.append=function(e,t){this._pairs.push([e,t])},TR.toString=function(e){var t=e?function(t){return e.call(this,t,ER)}:ER;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var xR=IR;function CR(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function SR(e,t,n){if(!t)return e;var r,i=n&&n.encode||CR,a=n&&n.serialize;if(r=a?a(t,n):iA.isURLSearchParams(t)?t.toString():new xR(t,n).toString(i)){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}var AR,RR=function(){function t(){e(s)(this,t),this.handlers=[]}return e(u)(t,[{key:"use",value:function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(e){this.handlers[e]&&(this.handlers[e]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(e){iA.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}]),t}(),NR=RR,OR={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},PR={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:xR,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},isStandardBrowserEnv:("undefined"==typeof navigator||"ReactNative"!==(AR=navigator.product)&&"NativeScript"!==AR&&"NS"!==AR)&&"undefined"!=typeof window&&"undefined"!=typeof document,isStandardBrowserWebWorkerEnv:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]};function DR(e,t){return bR(e,new PR.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return PR.isNode&&iA.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}var LR=function(e){function t(e,n,r,i){var a=e[i++],o=Number.isFinite(+a),s=i>=e.length;return a=!a&&iA.isArray(r)?r.length:a,s?(iA.hasOwnProp(r,a)?r[a]=[r[a],n]:r[a]=n,!o):(r[a]&&iA.isObject(r[a])||(r[a]=[]),t(e,n,r[a],i)&&iA.isArray(r[a])&&(r[a]=function(e){var t,n,r={},i=Object.keys(e),a=i.length;for(t=0;t<a;t++)r[n=i[t]]=e[n];return r}(r[a])),!o)}if(iA.isFormData(e)&&iA.isFunction(e.entries)){var n={};return iA.forEachEntry(e,(function(e,r){t(function(e){return iA.matchAll(/\w+|\[(\w*)]/g,e).map((function(e){return"[]"===e[0]?"":e[1]||e[0]}))}(e),r,n,0)})),n}return null};var MR={transitional:OR,adapter:PR.isNode?"http":"xhr",transformRequest:[function(e,t){var n,r=t.getContentType()||"",i=r.indexOf("application/json")>-1,a=iA.isObject(e);if(a&&iA.isHTMLForm(e)&&(e=new FormData(e)),iA.isFormData(e))return i&&i?JSON.stringify(LR(e)):e;if(iA.isArrayBuffer(e)||iA.isBuffer(e)||iA.isStream(e)||iA.isFile(e)||iA.isBlob(e))return e;if(iA.isArrayBufferView(e))return e.buffer;if(iA.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return DR(e,this.formSerializer).toString();if((n=iA.isFileList(e))||r.indexOf("multipart/form-data")>-1){var o=this.env&&this.env.FormData;return bR(n?{"files[]":e}:e,o&&new o,this.formSerializer)}}return a||i?(t.setContentType("application/json",!1),function(e,t,n){if(iA.isString(e))try{return(t||JSON.parse)(e),iA.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||MR.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&iA.isString(e)&&(n&&!this.responseType||r)){var i=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(i){if("SyntaxError"===e.name)throw hA.from(e,hA.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:PR.classes.FormData,Blob:PR.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};iA.forEach(["delete","get","head","post","put","patch"],(function(e){MR.headers[e]={}}));var UR=MR,FR=iA.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),BR=function(e){var t,n,r,i={};return e&&e.split("\n").forEach((function(e){r=e.indexOf(":"),t=e.substring(0,r).trim().toLowerCase(),n=e.substring(r+1).trim(),!t||i[t]&&FR[t]||("set-cookie"===t?i[t]?i[t].push(n):i[t]=[n]:i[t]=i[t]?i[t]+", "+n:n)})),i},jR=Symbol("internals");function VR(e){return e&&String(e).trim().toLowerCase()}function qR(e){return!1===e||null==e?e:iA.isArray(e)?e.map(qR):String(e)}function zR(e,t,n,r,i){return iA.isFunction(r)?r.call(this,t,n):(i&&(t=n),iA.isString(t)?iA.isString(r)?-1!==t.indexOf(r):iA.isRegExp(r)?r.test(t):void 0:void 0)}var HR=Symbol.iterator,WR=Symbol.toStringTag,KR=function(){function t(n){e(s)(this,t),n&&this.set(n)}return e(u)(t,[{key:"set",value:function(e,t,n){var r=this;function i(e,t,n){var i=VR(t);if(!i)throw new Error("header name must be a non-empty string");var a=iA.findKey(r,i);(!a||void 0===r[a]||!0===n||void 0===n&&!1!==r[a])&&(r[a||t]=qR(e))}var a=function(e,t){return iA.forEach(e,(function(e,n){return i(e,n,t)}))};return iA.isPlainObject(e)||e instanceof this.constructor?a(e,t):iA.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?a(BR(e),t):null!=e&&i(t,e,n),this}},{key:"get",value:function(e,t){if(e=VR(e)){var n=iA.findKey(this,e);if(n){var r=this[n];if(!t)return r;if(!0===t)return function(e){for(var t,n=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;t=r.exec(e);)n[t[1]]=t[2];return n}(r);if(iA.isFunction(t))return t.call(this,r,n);if(iA.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(e,t){if(e=VR(e)){var n=iA.findKey(this,e);return!(!n||void 0===this[n]||t&&!zR(0,this[n],n,t))}return!1}},{key:"delete",value:function(e,t){var n=this,r=!1;function i(e){if(e=VR(e)){var i=iA.findKey(n,e);!i||t&&!zR(0,n[i],i,t)||(delete n[i],r=!0)}}return iA.isArray(e)?e.forEach(i):i(e),r}},{key:"clear",value:function(e){for(var t=Object.keys(this),n=t.length,r=!1;n--;){var i=t[n];e&&!zR(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}},{key:"normalize",value:function(e){var t=this,n={};return iA.forEach(this,(function(r,i){var a=iA.findKey(n,i);if(a)return t[a]=qR(r),void delete t[i];var o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n}))}(i):String(i).trim();o!==i&&delete t[i],t[o]=qR(r),n[o]=!0})),this}},{key:"concat",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i;return(i=this.constructor).concat.apply(i,[this].concat(e(h)(n)))}},{key:"toJSON",value:function(e){var t=Object.create(null);return iA.forEach(this,(function(n,r){null!=n&&!1!==n&&(t[r]=e&&iA.isArray(n)?n.join(", "):n)})),t}},{key:HR,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map((function(t){var n=e(k)(t,2);return n[0]+": "+n[1]})).join("\n")}},{key:WR,get:function(){return"AxiosHeaders"}}],[{key:"from",value:function(e){return e instanceof this?e:new this(e)}},{key:"concat",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=new this(e);return n.forEach((function(e){return i.set(e)})),i}},{key:"accessor",value:function(e){var t=(this[jR]=this[jR]={accessors:{}}).accessors,n=this.prototype;function r(e){var r=VR(e);t[r]||(!function(e,t){var n=iA.toCamelCase(" "+t);["get","set","has"].forEach((function(r){Object.defineProperty(e,r+n,{value:function(e,n,i){return this[r].call(this,t,e,n,i)},configurable:!0})}))}(n,e),t[r]=!0)}return iA.isArray(e)?e.forEach(r):r(e),this}}]),t}();KR.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),iA.reduceDescriptors(KR.prototype,(function(e,t){var n=e.value,r=t[0].toUpperCase()+t.slice(1);return{get:function(){return n},set:function(e){this[r]=e}}})),iA.freezeMethods(KR);var GR=KR;function QR(e,t){var n=this||UR,r=t||n,i=GR.from(r.headers),a=r.data;return iA.forEach(e,(function(e){a=e.call(n,a,i.normalize(),t?t.status:void 0)})),i.normalize(),a}function YR(e){return!(!e||!e.__CANCEL__)}function JR(e,t,n){hA.call(this,null==e?"canceled":e,hA.ERR_CANCELED,t,n),this.name="CanceledError"}iA.inherits(JR,hA,{__CANCEL__:!0});var XR=JR;function $R(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new hA("Request failed with status code "+n.status,[hA.ERR_BAD_REQUEST,hA.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}var ZR=PR.isStandardBrowserEnv?{write:function(e,t,n,r,i,a){var o=[];o.push(e+"="+encodeURIComponent(t)),iA.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),iA.isString(r)&&o.push("path="+r),iA.isString(i)&&o.push("domain="+i),!0===a&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function eN(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}function tN(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?eN(e,t):t}var nN=PR.isStandardBrowserEnv?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=iA.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0};var rN=function(e,t){e=e||10;var n,r=new Array(e),i=new Array(e),a=0,o=0;return t=void 0!==t?t:1e3,function(s){var u=Date.now(),c=i[o];n||(n=u),r[a]=s,i[a]=u;for(var l=o,h=0;l!==a;)h+=r[l++],l%=e;if((a=(a+1)%e)===o&&(o=(o+1)%e),!(u-n<t)){var f=c&&u-c;return f?Math.round(1e3*h/f):void 0}}};function iN(e,t){var n=0,r=rN(50,250);return function(i){var a=i.loaded,o=i.lengthComputable?i.total:void 0,s=a-n,u=r(s);n=a;var c={loaded:a,total:o,progress:o?a/o:void 0,bytes:s,rate:u||void 0,estimated:u&&o&&a<=o?(o-a)/u:void 0,event:i};c[t?"download":"upload"]=!0,e(c)}}var aN="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){var r,i=e.data,a=GR.from(e.headers).normalize(),o=e.responseType;function s(){e.cancelToken&&e.cancelToken.unsubscribe(r),e.signal&&e.signal.removeEventListener("abort",r)}iA.isFormData(i)&&(PR.isStandardBrowserEnv||PR.isStandardBrowserWebWorkerEnv?a.setContentType(!1):a.setContentType("multipart/form-data;",!1));var u=new XMLHttpRequest;if(e.auth){var c=e.auth.username||"",l=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";a.set("Authorization","Basic "+btoa(c+":"+l))}var h=tN(e.baseURL,e.url);function f(){if(u){var r=GR.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders());$R((function(e){t(e),s()}),(function(e){n(e),s()}),{data:o&&"text"!==o&&"json"!==o?u.response:u.responseText,status:u.status,statusText:u.statusText,headers:r,config:e,request:u}),u=null}}if(u.open(e.method.toUpperCase(),SR(h,e.params,e.paramsSerializer),!0),u.timeout=e.timeout,"onloadend"in u?u.onloadend=f:u.onreadystatechange=function(){u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))&&setTimeout(f)},u.onabort=function(){u&&(n(new hA("Request aborted",hA.ECONNABORTED,e,u)),u=null)},u.onerror=function(){n(new hA("Network Error",hA.ERR_NETWORK,e,u)),u=null},u.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||OR;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new hA(t,r.clarifyTimeoutError?hA.ETIMEDOUT:hA.ECONNABORTED,e,u)),u=null},PR.isStandardBrowserEnv){var d=(e.withCredentials||nN(h))&&e.xsrfCookieName&&ZR.read(e.xsrfCookieName);d&&a.set(e.xsrfHeaderName,d)}void 0===i&&a.setContentType(null),"setRequestHeader"in u&&iA.forEach(a.toJSON(),(function(e,t){u.setRequestHeader(t,e)})),iA.isUndefined(e.withCredentials)||(u.withCredentials=!!e.withCredentials),o&&"json"!==o&&(u.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&u.addEventListener("progress",iN(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",iN(e.onUploadProgress)),(e.cancelToken||e.signal)&&(r=function(t){u&&(n(!t||t.type?new XR(null,e,u):t),u.abort(),u=null)},e.cancelToken&&e.cancelToken.subscribe(r),e.signal&&(e.signal.aborted?r():e.signal.addEventListener("abort",r)));var p,v=(p=/^([-+\w]{1,25})(:?\/\/|:)/.exec(h))&&p[1]||"";v&&-1===PR.protocols.indexOf(v)?n(new hA("Unsupported protocol "+v+":",hA.ERR_BAD_REQUEST,e)):u.send(i||null)}))},oN={http:null,xhr:aN};iA.forEach(oN,(function(e,t){if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));var sN={getAdapter:function(e){for(var t,n,r=(e=iA.isArray(e)?e:[e]).length,i=0;i<r&&(t=e[i],!(n=iA.isString(t)?oN[t.toLowerCase()]:t));i++);if(!n){if(!1===n)throw new hA("Adapter ".concat(t," is not supported by the environment"),"ERR_NOT_SUPPORT");throw new Error(iA.hasOwnProp(oN,t)?"Adapter '".concat(t,"' is not available in the build"):"Unknown adapter '".concat(t,"'"))}if(!iA.isFunction(n))throw new TypeError("adapter is not a function");return n},adapters:oN};function uN(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new XR(null,e)}function cN(e){return uN(e),e.headers=GR.from(e.headers),e.data=QR.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),sN.getAdapter(e.adapter||UR.adapter)(e).then((function(t){return uN(e),t.data=QR.call(e,e.transformResponse,t),t.headers=GR.from(t.headers),t}),(function(t){return YR(t)||(uN(e),t&&t.response&&(t.response.data=QR.call(e,e.transformResponse,t.response),t.response.headers=GR.from(t.response.headers))),Promise.reject(t)}))}var lN=function(e){return e instanceof GR?e.toJSON():e};function hN(e,t){t=t||{};var n={};function r(e,t,n){return iA.isPlainObject(e)&&iA.isPlainObject(t)?iA.merge.call({caseless:n},e,t):iA.isPlainObject(t)?iA.merge({},t):iA.isArray(t)?t.slice():t}function i(e,t,n){return iA.isUndefined(t)?iA.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function a(e,t){if(!iA.isUndefined(t))return r(void 0,t)}function o(e,t){return iA.isUndefined(t)?iA.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,i,a){return a in t?r(n,i):a in e?r(void 0,n):void 0}var u={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:function(e,t){return i(lN(e),lN(t),!0)}};return iA.forEach(Object.keys(Object.assign({},e,t)),(function(r){var a=u[r]||i,o=a(e[r],t[r],r);iA.isUndefined(o)&&a!==s||(n[r]=o)})),n}Hi=i("l5bVx");var fN="1.5.0",dN={};["object","boolean","number","function","string","symbol"].forEach((function(t,n){dN[t]=function(r){return(void 0===r?"undefined":e(Hi)(r))===t||"a"+(n<1?"n ":" ")+t}}));var pN={};dN.transitional=function(e,t,n){function r(e,t){return"[Axios v1.5.0] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,i,a){if(!1===e)throw new hA(r(i," has been removed"+(t?" in "+t:"")),hA.ERR_DEPRECATED);return t&&!pN[i]&&(pN[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,a)}};var vN={assertOptions:function(e,t,n){if("object"!=typeof e)throw new hA("options must be an object",hA.ERR_BAD_OPTION_VALUE);for(var r=Object.keys(e),i=r.length;i-- >0;){var a=r[i],o=t[a];if(o){var s=e[a],u=void 0===s||o(s,a,e);if(!0!==u)throw new hA("option "+a+" must be "+u,hA.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new hA("Unknown option "+a,hA.ERR_BAD_OPTION)}},validators:dN},yN=vN.validators,mN=function(){function t(n){e(s)(this,t),this.defaults=n,this.interceptors={request:new NR,response:new NR}}return e(u)(t,[{key:"request",value:function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{};var n=(t=hN(this.defaults,t)).transitional,r=t.paramsSerializer,i=t.headers;void 0!==n&&vN.assertOptions(n,{silentJSONParsing:yN.transitional(yN.boolean),forcedJSONParsing:yN.transitional(yN.boolean),clarifyTimeoutError:yN.transitional(yN.boolean)},!1),null!=r&&(iA.isFunction(r)?t.paramsSerializer={serialize:r}:vN.assertOptions(r,{encode:yN.function,serialize:yN.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();var a=i&&iA.merge(i.common,i[t.method]);i&&iA.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete i[e]})),t.headers=GR.concat(a,i);var o=[],s=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,o.unshift(e.fulfilled,e.rejected))}));var u,c=[];this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));var l,h=0;if(!s){var f=[cN.bind(this),void 0];for(f.unshift.apply(f,o),f.push.apply(f,c),l=f.length,u=Promise.resolve(t);h<l;)u=u.then(f[h++],f[h++]);return u}l=o.length;var d=t;for(h=0;h<l;){var p=o[h++],v=o[h++];try{d=p(d)}catch(e){v.call(this,e);break}}try{u=cN.call(this,d)}catch(e){return Promise.reject(e)}for(h=0,l=c.length;h<l;)u=u.then(c[h++],c[h++]);return u}},{key:"getUri",value:function(e){return SR(tN((e=hN(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}]),t}();iA.forEach(["delete","get","head","options"],(function(e){mN.prototype[e]=function(t,n){return this.request(hN(n||{},{method:e,url:t,data:(n||{}).data}))}})),iA.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,i){return this.request(hN(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}mN.prototype[e]=t(),mN.prototype[e+"Form"]=t(!0)}));var gN=mN,kN=function(){function t(n){if(e(s)(this,t),"function"!=typeof n)throw new TypeError("executor must be a function.");var r;this.promise=new Promise((function(e){r=e}));var i=this;this.promise.then((function(e){if(i._listeners){for(var t=i._listeners.length;t-- >0;)i._listeners[t](e);i._listeners=null}})),this.promise.then=function(e){var t,n=new Promise((function(e){i.subscribe(e),t=e})).then(e);return n.cancel=function(){i.unsubscribe(t)},n},n((function(e,t,n){i.reason||(i.reason=new XR(e,t,n),r(i.reason))}))}return e(u)(t,[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}},{key:"unsubscribe",value:function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}}}],[{key:"source",value:function(){var e;return{token:new t((function(t){e=t})),cancel:e}}}]),t}();var _N={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_N).forEach((function(t){var n=e(k)(t,2),r=n[0],i=n[1];_N[i]=r}));var wN=_N;var bN=function e(t){var n=new gN(t),r=ES(gN.prototype.request,n);return iA.extend(r,gN.prototype,n,{allOwnKeys:!0}),iA.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(hN(t,n))},r}(UR);bN.Axios=gN,bN.CanceledError=XR,bN.CancelToken=kN,bN.isCancel=YR,bN.VERSION=fN,bN.toFormData=bR,bN.AxiosError=hA,bN.Cancel=bN.CanceledError,bN.all=function(e){return Promise.all(e)},bN.spread=function(e){return function(t){return e.apply(null,t)}},bN.isAxiosError=function(e){return iA.isObject(e)&&!0===e.isAxiosError},bN.mergeConfig=hN,bN.AxiosHeaders=GR,bN.formToJSON=function(e){return LR(iA.isHTMLForm(e)?new FormData(e):e)},bN.getAdapter=sN.getAdapter,bN.HttpStatusCode=wN,bN.default=bN;var EN=bN,IN=(EN.Axios,EN.AxiosError,EN.CanceledError,EN.isCancel,EN.CancelToken,EN.VERSION,EN.all,EN.Cancel,EN.isAxiosError,EN.spread,EN.toFormData,EN.AxiosHeaders,EN.HttpStatusCode,EN.formToJSON,EN.getAdapter,EN.mergeConfig,"6de1479941bef67a0c224787b78603f1"),TN=EN.create({baseURL:"https://api.themoviedb.org/3/"}),xN=function(){"use strict";function t(){e(s)(this,t),this.page=1,this.word="",this._movieId=null}return e(u)(t,[{key:"fetchMovies",value:function(){var t=this;return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,TN.get("/trending/movie/day?api_key=".concat(IN,"&page=").concat(t.page));case 2:return r=e.sent,e.abrupt("return",r.data.results);case 4:case"end":return e.stop()}}),n)})))()}},{key:"fetchMovieDetailsById",value:function(t){return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,TN.get("movie/".concat(t,"?api_key=").concat(IN));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),n)})))()}},{key:"fetchMoviesByQuery",value:function(t,n){return e(a)(e(m).mark((function r(){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,TN.get("/search/movie?api_key=".concat(IN,"&query=").concat(t,"&page=").concat(n));case 2:return i=e.sent,e.abrupt("return",i.data.results);case 4:case"end":return e.stop()}}),r)})))()}},{key:"fetchMoviesByPage",value:function(t){return e(a)(e(m).mark((function n(){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,TN.get("/trending/movie/day?api_key=".concat(IN,"&page=").concat(t));case 2:return r=e.sent,e.abrupt("return",r.data.results);case 4:case"end":return e.stop()}}),n)})))()}},{key:"fetchGenresListByIds",value:function(){return e(a)(e(m).mark((function t(){var n;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,TN.get("/genre/movie/list?api_key=".concat(IN,"&language=en"));case 2:return n=e.sent,e.abrupt("return",n.data.genres);case 4:case"end":return e.stop()}}),t)})))()}},{key:"incrementPage",value:function(){this.page+=1}},{key:"resetPage",value:function(){this.page=1}},{key:"resetQuery",value:function(){this.word=""}},{key:"query",get:function(){return this.word},set:function(e){return this.word=e}},{key:"movieId",get:function(){return this._movieId},set:function(e){return this._movieId=e}}]),t}();function CN(e,t){try{var n=JSON.stringify(t);localStorage.setItem(e,n)}catch(e){console.log(e.message)}}function SN(e){try{var t=localStorage.getItem(e);if(t)return JSON.parse(t)}catch(e){console.log(e.message)}}function AN(e){var t=SN("genres")||[];if(t)return t.filter((function(t){return e.includes(t.id)})).map((function(e){return e.name}))}function RN(e){var t=e.map((function(e){return function(e){var t=e.poster_path,n=e.original_title,r=e.id,i=e.genre_ids,a=e.genres,o=e.release_date,s=e.vote_average,u=new Date(o).getFullYear(),c=t?'<li class="gallery_card">\n         <a\n           class="gallery_link"\n          href="https://image.tmdb.org/t/p/w500'.concat(t,'"\n         >\n           <img\n           id="').concat(r,'"\n             class="movie_img"\n             src="https://image.tmdb.org/t/p/w500').concat(t,'"\n             alt="').concat(n,'"\n           \n             loading="lazy"\n           />\n             <p class="movie_title card">').concat(n,'</p>\n         <div class="movie_describtion">\n          <ul class="movie_genresList">').concat(MN(a,i),"</ul>\n           <p>").concat(u,'</p>\n           <p class="movie_average">').concat(s.toFixed(1),"</p>\n         </div>\n         </a>      \n  </li>"):'<li class="gallery_card">\n         <a\n           class="gallery__link"\n          href="https://raw.githubusercontent.com/MarynaDanyliuk/goit-react-hw-05-movies/main/src/img/default_image_large.jpg"\n         >\n           <img\n           id="'.concat(r,'"\n            class="movie_img"\n             src="https://raw.githubusercontent.com/MarynaDanyliuk/goit-react-hw-05-movies/main/src/img/default_image_large.jpg"\n             alt="').concat(n,'"\n             loading="lazy"\n           />\n          <p class="movie_title card">').concat(n,'</p>\n         <div class="movie_describtion">\n           <ul>').concat(MN(a,i),"</ul>\n           <p>").concat(u,'</p>\n           <p class="movie_average">').concat(s.toFixed(1),"</p>\n         </div>\n         </a>\n      </li>");mS.gallery.insertAdjacentHTML("beforeend",c)}({poster_path:e.poster_path,original_title:e.original_title,id:e.id,genre_ids:e.genre_ids,genres:e.genres,release_date:e.release_date,vote_average:e.vote_average})})).join("");mS.gallery.insertAdjacentHTML("beforeend",t)}function NN(e){var t=e.poster_path,n=e.original_title,r=t?'<img\n          src="https://image.tmdb.org/t/p/w500'.concat(t,'"\n          alt=').concat(n,'\n          class="image"\n          \n        />'):'<img\n          src="https://raw.githubusercontent.com/MarynaDanyliuk/goit-react-hw-05-movies/main/src/img/default_image_large.jpg"\n          alt="default image"\n          class="image"\n          style="width: 375px; height: 478px"\n        />';mS.movieImage.insertAdjacentHTML("beforeend",r)}function ON(e){var t=e.original_title,n=e.vote_average,r=e.vote_count,i=e.popularity,a=e.genres,o=e.overview,s=a.map((function(e){return e.name})).join(", "),u='\n        <div class="movie_descr">\n          <h1 class="movie_title">'.concat(t,'</h1>\n          <table class="movie_inform">\n            <tr class="movie_info_item">\n              <td class="list_category">Vote/Votes</td>\n              <td class="list_data"><span class="average">').concat(n.toFixed(1),'</span> / <span class="count">').concat(r,'</span></td>\n            </tr>\n            <tr class="movie_info_item">\n              <td class="list_category">Popularity</td>\n              <td class="list_data">').concat(i.toFixed(1),'</td>\n            </tr>\n            <tr class="movie_info_item">\n              <td class="list_category">Original Title</td>\n              <td class="list_data" style="text-transform: uppercase">').concat(t,'</td>\n            </tr>\n            <tr class="movie_info_item">\n              <td class="list_category">Genre</td>\n              <td class="list_data genres">').concat(s,'</td>\n            </tr>\n          </table>\n          <p class="movie_title about">About</p>\n          <p class="movie_about">\n          ').concat(o,"\n          </p>\n        </div>\n\n  ");mS.movieDescr.insertAdjacentHTML("beforeend",u)}function PN(){mS.gallery.innerHTML=""}function DN(e){mS.input.value="",mS.homeBtn.classList.add("nav_item--current"),mS.libraryBtn.classList.remove("nav_item--current"),mS.headerNavButtons.classList.add("not-visible"),mS.form.classList.remove("not-visible")}function LN(){mS.homeBtn.classList.remove("nav_item--current"),mS.libraryBtn.classList.add("nav_item--current"),mS.buttonWatched.classList.add("active_btn"),mS.headerNavButtons.classList.remove("not-visible"),mS.form.classList.add("not-visible")}var MN=function(e,t){if(e){var n=e.splice(0,2).map((function(e){return e.name})).join(", ");return e.length>=3?'<li class="movie_gnr">'.concat(n,", Other</li>"):'<li class="movie_gnr">'.concat(n,"</li>")}if(t){var r=AN(t).splice(0,2).join(", ");return t.length>=3?'<li class="movie_gnr">'.concat(r,", Other</li>"):'<li class="movie_gnr">'.concat(r,"</li>")}};var UN=new xN;function FN(){return BN.apply(this,arguments)}function BN(){return(BN=e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,UN.fetchMovies().then((function(e){RN(e)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.message);case 8:case"end":return e.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}function jN(e,t){return VN.apply(this,arguments)}function VN(){return(VN=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,UN.fetchMoviesByQuery(n,r).then((function(e){RN(e)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.message);case 8:case"end":return e.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}function qN(e){return zN.apply(this,arguments)}function zN(){return(zN=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,UN.fetchMovieDetailsById(n).then((function(e){NN(e),ON(e)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.message);case 8:case"end":return e.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}function HN(e){return WN.apply(this,arguments)}function WN(){return(WN=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,UN.fetchMoviesByPage(n).then((function(e){RN(e)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.message);case 8:case"end":return e.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}function KN(){return GN.apply(this,arguments)}function GN(){return(GN=e(a)(e(m).mark((function t(){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,UN.fetchGenresListByIds();case 3:CN("genres",e.sent),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.message);case 10:case"end":return e.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}var QN=new xN,YN=null,JN="";function XN(){return(XN=e(a)(e(m).mark((function t(n){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r=vS.currentUser,"IMG"===n.target.nodeName){e.next=4;break}return e.abrupt("return");case 4:if(r){e.next=8;break}mS.modalLogin.classList.add("open"),e.next=17;break;case 8:if(!r){e.next=17;break}return YN=n.target.getAttribute("id"),QN.movieId=YN,console.log(YN),e.next=14,qN(YN);case 14:return mS.modal.classList.add("open"),mS.body.classList.add("lock"),e.abrupt("return",YN);case 17:return e.abrupt("return",YN);case 18:case"end":return e.stop()}}),t)})))).apply(this,arguments)}mS.gallery.addEventListener("click",(function(e){return XN.apply(this,arguments)})),mS.libraryBtn.addEventListener("click",rO),mS.registerLink.addEventListener("click",rO),mS.loginLink.addEventListener("click",rO);var $N=mS.buttonClose;if($N)for(var ZN=0;ZN<$N.length;ZN++)$N[ZN].addEventListener("click",nO);var eO=mS.modalBackdrop;if(eO)for(var tO=0;tO<eO.length;tO++)eO[tO].addEventListener("click",nO);function nO(e){mS.modal.classList.remove("open"),"A"===e.target.nodeName&&e.target.closest(".modal").classList.remove("open"),mS.body.classList.remove("lock"),mS.movieImage.innerHTML="",mS.movieDescr.innerHTML="",e.preventDefault()}function rO(e){e.preventDefault(),JN=e.target.getAttribute("id");var t=vS.currentUser;if("library_btn"===JN&&t)return window.location.assign("#/library"),void mS.modalRegister.classList.remove("open");"library_btn"!==JN||t?(mS.modalRegister.classList.toggle("open"),mS.modalLogin.classList.toggle("open")):mS.modalLogin.classList.add("open")}var iO,aO=new xN,oO=Qw(yS,"users"),sO=(iO=e(a)(e(m).mark((function t(n){var r,i,a;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pb(oO,Lb("userId","==",n.uid)),e.prev=1,e.next=4,Qb(r);case 4:if((i=e.sent).forEach((function(e){console.log(e.id," => ",e.data())})),!(i.size>0)){e.next=10;break}console.log("   email  "),e.next=14;break;case 10:return e.next=12,Jb(Qw(yS,"users"),{userId:n.uid,email:n.email,watched:[],queue:[]});case 12:a=e.sent,console.log("Document written with ID: ",a.id);case 14:e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(1),console.error("Error adding document: ",e.t0),e.t0;case 20:case"end":return e.stop()}}),t,null,[[1,16]])}))),function(e){return iO.apply(this,arguments)}),uO=function(){var t=e(a)(e(m).mark((function t(n,r){var i,a,o,s,u,c,h;return e(m).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=Pb(oO,Lb("userId","==",n.uid)),t.next=4,Qb(i);case 4:return a=t.sent,console.log(a.docs[0].id),o=a.docs[0].id,s=Yw(yS,"users",o),console.log(s),t.next=11,aO.fetchMovieDetailsById(YN);case 11:if(u=t.sent,console.log(u),"watched"===r?(c="watched",h=u):"queue"===r&&(c="queue",h=u),!c||!h){t.next=19;break}return t.next=19,Yb(s,e(l)({},c,$b(h)));case 19:console.log("document updated"),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(0),console.log(t.t0);case 25:case"end":return t.stop()}}),t,null,[[0,22]])})));return function(e,n){return t.apply(this,arguments)}}();function cO(){mS.buttonLoadMore.classList.remove("not-visible")}function lO(e){return hO.apply(this,arguments)}function hO(){return(hO=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return PN(),DN(),e.next=4,KN();case 4:return e.next=6,FN();case 6:cO();case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function fO(e,t){return dO.apply(this,arguments)}function dO(){return(dO=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:PN(),LN(),TO(n,r),cO();case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function pO(){PN(),mS.content.insertAdjacentHTML("beforeend",'\n   <img class="page-not-found"\n   src=""\n   alt=""\n />\n   '),mS.buttonLoadMore.classList.add("not-visible")}function vO(){return(vO=e(a)(e(m).mark((function t(n,r){var i;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=window.location.hash.substring(1),console.log(i),"/"!==i&&""!==i){e.next=7;break}return e.next=5,lO(r);case 5:e.next=14;break;case 7:if("/library"!==i){e.next=13;break}return console.log(n,r),e.next=11,fO(n,r);case 11:e.next=14;break;case 13:pO();case 14:case"end":return e.stop()}}),t)})))).apply(this,arguments)}mS.logo.addEventListener("click",lO);var yO=new xN,mO="watched",gO=[],kO=[],_O=(vS.currentUser,Qw(yS,"users"));mS.homeBtn.addEventListener("click",lO),mS.buttonHeaderNav.addEventListener("click",(function(e){return CO.apply(this,arguments)})),mS.logo.addEventListener("click",lO),mS.butttonsLibrary.addEventListener("click",(function(e){return SO.apply(this,arguments)}));var wO,bO,EO,IO=function(){var t=e(a)(e(m).mark((function t(n,r){var i,a,o;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Pb(_O,Lb("userId","==",r.uid)),e.prev=1,e.next=4,Qb(i);case 4:if(!((a=e.sent).size>0)){e.next=17;break}if(o=a.docs[0].data(),gO.push(o.watched),kO.push(o.queue),"watched"!==n){e.next=13;break}return e.abrupt("return",o.watched);case 13:if("queue"!==n){e.next=15;break}return e.abrupt("return",o.queue);case 15:e.next=19;break;case 17:return console.log("No matching documents."),e.abrupt("return",[]);case 19:e.next=25;break;case 21:throw e.prev=21,e.t0=e.catch(1),console.error("Error adding document: ",e.t0),e.t0;case 25:case"end":return e.stop()}}),t,null,[[1,21]])})));return function(e,n){return t.apply(this,arguments)}}();function TO(e,t){return xO.apply(this,arguments)}function xO(){return(xO=e(a)(e(m).mark((function t(n,r){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:IO(n,r).then((function(e){RN(e)}));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function CO(){return(CO=e(a)(e(m).mark((function t(n){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:PN(),r=vS.currentUser,"watched"===(mO=n.target.getAttribute("id"))?(mS.buttonWatched.classList.add("active_btn"),mS.buttonQueue.classList.remove("active_btn"),TO(mO,r)):"queue"===mO&&(mS.buttonQueue.classList.add("active_btn"),mS.buttonWatched.classList.remove("active_btn"),TO(mO,r));case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function SO(){return SO=e(a)(e(m).mark((function t(n){var r;return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r=vS.currentUser,console.log(YN),mO=n.target.getAttribute("id"),console.log("key:",mO),"BUTTON"===n.target.nodeName){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,IO(mO,r);case 9:return e.next=11,yO.fetchMovieDetailsById(YN).then((function(e){console.log(e),uO(r,mO),"watched"===mO?(gO.push(e),uO(r)):"queue"===mO&&(kO.push(e),uO(r))})).catch((function(e){return console.log(e.message)})).finally((function(){alert("   ")}));case 11:case"end":return e.stop()}}),t)}))),SO.apply(this,arguments)}wO=function(e){null!==e?(console.log("user logged in",e),mS.signOut.classList.remove("not-visible"),e.displayName,e.email,e.accessToken,e.emailVerified,e.uid,sO(e),function(e,t){vO.apply(this,arguments)}(mO,e),PN(),mS.libraryBtn.addEventListener("click",(function(t){e&&(mO="watched",t.preventDefault(),fO(mO,e))}))):(lO(),mS.signOut.classList.add("not-visible"),console.log("no user"))},nt(vS).onAuthStateChanged(wO,bO,EO);var AO=new xN,RO="",NO=1;function OO(){return(OO=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),PN(),AO.resetPage(),AO.query=n.currentTarget.elements.searchQuery.value.trim(),""!==AO.query){e.next=6;break}return e.abrupt("return");case 6:return NO=AO.page,RO=AO.query,e.next=10,jN(RO,NO);case 10:console.log("BEFORE scroll",AO);case 11:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function PO(){return(PO=e(a)(e(m).mark((function t(n){return e(m).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),console.log("BEFORE FETCH",AO),AO.incrementPage(),NO=AO.page,""!==RO){e.next=7;break}return e.next=7,HN(NO);case 7:return RO=AO.query,e.next=10,jN(RO,NO);case 10:console.log("AFTER FETCH",AO);case 11:case"end":return e.stop()}}),t)})))).apply(this,arguments)}mS.form.addEventListener("submit",(function(e){return OO.apply(this,arguments)})),mS.buttonLoadMore.addEventListener("click",(function(e){return PO.apply(this,arguments)}))}();
//# sourceMappingURL=index.2a622a93.js.map
